[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1199944244",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1199944244",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1199944244,
        "node_id": "IC_kwDOAbcwm85HhbI0",
        "user": {
            "login": "quasiben",
            "id": 1403768,
            "node_id": "MDQ6VXNlcjE0MDM3Njg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1403768?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/quasiben",
            "html_url": "https://github.com/quasiben",
            "followers_url": "https://api.github.com/users/quasiben/followers",
            "following_url": "https://api.github.com/users/quasiben/following{/other_user}",
            "gists_url": "https://api.github.com/users/quasiben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/quasiben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/quasiben/subscriptions",
            "organizations_url": "https://api.github.com/users/quasiben/orgs",
            "repos_url": "https://api.github.com/users/quasiben/repos",
            "events_url": "https://api.github.com/users/quasiben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/quasiben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-07-29T21:04:33Z",
        "updated_at": "2022-07-29T21:04:33Z",
        "author_association": "MEMBER",
        "body": "At the moment it looks like Dask chooses to do nothing if the column name matches the index name:\r\nhttps://github.com/dask/dask/blob/0b637ab775fa177d0af737e4648a89484aee5c74/dask/dataframe/core.py#L4813-L4817\r\n\r\n@jorloplaz do you have any thoughts whether this optimization was intended for a particular workflow ?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1199944244/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1200825811",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1200825811",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1200825811,
        "node_id": "IC_kwDOAbcwm85HkyXT",
        "user": {
            "login": "jorloplaz",
            "id": 12827365,
            "node_id": "MDQ6VXNlcjEyODI3MzY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12827365?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jorloplaz",
            "html_url": "https://github.com/jorloplaz",
            "followers_url": "https://api.github.com/users/jorloplaz/followers",
            "following_url": "https://api.github.com/users/jorloplaz/following{/other_user}",
            "gists_url": "https://api.github.com/users/jorloplaz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jorloplaz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jorloplaz/subscriptions",
            "organizations_url": "https://api.github.com/users/jorloplaz/orgs",
            "repos_url": "https://api.github.com/users/jorloplaz/repos",
            "events_url": "https://api.github.com/users/jorloplaz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jorloplaz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-01T07:33:25Z",
        "updated_at": "2022-08-01T09:26:40Z",
        "author_association": "CONTRIBUTOR",
        "body": "IMHO, a `DataFrame` should never have 2 columns with the same name, and this should be controlled at all times (see the discussion regarding #9122). This includes as a particular case the one currently acting as the index, so in your example the call to  `rename` should raise an error, as there would be two columns called `'a'`.  \r\n\r\nThink about it in simpler terms: if you want to use `'b'` as index, why not using `set_index('b')` directly?\r\n\r\nAssuming the above holds, once you have a column acting as index, calling `set_index` on that same column should do nothing (be it in string form or in `Series` form; so doing `set_index(df.index)` should also be a no-op). \r\n\r\nThe only particular case where it could trigger some action is if the index is found to be unsorted on runtime (e.g., because `known_divisions=False` or `df.index.is_monotonic_increasing` happens to be `False`). \r\n\r\n@jsignell @pavithraes Any thoughts on this?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1200825811/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1201370963",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1201370963",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1201370963,
        "node_id": "IC_kwDOAbcwm85Hm3dT",
        "user": {
            "login": "georgek-auro",
            "id": 32307982,
            "node_id": "MDQ6VXNlcjMyMzA3OTgy",
            "avatar_url": "https://avatars.githubusercontent.com/u/32307982?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/georgek-auro",
            "html_url": "https://github.com/georgek-auro",
            "followers_url": "https://api.github.com/users/georgek-auro/followers",
            "following_url": "https://api.github.com/users/georgek-auro/following{/other_user}",
            "gists_url": "https://api.github.com/users/georgek-auro/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/georgek-auro/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/georgek-auro/subscriptions",
            "organizations_url": "https://api.github.com/users/georgek-auro/orgs",
            "repos_url": "https://api.github.com/users/georgek-auro/repos",
            "events_url": "https://api.github.com/users/georgek-auro/events{/privacy}",
            "received_events_url": "https://api.github.com/users/georgek-auro/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-01T15:42:09Z",
        "updated_at": "2022-08-01T15:42:09Z",
        "author_association": "NONE",
        "body": "Given that currently nothing prevents you from having multiple columns with the same name, perhaps it's better to check whether there exists a column that matches the index name in `set_index` before assuming it should be a no-op?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1201370963/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1202106469",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1202106469",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1202106469,
        "node_id": "IC_kwDOAbcwm85HprBl",
        "user": {
            "login": "jorloplaz",
            "id": 12827365,
            "node_id": "MDQ6VXNlcjEyODI3MzY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12827365?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jorloplaz",
            "html_url": "https://github.com/jorloplaz",
            "followers_url": "https://api.github.com/users/jorloplaz/followers",
            "following_url": "https://api.github.com/users/jorloplaz/following{/other_user}",
            "gists_url": "https://api.github.com/users/jorloplaz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jorloplaz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jorloplaz/subscriptions",
            "organizations_url": "https://api.github.com/users/jorloplaz/orgs",
            "repos_url": "https://api.github.com/users/jorloplaz/repos",
            "events_url": "https://api.github.com/users/jorloplaz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jorloplaz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-02T07:13:13Z",
        "updated_at": "2022-08-02T07:14:06Z",
        "author_association": "CONTRIBUTOR",
        "body": "I don't think that solves the problem. What happens above if you do first `reset_index()` and then `set_index('a')`. My guess is that, since there's another column called `'a'` when resetting, it is reset with the name `'index'`, and then you end up with two columns `'a'` and `'index'` instead of `'b'` and `'a'`, which was the original situation.\r\n\r\nEven if Dask doesn't currently prevent you now from having multiple columns with the same name, there's no good reason why you should do it. In my view, name clashes show a flaw in the processing pipeline.\r\n\r\nPandas does allow non-unicity because in any moment you can transpose the DataFrame with `.T`, so columns can become the index, and the index can for sure have duplicate values. But Dask is very different, because it is on the index that is partitioned, but not in the columns, so a frame isn't transposable (i.e., rows and columns are not interchangeable).",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1202106469/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1202630698",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1202630698",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1202630698,
        "node_id": "IC_kwDOAbcwm85HrrAq",
        "user": {
            "login": "georgek-auro",
            "id": 32307982,
            "node_id": "MDQ6VXNlcjMyMzA3OTgy",
            "avatar_url": "https://avatars.githubusercontent.com/u/32307982?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/georgek-auro",
            "html_url": "https://github.com/georgek-auro",
            "followers_url": "https://api.github.com/users/georgek-auro/followers",
            "following_url": "https://api.github.com/users/georgek-auro/following{/other_user}",
            "gists_url": "https://api.github.com/users/georgek-auro/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/georgek-auro/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/georgek-auro/subscriptions",
            "organizations_url": "https://api.github.com/users/georgek-auro/orgs",
            "repos_url": "https://api.github.com/users/georgek-auro/repos",
            "events_url": "https://api.github.com/users/georgek-auro/events{/privacy}",
            "received_events_url": "https://api.github.com/users/georgek-auro/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-02T13:57:51Z",
        "updated_at": "2022-08-02T13:57:51Z",
        "author_association": "NONE",
        "body": "Why don't we give the user a warning when such a situation occurs as well as make a note in the documentation?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1202630698/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1202723289",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1202723289",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1202723289,
        "node_id": "IC_kwDOAbcwm85HsBnZ",
        "user": {
            "login": "jorloplaz",
            "id": 12827365,
            "node_id": "MDQ6VXNlcjEyODI3MzY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12827365?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jorloplaz",
            "html_url": "https://github.com/jorloplaz",
            "followers_url": "https://api.github.com/users/jorloplaz/followers",
            "following_url": "https://api.github.com/users/jorloplaz/following{/other_user}",
            "gists_url": "https://api.github.com/users/jorloplaz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jorloplaz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jorloplaz/subscriptions",
            "organizations_url": "https://api.github.com/users/jorloplaz/orgs",
            "repos_url": "https://api.github.com/users/jorloplaz/repos",
            "events_url": "https://api.github.com/users/jorloplaz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jorloplaz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-02T14:42:58Z",
        "updated_at": "2022-08-02T14:46:27Z",
        "author_association": "CONTRIBUTOR",
        "body": "Mmm, as I said, if you have a column `'a'` acting as index, it's because that's one of the original columns of your dataframe. So once it is the index, doing `.set_index('a')` on that frame makes sense it is a no-op (recall that `.set_index()` requires computing quantiles and shuffling, which is expensive, so it should be done with care).\r\n\r\nIf you do have another column in the frame with that same name, it shows some error on your side. Because that wouldn't be possible from the beginning: if you load your frame from an SQL table, there cannot be any columns with the same name, same goes for Parquet files, etc.\r\n\r\nSo you did something between loading your data and calling `.set_index()` that introduced a duplicate column. In the snippet above it is `.rename()`. Why would you do such a thing? I cannot think of any good reason...\r\n\r\nAnd it's not only `.set_index()` the one affected. What would you expect the output from `.reset_index()['a']` to be? A series with the renamed column? A series with what used to be the index? A frame with both columns, both named `'a'`?\r\n\r\nThis is why Dask should always prevent you from introducing some duplicate column name.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1202723289/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1203113125",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1203113125",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1203113125,
        "node_id": "IC_kwDOAbcwm85Htgyl",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-02T19:13:51Z",
        "updated_at": "2022-08-02T19:13:51Z",
        "author_association": "MEMBER",
        "body": "I agree in principle with @jorloplaz that this is an odd behavior and that duplicate column names are never a good idea. However since they are still possible to create, it makes sense to at least give a warning in this case. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1203113125/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1203561754",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1203561754",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1203561754,
        "node_id": "IC_kwDOAbcwm85HvOUa",
        "user": {
            "login": "jorloplaz",
            "id": 12827365,
            "node_id": "MDQ6VXNlcjEyODI3MzY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12827365?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jorloplaz",
            "html_url": "https://github.com/jorloplaz",
            "followers_url": "https://api.github.com/users/jorloplaz/followers",
            "following_url": "https://api.github.com/users/jorloplaz/following{/other_user}",
            "gists_url": "https://api.github.com/users/jorloplaz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jorloplaz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jorloplaz/subscriptions",
            "organizations_url": "https://api.github.com/users/jorloplaz/orgs",
            "repos_url": "https://api.github.com/users/jorloplaz/repos",
            "events_url": "https://api.github.com/users/jorloplaz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jorloplaz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-03T07:00:04Z",
        "updated_at": "2022-08-03T07:00:04Z",
        "author_association": "CONTRIBUTOR",
        "body": "Thank you @jsignell ! As for me, I'll start working on preventing duplicate column names.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1203561754/reactions",
            "total_count": 2,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 2,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1225550314",
        "html_url": "https://github.com/dask/dask/issues/9331#issuecomment-1225550314",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9331",
        "id": 1225550314,
        "node_id": "IC_kwDOAbcwm85JDGnq",
        "user": {
            "login": "jorloplaz",
            "id": 12827365,
            "node_id": "MDQ6VXNlcjEyODI3MzY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/12827365?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jorloplaz",
            "html_url": "https://github.com/jorloplaz",
            "followers_url": "https://api.github.com/users/jorloplaz/followers",
            "following_url": "https://api.github.com/users/jorloplaz/following{/other_user}",
            "gists_url": "https://api.github.com/users/jorloplaz/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jorloplaz/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jorloplaz/subscriptions",
            "organizations_url": "https://api.github.com/users/jorloplaz/orgs",
            "repos_url": "https://api.github.com/users/jorloplaz/repos",
            "events_url": "https://api.github.com/users/jorloplaz/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jorloplaz/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-24T10:47:12Z",
        "updated_at": "2022-08-24T10:47:12Z",
        "author_association": "CONTRIBUTOR",
        "body": "I opened a PR that prevents you from creating frames with duplicate column names.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1225550314/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]