[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1353598749",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1353598749",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1353598749,
        "node_id": "IC_kwDOAbcwm85Qrkcd",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-15T19:24:06Z",
        "updated_at": "2022-12-15T19:24:06Z",
        "author_association": "MEMBER",
        "body": "Thanks @charlesbluca! I'm able to reproduce. Including the traceback below for completeness \r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/Users/james/projects/dask/dask/test-sort-values.py\", line 9, in <module>\r\n    ddf.sort_values(\"a\")\r\n  File \"/Users/james/projects/dask/dask/dask/dataframe/core.py\", line 4781, in sort_values\r\n    return sort_values(\r\n  File \"/Users/james/projects/dask/dask/dask/dataframe/shuffle.py\", line 151, in sort_values\r\n    divisions, mins, maxes = _calculate_divisions(\r\n  File \"/Users/james/projects/dask/dask/dask/dataframe/shuffle.py\", line 66, in _calculate_divisions\r\n    raise e\r\n  File \"/Users/james/projects/dask/dask/dask/dataframe/shuffle.py\", line 47, in _calculate_divisions\r\n    divisions, sizes, mins, maxes = compute(divisions, sizes, mins, maxes)\r\n  File \"/Users/james/projects/dask/dask/dask/base.py\", line 600, in compute\r\n    results = schedule(dsk, keys, **kwargs)\r\n  File \"/Users/james/projects/dask/dask/dask/threaded.py\", line 89, in get\r\n    results = get_async(\r\n  File \"/Users/james/projects/dask/dask/dask/local.py\", line 511, in get_async\r\n    raise_exception(exc, tb)\r\n  File \"/Users/james/projects/dask/dask/dask/local.py\", line 319, in reraise\r\n    raise exc\r\n  File \"/Users/james/projects/dask/dask/dask/local.py\", line 224, in execute_task\r\n    result = _execute_task(task, data)\r\n  File \"/Users/james/projects/dask/dask/dask/core.py\", line 119, in _execute_task\r\n    return func(*(_execute_task(a, cache) for a in args))\r\n  File \"/Users/james/projects/dask/dask/dask/dataframe/partitionquantiles.py\", line 281, in merge_and_compress_summaries\r\n    it = merge_sorted(*[zip(x, y) for x, y in vals_and_weights])\r\n  File \"cytoolz/itertoolz.pyx\", line 312, in cytoolz.itertoolz.merge_sorted\r\n  File \"cytoolz/itertoolz.pyx\", line 289, in cytoolz.itertoolz.c_merge_sorted\r\n  File \"cytoolz/itertoolz.pyx\", line 179, in cytoolz.itertoolz._merge_sorted_binary\r\n  File \"cytoolz/itertoolz.pyx\", line 203, in cytoolz.itertoolz._merge_sorted.__next__\r\n  File \"pandas/_libs/missing.pyx\", line 382, in pandas._libs.missing.NAType.__bool__\r\nTypeError: boolean value of NA is ambiguous\r\n```\r\n\r\nJust checking in, is this something you have bandwidth to look into? (no worries if not) ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1353598749/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1353611973",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1353611973",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1353611973,
        "node_id": "IC_kwDOAbcwm85QrnrF",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-15T19:36:26Z",
        "updated_at": "2022-12-15T19:36:26Z",
        "author_association": "MEMBER",
        "body": "Thinking about this is a bit a couple of possible fixes come to mind. \r\n\r\n1. I see the error is coming from the fact that `merged_sorted` in `toolz` isn't `pd.NA` aware. Is there a way we can make it aware? \r\n2. Things seem to work with `np.nan` instead of `pd.NA`. What if we just made that replacement ourselves? To be clear, I'm not sure what downstream side-effects this may cause ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1353611973/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1355166404",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1355166404",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1355166404,
        "node_id": "IC_kwDOAbcwm85QxjLE",
        "user": {
            "login": "charlesbluca",
            "id": 20627856,
            "node_id": "MDQ6VXNlcjIwNjI3ODU2",
            "avatar_url": "https://avatars.githubusercontent.com/u/20627856?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/charlesbluca",
            "html_url": "https://github.com/charlesbluca",
            "followers_url": "https://api.github.com/users/charlesbluca/followers",
            "following_url": "https://api.github.com/users/charlesbluca/following{/other_user}",
            "gists_url": "https://api.github.com/users/charlesbluca/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/charlesbluca/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/charlesbluca/subscriptions",
            "organizations_url": "https://api.github.com/users/charlesbluca/orgs",
            "repos_url": "https://api.github.com/users/charlesbluca/repos",
            "events_url": "https://api.github.com/users/charlesbluca/events{/privacy}",
            "received_events_url": "https://api.github.com/users/charlesbluca/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-16T16:21:42Z",
        "updated_at": "2022-12-16T16:21:42Z",
        "author_association": "MEMBER",
        "body": "> is this something you have bandwidth to look into?\r\n\r\nYeah, I took some time to look into this while toying around with the reproducer - think we'll probably want to go with solution 2 here, as even after unblocking `_repartition_quantiles` we still end up with quantile divisions containing `pd.NA`, which raises issues later on when we attempt to do a `searchsorted` as part of `set_partitions_pre`.\r\n\r\nIt seems like this solution works at least for this specific reproducer, but one point of difficulty here is that it isn't immediately obvious how to get a good mapping between pandas nullable dtypes and their equivalent numpy dtypes (e.g. mapping `Int64` to `float64`) - happy to open up a PR with what I have so far to continue discussion there",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1355166404/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1355762966",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1355762966",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1355762966,
        "node_id": "IC_kwDOAbcwm85Qz00W",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-12-16T23:05:29Z",
        "updated_at": "2022-12-16T23:05:29Z",
        "author_association": "MEMBER",
        "body": "> how to get a good mapping between pandas nullable dtypes and their equivalent numpy dtypes\r\n\r\nI could be missing something, but is this the thing you're after? \r\n\r\n```python\r\nIn [1]: import pandas as pd\r\n\r\nIn [2]: d = pd.Int64Dtype()\r\n\r\nIn [3]: d.numpy_dtype\r\nOut[3]: dtype('int64')\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1355762966/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1470586308",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1470586308",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1470586308,
        "node_id": "IC_kwDOAbcwm85Xp13E",
        "user": {
            "login": "j-bennet",
            "id": 637013,
            "node_id": "MDQ6VXNlcjYzNzAxMw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/637013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/j-bennet",
            "html_url": "https://github.com/j-bennet",
            "followers_url": "https://api.github.com/users/j-bennet/followers",
            "following_url": "https://api.github.com/users/j-bennet/following{/other_user}",
            "gists_url": "https://api.github.com/users/j-bennet/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/j-bennet/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/j-bennet/subscriptions",
            "organizations_url": "https://api.github.com/users/j-bennet/orgs",
            "repos_url": "https://api.github.com/users/j-bennet/repos",
            "events_url": "https://api.github.com/users/j-bennet/events{/privacy}",
            "received_events_url": "https://api.github.com/users/j-bennet/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-15T18:46:05Z",
        "updated_at": "2023-03-15T18:46:05Z",
        "author_association": "MEMBER",
        "body": "I didn't see this issue before, but this might possibly fix it:\r\n\r\nhttps://github.com/dask/dask/pull/10054",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1470586308/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1474387184",
        "html_url": "https://github.com/dask/dask/issues/9765#issuecomment-1474387184",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9765",
        "id": 1474387184,
        "node_id": "IC_kwDOAbcwm85X4Vzw",
        "user": {
            "login": "j-bennet",
            "id": 637013,
            "node_id": "MDQ6VXNlcjYzNzAxMw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/637013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/j-bennet",
            "html_url": "https://github.com/j-bennet",
            "followers_url": "https://api.github.com/users/j-bennet/followers",
            "following_url": "https://api.github.com/users/j-bennet/following{/other_user}",
            "gists_url": "https://api.github.com/users/j-bennet/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/j-bennet/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/j-bennet/subscriptions",
            "organizations_url": "https://api.github.com/users/j-bennet/orgs",
            "repos_url": "https://api.github.com/users/j-bennet/repos",
            "events_url": "https://api.github.com/users/j-bennet/events{/privacy}",
            "received_events_url": "https://api.github.com/users/j-bennet/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-17T20:45:56Z",
        "updated_at": "2023-03-17T20:45:56Z",
        "author_association": "MEMBER",
        "body": "https://github.com/dask/dask/pull/10054 does not fix this issue; that part was reverted.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1474387184/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]