[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809522460",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809522460",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809522460,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTUyMjQ2MA==",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T16:26:10Z",
        "updated_at": "2021-03-29T16:26:10Z",
        "author_association": "MEMBER",
        "body": "Thanks for raising this. Probably best to use `empty_like_safe` https://github.com/dask/dask/blob/d7d041ce883c623911ca0fc962fbdb1cb626d39f/dask/array/utils.py#L376 ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809522460/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809575992",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809575992",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809575992,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTU3NTk5Mg==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T17:40:55Z",
        "updated_at": "2021-03-29T17:40:55Z",
        "author_association": "MEMBER",
        "body": "My guess is it is not that simple as CuPy doesn't support structured arrays ( https://github.com/cupy/cupy/issues/2031 ), which is what this algorithm uses currently. We probably need to rewrite this to not use structured arrays to fix this issue",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809575992/reactions",
            "total_count": 3,
            "+1": 3,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809576089",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809576089",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809576089,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTU3NjA4OQ==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T17:41:04Z",
        "updated_at": "2021-03-29T17:41:04Z",
        "author_association": "MEMBER",
        "body": "cc @pentschev @quasiben",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809576089/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809607647",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809607647",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809607647,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTYwNzY0Nw==",
        "user": {
            "login": "pentschev",
            "id": 4398246,
            "node_id": "MDQ6VXNlcjQzOTgyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pentschev",
            "html_url": "https://github.com/pentschev",
            "followers_url": "https://api.github.com/users/pentschev/followers",
            "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
            "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
            "organizations_url": "https://api.github.com/users/pentschev/orgs",
            "repos_url": "https://api.github.com/users/pentschev/repos",
            "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pentschev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T18:23:44Z",
        "updated_at": "2021-03-29T18:23:44Z",
        "author_association": "MEMBER",
        "body": "@jakirkham is right, but to be honest I'm little puzzled why `unique` in Dask is using structured arrays, was it just implemented like that because it was clearer to understand or is there a deeper reason to do so?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809607647/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809619790",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809619790",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809619790,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTYxOTc5MA==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T18:41:45Z",
        "updated_at": "2021-03-29T18:41:45Z",
        "author_association": "MEMBER",
        "body": "`np.unique` provides a bunch of optional additional return values like the indices where the unique values were found, a mapping of where unique values exist in the original array, and frequency of unique values. As Dask expected an array to be returned in a few cases and we needed to be able to return multiple arrays, which may not be the same shape, type, etc., we used a structured array to pack them all into one array.\r\n\r\nAdditionally by returning a single array, this would lend itself to more easily being used in a tree reduction, which was left as future work ( https://github.com/dask/dask/issues/2851 ).\r\n\r\nNow this isn't to say it needs to be done that way. It was just the easiest way to solve the problem at the time. We could solve this a different way (and that's basically what I'm suggesting above), but may take a bit of work to get right. It also may make some things like doing the tree reduction part harder (though that may not matter much given no one has done this work yet)",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809619790/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/809634441",
        "html_url": "https://github.com/dask/dask/issues/7482#issuecomment-809634441",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7482",
        "id": 809634441,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTYzNDQ0MQ==",
        "user": {
            "login": "pentschev",
            "id": 4398246,
            "node_id": "MDQ6VXNlcjQzOTgyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pentschev",
            "html_url": "https://github.com/pentschev",
            "followers_url": "https://api.github.com/users/pentschev/followers",
            "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
            "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
            "organizations_url": "https://api.github.com/users/pentschev/orgs",
            "repos_url": "https://api.github.com/users/pentschev/repos",
            "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pentschev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-29T19:03:46Z",
        "updated_at": "2021-03-29T19:03:46Z",
        "author_association": "MEMBER",
        "body": "Thanks @jakirkham for the detailed explanation, it makes sense. For now, I think the only way to make it usable with CuPy would be indeed to rewrite that implementation.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/809634441/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]