{
    "url": "https://api.github.com/repos/dask/dask/issues/7283",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/7283/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/7283/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/7283/events",
    "html_url": "https://github.com/dask/dask/issues/7283",
    "id": 817579629,
    "node_id": "MDU6SXNzdWU4MTc1Nzk2Mjk=",
    "number": 7283,
    "title": "Harmonize split_every across modules",
    "user": {
        "login": "crusaderky",
        "id": 6213168,
        "node_id": "MDQ6VXNlcjYyMTMxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/crusaderky",
        "html_url": "https://github.com/crusaderky",
        "followers_url": "https://api.github.com/users/crusaderky/followers",
        "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
        "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
        "organizations_url": "https://api.github.com/users/crusaderky/orgs",
        "repos_url": "https://api.github.com/users/crusaderky/repos",
        "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
        "received_events_url": "https://api.github.com/users/crusaderky/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 1342304743,
            "node_id": "MDU6TGFiZWwxMzQyMzA0NzQz",
            "url": "https://api.github.com/repos/dask/dask/labels/core",
            "name": "core",
            "color": "000000",
            "default": false,
            "description": ""
        },
        {
            "id": 1372867996,
            "node_id": "MDU6TGFiZWwxMzcyODY3OTk2",
            "url": "https://api.github.com/repos/dask/dask/labels/discussion",
            "name": "discussion",
            "color": "bebaf4",
            "default": false,
            "description": "Discussing a topic with no specific actions yet"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-02-26T18:41:36Z",
    "updated_at": "2022-08-25T18:11:06Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "The split_every parameter is currently dishomogeneous across the various dask modules:\r\n\r\n#### dask.array\r\n- domain: ``None`` or Integral \u2265 2 or mapping {axis: (Integral \u2265 2)}\r\n- If ``None``, fall back to ``dask.config.get(\"split_every\")``. \r\n- The key appears neither in ``dask/dask.yaml`` nor in ``dask/dask_schema.yaml``.\r\n- If the key does not appear in the dask config, fall back to 4 (hardcoded).\r\n- ``False`` is interpreted the same as ``None``.\r\n- float (e.g. 1e3) and np.float64 are rejected, incoherently with the ``shape`` and ``chunks`` parameters.\r\n- The docstring in ``dask.array.reductions.reduction`` is very clear about what split_every does - except that it appears nowhere in the rendered documentation; https://docs.dask.org/en/latest/array-api.html almost never mentions split_every due to the docs being auto-generated from numpy.\r\n- The same docstring says \"Omit to let dask heuristically decide a good default\". This is incorrect; there's no heuristic; just a hard default.\r\n\r\n#### dask.dataframe\r\n- domain: ``None`` or ``False`` (which means no recursion) or int \u2265 2.\r\n- If ``None``, fall back to 8 (hardcoded). The dask config is ignored.\r\n- float and np.float64 are rejected. ``npartitions`` accepts them, but ``chunksize`` doesn't.\r\n\r\n#### dask.bag\r\nSame as dask.dataframe, except that ``npartitions`` does not accept float / np.float64.\r\n\r\n#### dask.graph_manipulation\r\n(new in #7282)\r\nSame as dask.dataframe, except that float and np.float64 are accepted by split_every and rounded down to the nearest int.\r\n\r\n\r\n# Proposed design\r\n- dask.array to interpret ``False`` as no recursion, coherently with the other modules\r\n- all modules to read the default from dask config, which will be set in ``dask/dask.yaml`` as either 4 or 8 (please discuss)\r\n- no hardcoded defaults (coherently with the design of dask.optimize)\r\n- ``dask/dask-schema.yaml`` to define the domain as ``False`` or int/float \u2265 2. floats will be rounded down to the nearest int. All modules to accept as functoin parameter ``None``, ``False``, or Number \u2265 2. Additionally, dask.array will accept, exclusively as a function parameter, {axis: (Number \u2265 2)}.\r\n- review sphinx documentation\r\n\r\n# Alternate design (not recommended)\r\n- deprecate the top-level ``split_every`` key in dask config\r\n- new config keys ``array.split_every``, ``dataframe.split_every``, ``bag.split_every`` and ``graph_manipulation.split_every`` which reflect the current mismatch in defaults and domain\r\n- no hardcoded defaults\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/7283/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/7283/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}