[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205230779",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205230779",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205230779,
        "node_id": "IC_kwDOAbcwm85H1ly7",
        "user": {
            "login": "GPUtester",
            "id": 38199262,
            "node_id": "MDQ6VXNlcjM4MTk5MjYy",
            "avatar_url": "https://avatars.githubusercontent.com/u/38199262?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GPUtester",
            "html_url": "https://github.com/GPUtester",
            "followers_url": "https://api.github.com/users/GPUtester/followers",
            "following_url": "https://api.github.com/users/GPUtester/following{/other_user}",
            "gists_url": "https://api.github.com/users/GPUtester/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GPUtester/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GPUtester/subscriptions",
            "organizations_url": "https://api.github.com/users/GPUtester/orgs",
            "repos_url": "https://api.github.com/users/GPUtester/repos",
            "events_url": "https://api.github.com/users/GPUtester/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GPUtester/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T13:06:09Z",
        "updated_at": "2022-08-04T13:06:09Z",
        "author_association": "COLLABORATOR",
        "body": "Can one of the admins verify this patch?\n\nAdmins can comment `ok to test` to allow this one PR to run or `add to allowlist` to allow all future PRs from the same author to run.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205230779/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205234226",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205234226",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205234226,
        "node_id": "IC_kwDOAbcwm85H1moy",
        "user": {
            "login": "geraninam",
            "id": 108741360,
            "node_id": "U_kgDOBntC8A",
            "avatar_url": "https://avatars.githubusercontent.com/u/108741360?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/geraninam",
            "html_url": "https://github.com/geraninam",
            "followers_url": "https://api.github.com/users/geraninam/followers",
            "following_url": "https://api.github.com/users/geraninam/following{/other_user}",
            "gists_url": "https://api.github.com/users/geraninam/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/geraninam/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/geraninam/subscriptions",
            "organizations_url": "https://api.github.com/users/geraninam/orgs",
            "repos_url": "https://api.github.com/users/geraninam/repos",
            "events_url": "https://api.github.com/users/geraninam/events{/privacy}",
            "received_events_url": "https://api.github.com/users/geraninam/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T13:08:58Z",
        "updated_at": "2022-08-04T13:08:58Z",
        "author_association": "CONTRIBUTOR",
        "body": "I believe the failing tests are because the functionality for those cases has changed since the shape of the array is not unknown anymore.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205234226/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205285865",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205285865",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205285865,
        "node_id": "IC_kwDOAbcwm85H1zPp",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T13:49:56Z",
        "updated_at": "2022-08-04T13:49:56Z",
        "author_association": "MEMBER",
        "body": "add to allowlist\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205285865/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205311396",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205311396",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205311396,
        "node_id": "IC_kwDOAbcwm85H15ek",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T14:09:35Z",
        "updated_at": "2022-08-04T14:09:35Z",
        "author_association": "MEMBER",
        "body": "> I believe the failing tests are because the functionality for those cases has changed since the shape of the array is not unknown anymore.\r\n\r\nThat's an exciting way to fail! You can update them to explicitly unset the chunks. It might be worth adding a `clear_chunk_sizes` method on dask arrays that mimics the `dask.dataframe.Series.clear_partitions` method.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205311396/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205369609",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205369609",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205369609,
        "node_id": "IC_kwDOAbcwm85H2HsJ",
        "user": {
            "login": "geraninam",
            "id": 108741360,
            "node_id": "U_kgDOBntC8A",
            "avatar_url": "https://avatars.githubusercontent.com/u/108741360?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/geraninam",
            "html_url": "https://github.com/geraninam",
            "followers_url": "https://api.github.com/users/geraninam/followers",
            "following_url": "https://api.github.com/users/geraninam/following{/other_user}",
            "gists_url": "https://api.github.com/users/geraninam/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/geraninam/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/geraninam/subscriptions",
            "organizations_url": "https://api.github.com/users/geraninam/orgs",
            "repos_url": "https://api.github.com/users/geraninam/repos",
            "events_url": "https://api.github.com/users/geraninam/events{/privacy}",
            "received_events_url": "https://api.github.com/users/geraninam/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T14:54:25Z",
        "updated_at": "2022-08-04T14:54:25Z",
        "author_association": "CONTRIBUTOR",
        "body": "> > I believe the failing tests are because the functionality for those cases has changed since the shape of the array is not unknown anymore.\r\n> \r\n> That's an exciting way to fail! You can update them to explicitly unset the chunks. It might be worth adding a `clear_chunk_sizes` method on dask arrays that mimics the `dask.dataframe.Series.clear_partitions` method.\r\n\r\nHi Julia, would you mind elaborating a bit on what you're suggesting? Sorry, I don't think I understand very well what I should do to fix this.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205369609/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1205677456",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1205677456",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1205677456,
        "node_id": "IC_kwDOAbcwm85H3S2Q",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-04T19:21:59Z",
        "updated_at": "2022-08-04T19:22:18Z",
        "author_association": "MEMBER",
        "body": "I think you should look through the failing tests and set `arr._chunks` explicitly. Something like we do here:\r\n\r\nhttps://github.com/dask/dask/blob/377940b64914111ff92f2ea7f0b264dccabe273a/dask/array/tests/test_array_core.py#L3800\r\n\r\nI was originally trying to suggest that you could make a method on dask.Arrary called `clear_chunk_sizes` that would do that set for you, but that is probably out of scope for this PR :)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1205677456/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1206491337",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1206491337",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1206491337,
        "node_id": "IC_kwDOAbcwm85H6ZjJ",
        "user": {
            "login": "dustinwerran2",
            "id": 107258215,
            "node_id": "U_kgDOBmShZw",
            "avatar_url": "https://avatars.githubusercontent.com/u/107258215?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dustinwerran2",
            "html_url": "https://github.com/dustinwerran2",
            "followers_url": "https://api.github.com/users/dustinwerran2/followers",
            "following_url": "https://api.github.com/users/dustinwerran2/following{/other_user}",
            "gists_url": "https://api.github.com/users/dustinwerran2/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dustinwerran2/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dustinwerran2/subscriptions",
            "organizations_url": "https://api.github.com/users/dustinwerran2/orgs",
            "repos_url": "https://api.github.com/users/dustinwerran2/repos",
            "events_url": "https://api.github.com/users/dustinwerran2/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dustinwerran2/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-05T14:00:47Z",
        "updated_at": "2022-08-05T14:01:12Z",
        "author_association": "NONE",
        "body": "Hi Julia! Thanks for being so quick on this! :) Geraldine explicitly set those fields to np.nan as you suggested and now we're getting some new errors that generally look like this:\r\n\r\n```2022-08-05T13:24:02.7072133Z =================================== FAILURES ===================================\r\n2022-08-05T13:24:02.7072528Z \u001b[31m\u001b[1m___________________________ test_compute_chunk_sizes ___________________________\u001b[0m\r\n2022-08-05T13:24:02.7072700Z \r\n2022-08-05T13:24:02.7072792Z     def test_compute_chunk_sizes():\r\n2022-08-05T13:24:02.7073142Z         x = da.from_array(np.linspace(-1, 1, num=50), chunks=10)\r\n2022-08-05T13:24:02.7073494Z         y = x[x < 0]\r\n2022-08-05T13:24:02.7073708Z         y._chunks = ((np.nan,) * 5,)\r\n2022-08-05T13:24:02.7073930Z         assert np.isnan(y.shape[0])\r\n2022-08-05T13:24:02.7074172Z         assert y.chunks == ((np.nan,) * 5,)\r\n2022-08-05T13:24:02.7074380Z     \r\n2022-08-05T13:24:02.7074556Z >       z = y.compute_chunk_sizes()\r\n...\r\n2022-08-05T13:24:02.7158506Z >                       children = reducible & deps[child]\r\n2022-08-05T13:24:02.7158971Z \u001b[1m\u001b[31mE                       KeyError: ('slice_with_int_dask_array_aggregate-4577274e4b40c4a92c822f2fd64ceb79', 1)\u001b[0m\r\n2022-08-05T13:24:02.7159207Z \r\n2022-08-05T13:24:02.7159382Z \u001b[1m\u001b[31mdask/optimization.py\u001b[0m:631: KeyError```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1206491337/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1206595749",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1206595749",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1206595749,
        "node_id": "IC_kwDOAbcwm85H6zCl",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-05T15:41:48Z",
        "updated_at": "2022-08-05T15:41:57Z",
        "author_association": "MEMBER",
        "body": "I think some of the tests might be failing because the number of output chunks is different when using a boolean filter than it was before. Before the number of chunks matched the number in the input, it's just all their sizes were nan.\r\n\r\n```python\r\nimport numpy as np\r\nimport dask.array as da\r\n\r\nx = da.from_array(np.linspace(-1, 1, num=50), chunks=10)\r\nx._chunks\r\n# ((10, 10, 10, 10, 10),)\r\n\r\n# the number of output chunks is 1.\r\ny = x[x > 0]\r\ny._chunks\r\n# ((25,),)\r\n\r\n# this matches the behavior of int slicing\r\nz = x[list(range(25, 50))]\r\nz._chunks\r\n# ((25,),)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1206595749/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1215130905",
        "html_url": "https://github.com/dask/dask/pull/9351#issuecomment-1215130905",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9351",
        "id": 1215130905,
        "node_id": "IC_kwDOAbcwm85IbW0Z",
        "user": {
            "login": "geraninam",
            "id": 108741360,
            "node_id": "U_kgDOBntC8A",
            "avatar_url": "https://avatars.githubusercontent.com/u/108741360?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/geraninam",
            "html_url": "https://github.com/geraninam",
            "followers_url": "https://api.github.com/users/geraninam/followers",
            "following_url": "https://api.github.com/users/geraninam/following{/other_user}",
            "gists_url": "https://api.github.com/users/geraninam/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/geraninam/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/geraninam/subscriptions",
            "organizations_url": "https://api.github.com/users/geraninam/orgs",
            "repos_url": "https://api.github.com/users/geraninam/repos",
            "events_url": "https://api.github.com/users/geraninam/events{/privacy}",
            "received_events_url": "https://api.github.com/users/geraninam/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-15T15:06:29Z",
        "updated_at": "2022-08-15T15:06:29Z",
        "author_association": "CONTRIBUTOR",
        "body": "Hi @jsignell, I added the changes you suggested. There are still some failing tests that I'm not really sure how to fix and would appreciate your help.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1215130905/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]