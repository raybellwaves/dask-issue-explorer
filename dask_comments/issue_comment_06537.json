[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/678444340",
        "html_url": "https://github.com/dask/dask/issues/6537#issuecomment-678444340",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6537",
        "id": 678444340,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3ODQ0NDM0MA==",
        "user": {
            "login": "quasiben",
            "id": 1403768,
            "node_id": "MDQ6VXNlcjE0MDM3Njg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1403768?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/quasiben",
            "html_url": "https://github.com/quasiben",
            "followers_url": "https://api.github.com/users/quasiben/followers",
            "following_url": "https://api.github.com/users/quasiben/following{/other_user}",
            "gists_url": "https://api.github.com/users/quasiben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/quasiben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/quasiben/subscriptions",
            "organizations_url": "https://api.github.com/users/quasiben/orgs",
            "repos_url": "https://api.github.com/users/quasiben/repos",
            "events_url": "https://api.github.com/users/quasiben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/quasiben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-21T19:03:30Z",
        "updated_at": "2020-08-21T19:03:30Z",
        "author_association": "MEMBER",
        "body": "Thanks for the report @goodwanghan .  This is indeed an issue. Probing a little more it looks like `df2._meta` and `df2._meta_nonempty` are not updated appropriately.\r\n\r\n\r\n```python\r\nIn [25]: df2._meta\r\nOut[25]:\r\nEmpty DataFrame\r\nColumns: [index, xx]\r\nIndex: []\r\n\r\nIn [26]: df2._meta_nonempty\r\nOut[26]:\r\n   index  xx\r\n0      1   1\r\n1      1   1\r\n``` ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/678444340/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/784765672",
        "html_url": "https://github.com/dask/dask/issues/6537#issuecomment-784765672",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6537",
        "id": 784765672,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4NDc2NTY3Mg==",
        "user": {
            "login": "SultanOrazbayev",
            "id": 20208402,
            "node_id": "MDQ6VXNlcjIwMjA4NDAy",
            "avatar_url": "https://avatars.githubusercontent.com/u/20208402?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/SultanOrazbayev",
            "html_url": "https://github.com/SultanOrazbayev",
            "followers_url": "https://api.github.com/users/SultanOrazbayev/followers",
            "following_url": "https://api.github.com/users/SultanOrazbayev/following{/other_user}",
            "gists_url": "https://api.github.com/users/SultanOrazbayev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/SultanOrazbayev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/SultanOrazbayev/subscriptions",
            "organizations_url": "https://api.github.com/users/SultanOrazbayev/orgs",
            "repos_url": "https://api.github.com/users/SultanOrazbayev/repos",
            "events_url": "https://api.github.com/users/SultanOrazbayev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/SultanOrazbayev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-02-24T05:05:30Z",
        "updated_at": "2021-02-24T05:05:30Z",
        "author_association": "CONTRIBUTOR",
        "body": "To add another case where `._meta_nonempty` doesn't work properly:\r\n\r\n```python\r\nimport dask.dataframe as dd\r\nimport pandas as pd\r\n\r\ndef func(df):\r\n    for index, row in df.iterrows():\r\n        tuples = row['A']\r\n        for t in tuples:\r\n            x, y = t\r\n    return [1,2,3]\r\n\r\ndf = pd.DataFrame({'A': [[(1, 1), (3, 4)], [(3, 2)]]})\r\nddf = dd.from_pandas(df, npartitions=2)\r\nddf.map_partitions(func).compute()\r\n```\r\n(I suggested some ways around it here https://stackoverflow.com/questions/66342506/unpack-tuple-inside-function-when-using-dask-map-partitions)\r\n\r\nLooking at the code, it seems that this approach is a bit restrictive, since all `object` types will become `foo`: \r\n\r\nhttps://github.com/dask/dask/blob/adb58fa7949eb673d49c45a7215e19deaaa34217/dask/dataframe/utils.py#L504-L526\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/784765672/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]