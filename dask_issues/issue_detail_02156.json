{
    "url": "https://api.github.com/repos/dask/dask/issues/2156",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/2156/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/2156/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/2156/events",
    "html_url": "https://github.com/dask/dask/issues/2156",
    "id": 218655894,
    "node_id": "MDU6SXNzdWUyMTg2NTU4OTQ=",
    "number": 2156,
    "title": "ENH: Delayed variant of persist (pin?) ",
    "user": {
        "login": "jakirkham",
        "id": 3019665,
        "node_id": "MDQ6VXNlcjMwMTk2NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jakirkham",
        "html_url": "https://github.com/jakirkham",
        "followers_url": "https://api.github.com/users/jakirkham/followers",
        "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
        "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
        "organizations_url": "https://api.github.com/users/jakirkham/orgs",
        "repos_url": "https://api.github.com/users/jakirkham/repos",
        "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jakirkham/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 19,
    "created_at": "2017-04-01T01:26:49Z",
    "updated_at": "2018-03-19T17:13:01Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "It seems that storing an intermediate result now requires one call `persist` or `cache`, which trigger a computation in the background. Something that would be really nice is delayed caching (pinning?).\r\n\r\nTo elaborate a bit, pinning would mean that when computation is triggered by other means, the pinned object would be computed once and then persisted on the workers. However noting that the object should be pinned would not result in any computation on its own. Here's a simple example to demonstrate what this might mean.\r\n\r\n```python\r\nIn [1]: import dask.array as da\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: a = da.from_array(np.arange(6), chunks=(6,))\r\n\r\nIn [4]: b = a * 2\r\n\r\nIn [5]: b = b.pin()  # persist this later\r\n\r\nIn [6]: c = b + 3\r\n\r\nIn [7]: c.compute()  # compute `c` and persist `b` in the process\r\nOut[7]: array([ 3,  5,  7,  9, 11, 13])\r\n\r\nIn [8]: b.compute()  # fetch `b`, it was already computed when `c` was\r\nOut[8]: array([ 0,  2,  4,  6,  8, 10])\r\n\r\nIn [9]: del a, b, c  # free memory, particularly `b` and `c` are needed to free `b`'s memory\r\n```\r\n\r\nNot to walk through all of this, but calling `b.pin()` notes that this value should be persisted on the workers once computation is triggered. Though otherwise it is just an annotation in the Dask graph. When we call `c.compute()`, this triggers computation, which will result in computing `b` as well. Once `b` is computed, its result is kept on the workers just as `b.persist()` does. So when we call `b.compute()`, it doesn't really compute anything. It just returns the result that was persisted in memory on the workers. To free the memory attached to `b`, we just release all references to it as we would do with `persist`.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/2156/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/2156/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}