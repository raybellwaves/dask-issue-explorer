[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/580290802",
        "html_url": "https://github.com/dask/dask/issues/5847#issuecomment-580290802",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5847",
        "id": 580290802,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDI5MDgwMg==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-30T14:54:32Z",
        "updated_at": "2020-01-30T14:54:32Z",
        "author_association": "MEMBER",
        "body": "Thanks for the report, confirmed.\r\n\r\nAre you interested in debugging this?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/580290802/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/580293104",
        "html_url": "https://github.com/dask/dask/issues/5847#issuecomment-580293104",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5847",
        "id": 580293104,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDI5MzEwNA==",
        "user": {
            "login": "joshua-gould",
            "id": 5237151,
            "node_id": "MDQ6VXNlcjUyMzcxNTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5237151?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/joshua-gould",
            "html_url": "https://github.com/joshua-gould",
            "followers_url": "https://api.github.com/users/joshua-gould/followers",
            "following_url": "https://api.github.com/users/joshua-gould/following{/other_user}",
            "gists_url": "https://api.github.com/users/joshua-gould/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/joshua-gould/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/joshua-gould/subscriptions",
            "organizations_url": "https://api.github.com/users/joshua-gould/orgs",
            "repos_url": "https://api.github.com/users/joshua-gould/repos",
            "events_url": "https://api.github.com/users/joshua-gould/events{/privacy}",
            "received_events_url": "https://api.github.com/users/joshua-gould/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-30T14:59:30Z",
        "updated_at": "2020-01-30T14:59:30Z",
        "author_association": "NONE",
        "body": "I'm happy to help debug, but as I'm new to Dask, I could use a pointer for where to start. Thanks.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/580293104/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/580304606",
        "html_url": "https://github.com/dask/dask/issues/5847#issuecomment-580304606",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5847",
        "id": 580304606,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDMwNDYwNg==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-30T15:23:03Z",
        "updated_at": "2020-01-30T15:23:03Z",
        "author_association": "MEMBER",
        "body": "Thanks! This ones a bit tricky to be honest :)\r\n\r\nI would start though with your user-defiend Aggregation and work backwards from there.\r\n\r\n```python\r\nimport dask.dataframe as dd\r\nimport numpy as np\r\nimport pandas as pd\r\nimport scipy.sparse\r\n\r\nX = np.array([[0.1, 0.2, 0.3, 0.2]])\r\n\r\ndf = pd.DataFrame.sparse.from_spmatrix(scipy.sparse.csr_matrix(X).T)\r\ndf.index = ['a', 'b', 'c', 'a']\r\n# converting index to category causes incorrect results when npartitions > 1\r\ndf.index = df.index.astype('category')\r\nddf = dd.from_pandas(df, 2)\r\n\r\n\r\ndef sparse_min(x):\r\n    if x.sparse.npoints == 0:\r\n        print('fill value', x.sparse.fill_value)\r\n        return x.sparse.fill_value\r\n    value = x.sparse.sp_values.min()\r\n    result = min(x.sparse.fill_value, value) if x.sparse.density < 1 else value\r\n    print(\"sparse_min\", result)\r\n    return result\r\n\r\n\r\ndef sparse_min_chunk(x):\r\n    result = x.apply(sparse_min)\r\n    print('min_chunk', x, result)\r\n    return result\r\n\r\n\r\ndef sparse_min_agg(x):\r\n    result = x.min()\r\n    print('min_agg', result)\r\n    return result\r\n\r\n\r\ndask_agg_sparse_min = dd.Aggregation(\r\n    name='dd_sparse_min',\r\n    chunk=sparse_min_chunk,\r\n    agg=sparse_min_agg\r\n)\r\n\r\npandas_result = df.groupby(df.index).agg(sparse_min)\r\ndask_result = ddf.groupby(ddf.index).agg(dask_agg_sparse_min).compute()\r\n# bug-dask result is all zeros\r\n```\r\n\r\nTo make things simpler, you'll want to `import dask; dask.config.set(scheduler='single-threaded')`.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/580304606/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/583401934",
        "html_url": "https://github.com/dask/dask/issues/5847#issuecomment-583401934",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5847",
        "id": 583401934,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzQwMTkzNA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-02-07T14:04:00Z",
        "updated_at": "2020-02-07T14:04:00Z",
        "author_association": "MEMBER",
        "body": "Any updates here @joshua-gould?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/583401934/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/583402524",
        "html_url": "https://github.com/dask/dask/issues/5847#issuecomment-583402524",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5847",
        "id": 583402524,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzQwMjUyNA==",
        "user": {
            "login": "joshua-gould",
            "id": 5237151,
            "node_id": "MDQ6VXNlcjUyMzcxNTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5237151?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/joshua-gould",
            "html_url": "https://github.com/joshua-gould",
            "followers_url": "https://api.github.com/users/joshua-gould/followers",
            "following_url": "https://api.github.com/users/joshua-gould/following{/other_user}",
            "gists_url": "https://api.github.com/users/joshua-gould/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/joshua-gould/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/joshua-gould/subscriptions",
            "organizations_url": "https://api.github.com/users/joshua-gould/orgs",
            "repos_url": "https://api.github.com/users/joshua-gould/repos",
            "events_url": "https://api.github.com/users/joshua-gould/events{/privacy}",
            "received_events_url": "https://api.github.com/users/joshua-gould/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-02-07T14:05:31Z",
        "updated_at": "2020-02-07T14:05:31Z",
        "author_association": "NONE",
        "body": "Sorry, I haven't had a chance to look into it more. Thanks.\n\nOn Fri, Feb 7, 2020 at 9:04 AM Tom Augspurger <notifications@github.com>\nwrote:\n\n> Any updates here @joshua-gould <https://github.com/joshua-gould>?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5847?email_source=notifications&email_token=ABH6TH774S55ZIB5ZJIOEWLRBVS5FA5CNFSM4KNVH2ZKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOELDADTQ#issuecomment-583401934>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABH6THZ25NY4RFCH2IUAKRTRBVS5FANCNFSM4KNVH2ZA>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/583402524/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]