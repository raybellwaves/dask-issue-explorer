[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1025920650",
        "html_url": "https://github.com/dask/dask/issues/8638#issuecomment-1025920650",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8638",
        "id": 1025920650,
        "node_id": "IC_kwDOAbcwm849Jk6K",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-01-31T15:45:36Z",
        "updated_at": "2022-01-31T15:45:36Z",
        "author_association": "MEMBER",
        "body": "I totally agree that if there is a simple way to deduce shape that is desirable. Especially if it doesn't add too much complexity to the codebase.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1025920650/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1026185130",
        "html_url": "https://github.com/dask/dask/issues/8638#issuecomment-1026185130",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8638",
        "id": 1026185130,
        "node_id": "IC_kwDOAbcwm849Kleq",
        "user": {
            "login": "gjoseph92",
            "id": 3309802,
            "node_id": "MDQ6VXNlcjMzMDk4MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3309802?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gjoseph92",
            "html_url": "https://github.com/gjoseph92",
            "followers_url": "https://api.github.com/users/gjoseph92/followers",
            "following_url": "https://api.github.com/users/gjoseph92/following{/other_user}",
            "gists_url": "https://api.github.com/users/gjoseph92/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/gjoseph92/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/gjoseph92/subscriptions",
            "organizations_url": "https://api.github.com/users/gjoseph92/orgs",
            "repos_url": "https://api.github.com/users/gjoseph92/repos",
            "events_url": "https://api.github.com/users/gjoseph92/events{/privacy}",
            "received_events_url": "https://api.github.com/users/gjoseph92/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-01-31T20:35:35Z",
        "updated_at": "2022-01-31T20:35:35Z",
        "author_association": "MEMBER",
        "body": "My intuition is that this would not be easy to do without adding complexity. In order to do it, you'd have to be able to inspect the graph of the argument to figure out that, semantically, the argument is a `ones` operation. Graphs, even HLGs, aren't currently designed for that sort of semantic introspection. You'd get into some gnarly stuff poking at the `dsk` attribute of the `Blockwise` object.\r\n\r\nThis is another good example case for https://github.com/dask/dask/issues/7933, which is all about making that sort of semantic introspection possible for optimizations much like this.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1026185130/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1031238092",
        "html_url": "https://github.com/dask/dask/issues/8638#issuecomment-1031238092",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8638",
        "id": 1031238092,
        "node_id": "IC_kwDOAbcwm849d3HM",
        "user": {
            "login": "Illviljan",
            "id": 14371165,
            "node_id": "MDQ6VXNlcjE0MzcxMTY1",
            "avatar_url": "https://avatars.githubusercontent.com/u/14371165?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Illviljan",
            "html_url": "https://github.com/Illviljan",
            "followers_url": "https://api.github.com/users/Illviljan/followers",
            "following_url": "https://api.github.com/users/Illviljan/following{/other_user}",
            "gists_url": "https://api.github.com/users/Illviljan/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Illviljan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Illviljan/subscriptions",
            "organizations_url": "https://api.github.com/users/Illviljan/orgs",
            "repos_url": "https://api.github.com/users/Illviljan/repos",
            "events_url": "https://api.github.com/users/Illviljan/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Illviljan/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-02-07T09:16:46Z",
        "updated_at": "2022-02-07T09:44:44Z",
        "author_association": "CONTRIBUTOR",
        "body": "I think this (shortterm, high level expressions seems longlongterm) can be solved by under-the-hood switching boolean arrays to integer indices.\r\n\r\nHere's a proof of concept that fixes my examples, probably neeeds a little more thought on n-dimensions:\r\n\r\n```python\r\nimport dask.array as da\r\n\r\ndef simple_masker(size, x=None):\r\n    if x is None:\r\n        x = (0, 0)    \r\n    elif not isinstance(x, tuple):\r\n        x = (x, x+1)\r\n\r\n    i0 = da.arange(0, x[0], dtype=int)\r\n    i1 = da.arange(x[1], size, dtype=int)\r\n    return da.concatenate((i0, i1), axis=0)\r\n\r\na = da.arange(0, 10)\r\nm = da.ones(10, dtype=bool)\r\n\r\n# a[m].compute():\r\n# array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\r\na[simple_masker(a.size)]\r\n# dask.array<slice_with_int_dask_array_aggregate, shape=(9,), dtype=int32, chunksize=(9,), chunktype=numpy.ndarray>\r\na[simple_masker(a.size)].compute()\r\n# array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\r\n\r\n# m[0] = False\r\n# a[m].compute()\r\n# array([1, 2, 3, 4, 5, 6, 7, 8, 9])\r\na[simple_masker(a.size, 0)]\r\n# dask.array<slice_with_int_dask_array_aggregate, shape=(9,), dtype=int32, chunksize=(9,), chunktype=numpy.ndarray>\r\na[simple_masker(a.size, 0)].compute()\r\n# array([1, 2, 3, 4, 5, 6, 7, 8, 9])\r\n\r\nn = 2\r\n# m[0:n] = False\r\n# a[m].compute()\r\n# array([2, 3, 4, 5, 6, 7, 8, 9])\r\na[simple_masker(a.size, (0, n))]\r\n# dask.array<slice_with_int_dask_array_aggregate, shape=(7,), dtype=int32, chunksize=(7,), chunktype=numpy.ndarray>\r\na[simple_masker(a.size, (0, n))].compute()\r\n# array([2, 3, 4, 5, 6, 7, 8, 9])\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1031238092/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]