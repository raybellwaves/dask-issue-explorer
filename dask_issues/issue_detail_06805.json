{
    "url": "https://api.github.com/repos/dask/dask/issues/6805",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/6805/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/6805/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/6805/events",
    "html_url": "https://github.com/dask/dask/issues/6805",
    "id": 736486549,
    "node_id": "MDU6SXNzdWU3MzY0ODY1NDk=",
    "number": 6805,
    "title": "Client() control scope of resources",
    "user": {
        "login": "pseudotensor",
        "id": 2249614,
        "node_id": "MDQ6VXNlcjIyNDk2MTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2249614?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pseudotensor",
        "html_url": "https://github.com/pseudotensor",
        "followers_url": "https://api.github.com/users/pseudotensor/followers",
        "following_url": "https://api.github.com/users/pseudotensor/following{/other_user}",
        "gists_url": "https://api.github.com/users/pseudotensor/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/pseudotensor/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pseudotensor/subscriptions",
        "organizations_url": "https://api.github.com/users/pseudotensor/orgs",
        "repos_url": "https://api.github.com/users/pseudotensor/repos",
        "events_url": "https://api.github.com/users/pseudotensor/events{/privacy}",
        "received_events_url": "https://api.github.com/users/pseudotensor/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2020-11-04T23:17:31Z",
    "updated_at": "2020-11-05T20:18:08Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Currently I cannot see way to manage both GPUs and CPUs using dask \"resources\".\r\n\r\nSuppose I have 2 machines each with 1 GPU and 8 cores.  I can set labels for GPU and CPU counts, but dask_cudf/RAPIDS side requires 1 worker/GPU.  But then for any CPU tasks I am suddenly forced to having 1 worker process for an entire node.  I can set nthreads to all cores divided by number of GPUs.  For numpy/panda/scipy things that release GIL that might be kinda ok, but as docs say this is not optimal if something does not release GIL as threads become useless except for I/O.\r\n\r\nIf I try to add extra workers *just* for CPU resources and have other workers *just* for GPU resources, this does not work either.  Packages like xgboost automatically consume all workers, as the only way to restrict resources currently is to use .compute() or client.submit, but the *client* itself cannot be restricted it seems.  One hits:  https://github.com/dmlc/xgboost/issues/6344  because of this.  If I could call Client() with a \"resources=\" argument so any use of that client would be using limited resources like .compute, .submit, then that would work.  But AFAIK, I see no such possibility even though would be more general that current scheme of only allowing for .compute, .submit, etc.\r\n\r\nI can use 2 schedulers for each type of resource, but that defeats purpose of scheduling and resource management.  E.g. I know that xgboost is pretty efficient using only GPU and not CPU, so I could run CPU and GPU at same time roughly.  But other packages like lightgbm use alot of CPU even when running on GPU, so such a split of scheduling would drag system to crawl with other dask tasks.\r\n\r\nBasically, request is for Client() itself to consume resources requests to limit scope of all dask tasks, not just ones that take explicit resources like .compute, client.submit since often we do not use dask in such a fine-grained way, like for xgboost package we have no such control.\r\n\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/6805/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/6805/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}