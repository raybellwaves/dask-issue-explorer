{
    "url": "https://api.github.com/repos/dask/dask/issues/10548",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/10548/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/10548/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/10548/events",
    "html_url": "https://github.com/dask/dask/issues/10548",
    "id": 1930214120,
    "node_id": "I_kwDOAbcwm85zDLro",
    "number": 10548,
    "title": "Config file path can not be updated using DASK_CONFIG",
    "user": {
        "login": "adrien-berchet",
        "id": 11536226,
        "node_id": "MDQ6VXNlcjExNTM2MjI2",
        "avatar_url": "https://avatars.githubusercontent.com/u/11536226?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adrien-berchet",
        "html_url": "https://github.com/adrien-berchet",
        "followers_url": "https://api.github.com/users/adrien-berchet/followers",
        "following_url": "https://api.github.com/users/adrien-berchet/following{/other_user}",
        "gists_url": "https://api.github.com/users/adrien-berchet/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adrien-berchet/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adrien-berchet/subscriptions",
        "organizations_url": "https://api.github.com/users/adrien-berchet/orgs",
        "repos_url": "https://api.github.com/users/adrien-berchet/repos",
        "events_url": "https://api.github.com/users/adrien-berchet/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adrien-berchet/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 3468123446,
            "node_id": "LA_kwDOAbcwm87Ot102",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20attention",
            "name": "needs attention",
            "color": "6d626c",
            "default": false,
            "description": "It's been a while since this was pushed on. Needs attention from the owner or a maintainer."
        },
        {
            "id": 3880424463,
            "node_id": "LA_kwDOAbcwm87nSpQP",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20triage",
            "name": "needs triage",
            "color": "eeeeee",
            "default": false,
            "description": "Needs a response from a contributor"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-10-06T13:43:33Z",
    "updated_at": "2023-11-06T01:46:24Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "<!-- Please include a self-contained copy-pastable example that generates the issue if possible.\r\n\r\nPlease be concise with code posted. See guidelines below on how to provide a good bug report:\r\n\r\n- Craft Minimal Bug Reports http://matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports\r\n- Minimal Complete Verifiable Examples https://stackoverflow.com/help/mcve\r\n\r\nBug reports that follow these guidelines are easier to diagnose, and so are often handled much more quickly.\r\n-->\r\n\r\n**Describe the issue**:\r\n\r\nWhen we set the `DASK_CONFIG` environment variable to the path of a YAML file, the content of this file can be changed and reloaded but the path can not be changed and lead to inconsistent behavior. As you can see in the MCVE bellow, changing the `DASK_CONFIG` variable programmatically is properly reflected in the result of `dask.config.collect()` but the new file is actually not loaded by `dask.config.refresh()`. So it's not consistent.\r\n\r\nAs far as I can see, the internal config paths are globally set during the import phase and are not updated afterwards (see https://github.com/dask/dask/blob/main/dask/config.py#L41). So I think the `dask.config.refresh()` should also refresh the path list.\r\n\r\nOr maybe this behavior is expected? But that would be a bit weird IMO.\r\n\r\n**Minimal Complete Verifiable Example**:\r\n\r\n```python\r\nimport os\r\nimport yaml\r\n\r\nwith open(\"initial_config.yml\", \"w\", encoding=\"utf-8\") as f:\r\n    yaml.dump({\"foo\": \"bar\"}, f)\r\n\r\nwith open(\"new_config.yml\", \"w\", encoding=\"utf-8\") as f:\r\n    yaml.dump({\"foo\": \"not_bar\"}, f)\r\n\r\nos.environ[\"DASK_CONFIG\"] = \"initial_config.yml\"\r\n\r\nimport dask\r\n\r\nprint(\"Initial config:\", dask.config.get(\"foo\"))\r\nprint(\"Initial dask.config.collect():\", dask.config.collect())\r\n\r\ndask.config.refresh()\r\nprint(\"Config after refresh:\", dask.config.get(\"foo\"))\r\n\r\nos.environ[\"DASK_CONFIG\"] = \"new_config.yml\"\r\ndask.config.refresh()\r\nprint(\"Config after refresh with new DASK_CONFIG:\", dask.config.get(\"foo\"))\r\nprint(\"Final dask.config.collect():\", dask.config.collect())\r\n```\r\n\r\nouput:\r\n```bash\r\nInitial config: bar\r\nInitial dask.config.collect(): {'foo': 'bar', 'config': 'initial_config.yml'}\r\nConfig after refresh: bar\r\nConfig after refresh with new DASK_CONFIG: bar\r\nFinal dask.config.collect(): {'foo': 'bar', 'config': 'new_config.yml'}\r\n```\r\n\r\n**Environment**:\r\n\r\n- Dask version: 2023.9.3\r\n- Python version: 3.10.12\r\n- Operating System: Linux\r\n- Install method (conda, pip, source): pip\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/10548/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/10548/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}