{
    "url": "https://api.github.com/repos/dask/dask/issues/4344",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/4344/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/4344/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/4344/events",
    "html_url": "https://github.com/dask/dask/issues/4344",
    "id": 394975257,
    "node_id": "MDU6SXNzdWUzOTQ5NzUyNTc=",
    "number": 4344,
    "title": "Dask slow in simple benchmark",
    "user": {
        "login": "andaag",
        "id": 826023,
        "node_id": "MDQ6VXNlcjgyNjAyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/826023?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andaag",
        "html_url": "https://github.com/andaag",
        "followers_url": "https://api.github.com/users/andaag/followers",
        "following_url": "https://api.github.com/users/andaag/following{/other_user}",
        "gists_url": "https://api.github.com/users/andaag/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/andaag/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/andaag/subscriptions",
        "organizations_url": "https://api.github.com/users/andaag/orgs",
        "repos_url": "https://api.github.com/users/andaag/repos",
        "events_url": "https://api.github.com/users/andaag/events{/privacy}",
        "received_events_url": "https://api.github.com/users/andaag/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862289,
            "node_id": "MDU6TGFiZWwyNDI4NjIyODk=",
            "url": "https://api.github.com/repos/dask/dask/labels/dataframe",
            "name": "dataframe",
            "color": "fbca04",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-12-31T12:42:39Z",
    "updated_at": "2021-10-12T07:38:46Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "So this is in the category \"I'm not sure I should open a bug\", as it might be me being new to dask and not understanding why this operation is slow.\r\n\r\nSee https://gist.github.com/andaag/207fcdc6965b86b7085406221279e4c2\r\n\r\n## With pandas:\r\n```\r\ndf3['test2'] = df3['salary'].apply(f)\r\n```\r\nRuntime 22 seconds.\r\n\r\n## With dask:\r\n```\r\n%%time\r\ndfn['test'] = dfn['salary'].apply(f, meta=('x', 'f8'))\r\ndfn.compute()\r\n```\r\nRuntime 36 seconds - ok, it's a fairly small sample, but that seems like huge overhead for the extra threads we're adding... Lets try with a custom parallel function that tears the array apart, runs parallel tasks then puts it back together again to rule that out.\r\n\r\n## With custom parallel function:\r\n```\r\n%%time\r\ndf3['test'] = parallel(df3['salary'], f, n_jobs=n_jobs)\r\n```\r\nRuntime 4.7 seconds. What's going on here?\r\n\r\n\r\nIf dask is slow in this case due to the overhead of parallelization my custom function should not be faster.\r\n\r\nThis experiment is run inside of https://hub.docker.com/r/andaag/aibox_cuda9, which is built from https://github.com/andaag/aibox. (Which is huge due to deep learning libraries and cuda.. sorry)",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/4344/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/4344/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}