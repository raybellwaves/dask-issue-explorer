[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948567262",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948567262",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948567262,
        "node_id": "IC_kwDOAbcwm850JMbe",
        "user": {
            "login": "crusaderky",
            "id": 6213168,
            "node_id": "MDQ6VXNlcjYyMTMxNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/crusaderky",
            "html_url": "https://github.com/crusaderky",
            "followers_url": "https://api.github.com/users/crusaderky/followers",
            "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
            "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
            "organizations_url": "https://api.github.com/users/crusaderky/orgs",
            "repos_url": "https://api.github.com/users/crusaderky/repos",
            "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
            "received_events_url": "https://api.github.com/users/crusaderky/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T15:11:24Z",
        "updated_at": "2024-02-16T15:11:24Z",
        "author_association": "MEMBER",
        "body": "@jrbourbeau @phofl how should we deal with this? It's impossible to replicate pandas' current (and deprecated) behaviour, as it would require us to eagerly compute everything until that moment for lhs in order to determine its dtype: \r\n\r\n```python\r\nout.dtype = dd.isna(lhs).all().compute() ? rhs.dtype : lhs.dtype\r\n```\r\n\r\nThe current behaviour (which I'm not too excited about) is to have `out.dtype = in.dtype` for the dask collection and to match pandas for the computed output; in other words `out.dtype != out.compute().dtype`.\r\nThere may however be FutureWarnings that don't happen in pandas as the isna(lhs).all() is tested individually for every chunk (the PR linked below makes a trivial example).\r\nFor datetime64, the current behaviour is to always return lhs.dtype, which differs from pandas.\r\n\r\nOne option is to quietly perform `rhs.astype(lhs.dtype)`; this means that dask will change its output overnight to what's going to be in pandas 3.0(?).\r\nAnother option is do nothing, which means dask will keep occasionally producing spurious FutureWarnings and/or have mismatched dtype at times.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948567262/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948616547",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948616547",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948616547,
        "node_id": "IC_kwDOAbcwm850JYdj",
        "user": {
            "login": "crusaderky",
            "id": 6213168,
            "node_id": "MDQ6VXNlcjYyMTMxNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/crusaderky",
            "html_url": "https://github.com/crusaderky",
            "followers_url": "https://api.github.com/users/crusaderky/followers",
            "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
            "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
            "organizations_url": "https://api.github.com/users/crusaderky/orgs",
            "repos_url": "https://api.github.com/users/crusaderky/repos",
            "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
            "received_events_url": "https://api.github.com/users/crusaderky/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T15:27:32Z",
        "updated_at": "2024-02-16T15:27:32Z",
        "author_association": "MEMBER",
        "body": "A third option is to print a RuntimeWarning at graph definition time every time lhs.dtype != rhs.dtype, and then implement pandas 3's behaviour of sticking with lhs.dtype.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948616547/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948616564",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948616564",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948616564,
        "node_id": "IC_kwDOAbcwm850JYd0",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T15:27:33Z",
        "updated_at": "2024-02-16T15:27:33Z",
        "author_association": "MEMBER",
        "body": "we can just filter the warning and be done with it?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948616564/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948619585",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948619585",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948619585,
        "node_id": "IC_kwDOAbcwm850JZNB",
        "user": {
            "login": "crusaderky",
            "id": 6213168,
            "node_id": "MDQ6VXNlcjYyMTMxNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/crusaderky",
            "html_url": "https://github.com/crusaderky",
            "followers_url": "https://api.github.com/users/crusaderky/followers",
            "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
            "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
            "organizations_url": "https://api.github.com/users/crusaderky/orgs",
            "repos_url": "https://api.github.com/users/crusaderky/repos",
            "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
            "received_events_url": "https://api.github.com/users/crusaderky/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T15:28:30Z",
        "updated_at": "2024-02-16T15:28:42Z",
        "author_association": "MEMBER",
        "body": "> we can just filter the warning and be done with it?\r\n\r\nthat would mean that out.compute().dtype != out.dtype, and that the output dtype will change overnight when the user upgrades to pandas 3.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948619585/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948651954",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948651954",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948651954,
        "node_id": "IC_kwDOAbcwm850JhGy",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T15:38:46Z",
        "updated_at": "2024-02-16T15:38:46Z",
        "author_association": "MEMBER",
        "body": "> that would mean that out.compute().dtype != out.dtype\r\n\r\nThis happens in multiple places, I wouldn't worry too much about it.\r\n\r\n> that the output dtype will change overnight when the user upgrades to pandas 3.\r\n\r\nNot great but could be worse imo.\r\n\r\nI wouldn't spend too much time on this, having all nan partitions in this combination is not something that is very likely and combine_first is not used much in the pandas space",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948651954/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1948819093",
        "html_url": "https://github.com/dask/dask/issues/10931#issuecomment-1948819093",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10931",
        "id": 1948819093,
        "node_id": "IC_kwDOAbcwm850KJ6V",
        "user": {
            "login": "crusaderky",
            "id": 6213168,
            "node_id": "MDQ6VXNlcjYyMTMxNjg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/crusaderky",
            "html_url": "https://github.com/crusaderky",
            "followers_url": "https://api.github.com/users/crusaderky/followers",
            "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
            "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
            "organizations_url": "https://api.github.com/users/crusaderky/orgs",
            "repos_url": "https://api.github.com/users/crusaderky/repos",
            "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
            "received_events_url": "https://api.github.com/users/crusaderky/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-02-16T16:30:05Z",
        "updated_at": "2024-02-16T16:30:05Z",
        "author_association": "MEMBER",
        "body": "https://github.com/dask/dask/pull/10932 fixes the flaky test",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1948819093/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]