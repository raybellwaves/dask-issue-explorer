[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/512767251",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-512767251",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 512767251,
        "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjc2NzI1MQ==",
        "user": {
            "login": "pentschev",
            "id": 4398246,
            "node_id": "MDQ6VXNlcjQzOTgyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pentschev",
            "html_url": "https://github.com/pentschev",
            "followers_url": "https://api.github.com/users/pentschev/followers",
            "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
            "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
            "organizations_url": "https://api.github.com/users/pentschev/orgs",
            "repos_url": "https://api.github.com/users/pentschev/repos",
            "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pentschev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-07-18T10:53:06Z",
        "updated_at": "2019-07-18T10:53:06Z",
        "author_association": "MEMBER",
        "body": "Interestingly, I can't reproduce this:\r\n\r\n```python\r\nIn [1]: import dask.array as da, dask, sparse\r\n\r\nIn [2]: dask.__version__\r\nOut[2]: '2.1.0'\r\n\r\nIn [3]: sparse.__version__\r\nOut[3]: '0.7.0'\r\n\r\nIn [4]: a = sparse.coo.zeros(10)\r\n\r\nIn [5]: (1 / a).todense()\r\n/home/pentschev/miniconda3/envs/sparse-inf/lib/python3.7/site-packages/sparse/coo/umath.py:472: RuntimeWarning: divide by zero encountered in true_divide\r\n  fill_value_array = self.func(*zero_args, dtype=self.dtype, **self.kwargs)\r\nOut[5]: array([inf, inf, inf, inf, inf, inf, inf, inf, inf, inf])\r\n\r\nIn [6]: b = da.zeros(10).map_blocks(sparse.COO)\r\n\r\nIn [7]: (1 / b).compute().todense()\r\n/home/pentschev/miniconda3/envs/sparse-inf/lib/python3.7/site-packages/sparse/coo/umath.py:472: RuntimeWarning: divide by zero encountered in true_divide\r\n  fill_value_array = self.func(*zero_args, dtype=self.dtype, **self.kwargs)\r\n/home/pentschev/miniconda3/envs/sparse-inf/lib/python3.7/site-packages/sparse/coo/umath.py:472: RuntimeWarning: divide by zero encountered in true_divide\r\n  fill_value_array = self.func(*zero_args, dtype=self.dtype, **self.kwargs)\r\nOut[7]: array([inf, inf, inf, inf, inf, inf, inf, inf, inf, inf])\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/512767251/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/512767408",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-512767408",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 512767408,
        "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjc2NzQwOA==",
        "user": {
            "login": "pentschev",
            "id": 4398246,
            "node_id": "MDQ6VXNlcjQzOTgyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pentschev",
            "html_url": "https://github.com/pentschev",
            "followers_url": "https://api.github.com/users/pentschev/followers",
            "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
            "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
            "organizations_url": "https://api.github.com/users/pentschev/orgs",
            "repos_url": "https://api.github.com/users/pentschev/repos",
            "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pentschev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-07-18T10:53:40Z",
        "updated_at": "2019-07-18T10:53:40Z",
        "author_association": "MEMBER",
        "body": "Btw, I created a new conda environment, installing Dask 2.1.0 from Anaconda, and Sparse 0.7.0 from conda-forge.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/512767408/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/512778423",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-512778423",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 512778423,
        "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjc3ODQyMw==",
        "user": {
            "login": "philipp-block",
            "id": 24493918,
            "node_id": "MDQ6VXNlcjI0NDkzOTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/24493918?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/philipp-block",
            "html_url": "https://github.com/philipp-block",
            "followers_url": "https://api.github.com/users/philipp-block/followers",
            "following_url": "https://api.github.com/users/philipp-block/following{/other_user}",
            "gists_url": "https://api.github.com/users/philipp-block/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/philipp-block/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/philipp-block/subscriptions",
            "organizations_url": "https://api.github.com/users/philipp-block/orgs",
            "repos_url": "https://api.github.com/users/philipp-block/repos",
            "events_url": "https://api.github.com/users/philipp-block/events{/privacy}",
            "received_events_url": "https://api.github.com/users/philipp-block/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-07-18T11:31:42Z",
        "updated_at": "2019-07-18T11:31:42Z",
        "author_association": "NONE",
        "body": "Thanks @pentschev for the quick reply.\r\n\r\nYou're right, it's not reproducible that way if run in a fresh environment. Sorry. \r\n\r\nAfter looking into it, the difference seems to be using the `LocalCluster` scheduler which I still had in context.\r\n\r\nYou can reproduce it in a fresh docker container:\r\n\r\nDockerfile:\r\n```Dockerfile\r\nFROM python:3.7\r\nRUN pip install dask[complete] sparse\r\nCMD python\r\n```\r\nThen run this code:\r\n```python\r\nimport dask\r\nimport dask.array as da\r\nfrom distributed import Client, LocalCluster\r\nimport sparse\r\nprint(f\"dask version {dask.__version__}\")\r\nprint(f\"sparse version {sparse.__version__}\")\r\n\r\ncluster = LocalCluster()\r\nclient = Client(cluster)\r\n\r\ncoo = da.zeros(10).map_blocks(sparse.COO)\r\n\r\nprint((1 / coo).compute().todense())\r\nprint((1 / coo.compute()).todense())\r\n```\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/512778423/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/512798207",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-512798207",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 512798207,
        "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjc5ODIwNw==",
        "user": {
            "login": "pentschev",
            "id": 4398246,
            "node_id": "MDQ6VXNlcjQzOTgyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4398246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pentschev",
            "html_url": "https://github.com/pentschev",
            "followers_url": "https://api.github.com/users/pentschev/followers",
            "following_url": "https://api.github.com/users/pentschev/following{/other_user}",
            "gists_url": "https://api.github.com/users/pentschev/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pentschev/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pentschev/subscriptions",
            "organizations_url": "https://api.github.com/users/pentschev/orgs",
            "repos_url": "https://api.github.com/users/pentschev/repos",
            "events_url": "https://api.github.com/users/pentschev/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pentschev/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-07-18T12:41:00Z",
        "updated_at": "2019-07-18T12:41:00Z",
        "author_association": "MEMBER",
        "body": "Indeed, I can reproduce this as long as there's a distributed cluster/client (no need for Docker). I'm not sure how that can affect results in such a way. Any ideas @mrocklin?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/512798207/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/941819881",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-941819881",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 941819881,
        "node_id": "IC_kwDOAbcwm844Iwfp",
        "user": {
            "login": "GenevieveBuckley",
            "id": 30920819,
            "node_id": "MDQ6VXNlcjMwOTIwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30920819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GenevieveBuckley",
            "html_url": "https://github.com/GenevieveBuckley",
            "followers_url": "https://api.github.com/users/GenevieveBuckley/followers",
            "following_url": "https://api.github.com/users/GenevieveBuckley/following{/other_user}",
            "gists_url": "https://api.github.com/users/GenevieveBuckley/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GenevieveBuckley/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GenevieveBuckley/subscriptions",
            "organizations_url": "https://api.github.com/users/GenevieveBuckley/orgs",
            "repos_url": "https://api.github.com/users/GenevieveBuckley/repos",
            "events_url": "https://api.github.com/users/GenevieveBuckley/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GenevieveBuckley/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-13T01:18:52Z",
        "updated_at": "2021-10-13T01:18:52Z",
        "author_association": "MEMBER",
        "body": "@hameerabbasi is this something you've run into as well?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/941819881/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/941897727",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-941897727",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 941897727,
        "node_id": "IC_kwDOAbcwm844JDf_",
        "user": {
            "login": "hameerabbasi",
            "id": 2190658,
            "node_id": "MDQ6VXNlcjIxOTA2NTg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2190658?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hameerabbasi",
            "html_url": "https://github.com/hameerabbasi",
            "followers_url": "https://api.github.com/users/hameerabbasi/followers",
            "following_url": "https://api.github.com/users/hameerabbasi/following{/other_user}",
            "gists_url": "https://api.github.com/users/hameerabbasi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hameerabbasi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hameerabbasi/subscriptions",
            "organizations_url": "https://api.github.com/users/hameerabbasi/orgs",
            "repos_url": "https://api.github.com/users/hameerabbasi/repos",
            "events_url": "https://api.github.com/users/hameerabbasi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hameerabbasi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-13T04:04:13Z",
        "updated_at": "2021-10-13T04:04:49Z",
        "author_association": "CONTRIBUTOR",
        "body": "Unfortunately not, but I can look into it. As a side note, that version of sparse is pretty old.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/941897727/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/941903076",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-941903076",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 941903076,
        "node_id": "IC_kwDOAbcwm844JEzk",
        "user": {
            "login": "GenevieveBuckley",
            "id": 30920819,
            "node_id": "MDQ6VXNlcjMwOTIwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30920819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GenevieveBuckley",
            "html_url": "https://github.com/GenevieveBuckley",
            "followers_url": "https://api.github.com/users/GenevieveBuckley/followers",
            "following_url": "https://api.github.com/users/GenevieveBuckley/following{/other_user}",
            "gists_url": "https://api.github.com/users/GenevieveBuckley/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GenevieveBuckley/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GenevieveBuckley/subscriptions",
            "organizations_url": "https://api.github.com/users/GenevieveBuckley/orgs",
            "repos_url": "https://api.github.com/users/GenevieveBuckley/repos",
            "events_url": "https://api.github.com/users/GenevieveBuckley/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GenevieveBuckley/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-13T04:13:21Z",
        "updated_at": "2021-10-13T04:13:21Z",
        "author_association": "MEMBER",
        "body": "Thanks @hameerabbasi \r\n\r\n> As a side note, that version of sparse is pretty old.\r\n\r\nI just tried this out with the most recent version of sparse 0.13.0, and can reproduce the same error. So upgrading is a helpful tip, but doesn't solve this particular issue.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/941903076/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/941957949",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-941957949",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 941957949,
        "node_id": "IC_kwDOAbcwm844JSM9",
        "user": {
            "login": "hameerabbasi",
            "id": 2190658,
            "node_id": "MDQ6VXNlcjIxOTA2NTg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2190658?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hameerabbasi",
            "html_url": "https://github.com/hameerabbasi",
            "followers_url": "https://api.github.com/users/hameerabbasi/followers",
            "following_url": "https://api.github.com/users/hameerabbasi/following{/other_user}",
            "gists_url": "https://api.github.com/users/hameerabbasi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hameerabbasi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hameerabbasi/subscriptions",
            "organizations_url": "https://api.github.com/users/hameerabbasi/orgs",
            "repos_url": "https://api.github.com/users/hameerabbasi/repos",
            "events_url": "https://api.github.com/users/hameerabbasi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hameerabbasi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-13T06:16:24Z",
        "updated_at": "2021-10-13T06:16:24Z",
        "author_association": "CONTRIBUTOR",
        "body": "I tried running a few simple tests with `stack`, `concat` and `pickle` to see if they preserve fill-values (they do). Are there any other primitives I'm missing?\r\n\r\n```python\r\n>>> import sparse\r\n>>> coo = sparse.zeros(10)\r\n>>> coo\r\n<COO: shape=(10,), dtype=float64, nnz=0, fill_value=0.0>\r\n>>> coo1, coo2 = coo[:5], coo[5:]\r\n>>> a1, a2 = 1/coo1, 1/coo2\r\n/Users/hameerabbasi/Code/sparse/sparse/_umath.py:541: RuntimeWarning: divide by zero encountered in true_divide\r\n  fill_value_array = self.func(\r\n>>> a1\r\n<COO: shape=(5,), dtype=float64, nnz=0, fill_value=inf>\r\n>>> a2\r\n<COO: shape=(5,), dtype=float64, nnz=0, fill_value=inf>\r\n>>> sparse.concatenate([a1, a2])\r\n<COO: shape=(10,), dtype=float64, nnz=0, fill_value=inf>\r\n>>> sparse.stack([a1, a2])\r\n<COO: shape=(2, 5), dtype=float64, nnz=0, fill_value=inf>\r\n>>>\r\n>>> pickle.loads(pickle.dumps(a1))\r\n<COO: shape=(5,), dtype=float64, nnz=0, fill_value=inf>\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/941957949/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/941968264",
        "html_url": "https://github.com/dask/dask/issues/5110#issuecomment-941968264",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5110",
        "id": 941968264,
        "node_id": "IC_kwDOAbcwm844JUuI",
        "user": {
            "login": "GenevieveBuckley",
            "id": 30920819,
            "node_id": "MDQ6VXNlcjMwOTIwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30920819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GenevieveBuckley",
            "html_url": "https://github.com/GenevieveBuckley",
            "followers_url": "https://api.github.com/users/GenevieveBuckley/followers",
            "following_url": "https://api.github.com/users/GenevieveBuckley/following{/other_user}",
            "gists_url": "https://api.github.com/users/GenevieveBuckley/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GenevieveBuckley/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GenevieveBuckley/subscriptions",
            "organizations_url": "https://api.github.com/users/GenevieveBuckley/orgs",
            "repos_url": "https://api.github.com/users/GenevieveBuckley/repos",
            "events_url": "https://api.github.com/users/GenevieveBuckley/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GenevieveBuckley/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-13T06:34:37Z",
        "updated_at": "2021-10-13T06:34:37Z",
        "author_association": "MEMBER",
        "body": "> Are there any other primitives I'm missing?\r\n\r\nI'm not sure, @pentschev can you think of any?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/941968264/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]