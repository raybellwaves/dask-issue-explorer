[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/579553855",
        "html_url": "https://github.com/dask/dask/issues/5837#issuecomment-579553855",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5837",
        "id": 579553855,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTU1Mzg1NQ==",
        "user": {
            "login": "jakirkham",
            "id": 3019665,
            "node_id": "MDQ6VXNlcjMwMTk2NjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jakirkham",
            "html_url": "https://github.com/jakirkham",
            "followers_url": "https://api.github.com/users/jakirkham/followers",
            "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
            "organizations_url": "https://api.github.com/users/jakirkham/orgs",
            "repos_url": "https://api.github.com/users/jakirkham/repos",
            "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jakirkham/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-29T01:38:54Z",
        "updated_at": "2020-01-29T01:38:54Z",
        "author_association": "MEMBER",
        "body": "Running this I see the following error message:\r\n\r\n```python\r\nValueError: Metadata inference failed in `_groupby_apply_funcs`.\r\n\r\nYou have supplied a custom function and Dask is unable to \r\ndetermine the type of output that that function returns. \r\n\r\nTo resolve this please provide a meta= keyword.\r\nThe docstring of the Dask function you ran should have more information.\r\n```\r\n\r\nBasically this means Dask is trying to determine the expected type of the data from running some dummy data through the functions you provided. Usually this works and life is grand! Unfortunately in some more complex cases it falls over. So the solution to this is to provide some dummy data as an example of what will be produced to guide Dask.\r\n\r\nThat said, I'm not completely clear on how we would do this in this case. @TomAugspurger would you be able to advise? \ud83d\ude42",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/579553855/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/579873746",
        "html_url": "https://github.com/dask/dask/issues/5837#issuecomment-579873746",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5837",
        "id": 579873746,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTg3Mzc0Ng==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-29T17:39:19Z",
        "updated_at": "2020-01-29T17:39:19Z",
        "author_association": "MEMBER",
        "body": "It's interesting that the custom aggregation works when it's used alone though.  I wonder if there is a bug in how we determine metadata with multiple aggregations.\r\n\r\nAlso @joshua-gould thank you for the excellent bug report and minimal reproducible example.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/579873746/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/581653978",
        "html_url": "https://github.com/dask/dask/issues/5837#issuecomment-581653978",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5837",
        "id": 581653978,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4MTY1Mzk3OA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-02-03T22:40:40Z",
        "updated_at": "2020-02-03T22:40:40Z",
        "author_association": "MEMBER",
        "body": "The immediate cause of the example is trying to construct a DataFrame from a dict of Series with differing indices.\r\n\r\n```python\r\n(Pdb) pp list(result.values())[0]\r\n0    x\r\n1.0  a    2\r\nName: x, dtype: int64\r\n(Pdb) pp list(result.values())[1]\r\n0\r\n1.0    1.0\r\nName: 1, dtype: float64\r\n```\r\n\r\nWe call DataFrame on that result, which raises the original exception. Those values come from the different result indexes of `value_counts` and `min`.\r\n\r\n```python\r\n(Pdb) pp grouped.x.value_counts()\r\n0    x\r\n1.0  a    2\r\nName: x, dtype: int64\r\n(Pdb) pp grouped[1].min()\r\n0\r\n1.0    1.0\r\nName: 1, dtype: float64\r\n```\r\n\r\nSo @joshua-gould I would recommend looking at your `mode_chunk` method to see what the expected output should be. Do you need a MultiIndex there? Perhaps you can reset that level of the MultiIndex and update your other agg components as needed?\r\n\r\nOtherwise, it's possible we could avoid creating that DataFrame in `_groupby_apply_funcs`, but I'm not sure how much effort that will be.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/581653978/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/621879210",
        "html_url": "https://github.com/dask/dask/issues/5837#issuecomment-621879210",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5837",
        "id": 621879210,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTg3OTIxMA==",
        "user": {
            "login": "quasiben",
            "id": 1403768,
            "node_id": "MDQ6VXNlcjE0MDM3Njg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1403768?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/quasiben",
            "html_url": "https://github.com/quasiben",
            "followers_url": "https://api.github.com/users/quasiben/followers",
            "following_url": "https://api.github.com/users/quasiben/following{/other_user}",
            "gists_url": "https://api.github.com/users/quasiben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/quasiben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/quasiben/subscriptions",
            "organizations_url": "https://api.github.com/users/quasiben/orgs",
            "repos_url": "https://api.github.com/users/quasiben/repos",
            "events_url": "https://api.github.com/users/quasiben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/quasiben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-04-30T14:13:26Z",
        "updated_at": "2020-04-30T14:13:26Z",
        "author_association": "MEMBER",
        "body": "@joshua-gould are you still running into issues here ?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/621879210/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/622482367",
        "html_url": "https://github.com/dask/dask/issues/5837#issuecomment-622482367",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5837",
        "id": 622482367,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjQ4MjM2Nw==",
        "user": {
            "login": "joshua-gould",
            "id": 5237151,
            "node_id": "MDQ6VXNlcjUyMzcxNTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5237151?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/joshua-gould",
            "html_url": "https://github.com/joshua-gould",
            "followers_url": "https://api.github.com/users/joshua-gould/followers",
            "following_url": "https://api.github.com/users/joshua-gould/following{/other_user}",
            "gists_url": "https://api.github.com/users/joshua-gould/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/joshua-gould/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/joshua-gould/subscriptions",
            "organizations_url": "https://api.github.com/users/joshua-gould/orgs",
            "repos_url": "https://api.github.com/users/joshua-gould/repos",
            "events_url": "https://api.github.com/users/joshua-gould/events{/privacy}",
            "received_events_url": "https://api.github.com/users/joshua-gould/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-05-01T17:28:47Z",
        "updated_at": "2020-05-01T17:28:47Z",
        "author_association": "NONE",
        "body": "I'm not using dask for this task, currently. Thanks.\n\nOn Thu, Apr 30, 2020 at 10:13 AM Benjamin Zaitlen <notifications@github.com>\nwrote:\n\n> @joshua-gould <https://github.com/joshua-gould> are you still running\n> into issues here ?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5837#issuecomment-621879210>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABH6THY7OZB6SB7BL74J7FLRPGBRPANCNFSM4KMZLSOQ>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/622482367/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]