{
    "url": "https://api.github.com/repos/dask/dask/issues/10034",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/10034/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/10034/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/10034/events",
    "html_url": "https://github.com/dask/dask/issues/10034",
    "id": 1614833261,
    "node_id": "I_kwDOAbcwm85gQGZt",
    "number": 10034,
    "title": "Non deterministic groupby result when using disk / partd shuffle method ",
    "user": {
        "login": "fjetter",
        "id": 8629629,
        "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8629629?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjetter",
        "html_url": "https://github.com/fjetter",
        "followers_url": "https://api.github.com/users/fjetter/followers",
        "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
        "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
        "organizations_url": "https://api.github.com/users/fjetter/orgs",
        "repos_url": "https://api.github.com/users/fjetter/repos",
        "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
        "received_events_url": "https://api.github.com/users/fjetter/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862289,
            "node_id": "MDU6TGFiZWwyNDI4NjIyODk=",
            "url": "https://api.github.com/repos/dask/dask/labels/dataframe",
            "name": "dataframe",
            "color": "fbca04",
            "default": false,
            "description": null
        },
        {
            "id": 1342304743,
            "node_id": "MDU6TGFiZWwxMzQyMzA0NzQz",
            "url": "https://api.github.com/repos/dask/dask/labels/core",
            "name": "core",
            "color": "000000",
            "default": false,
            "description": ""
        },
        {
            "id": 3468123446,
            "node_id": "LA_kwDOAbcwm87Ot102",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20attention",
            "name": "needs attention",
            "color": "6d626c",
            "default": false,
            "description": "It's been a while since this was pushed on. Needs attention from the owner or a maintainer."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2023-03-08T08:13:32Z",
    "updated_at": "2024-03-04T01:47:55Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "When running a groupby using the default disk backend I am receiving non-deterministic results\r\n\r\n```python\r\nimport dask.dataframe as dd\r\nimport pandas as pd\r\n\r\ndf = pd.DataFrame({\r\n        'plain_int64': [1, 2, 3],\r\n        'dup_strings': [0, 1, 0]\r\n    })\r\n\r\nddf = dd.from_pandas(df, npartitions=2)\r\ndd_series = ddf.groupby('dup_strings').transform('first')\r\ndd_series.compute()\r\n```\r\n\r\nMost of the time, this example returns\r\n\r\n /  | plain_int64               \r\n-- | --\r\n1 | 2\r\n0 | 1\r\n2 | 1\r\n\r\nbut in about 2-3% I get a different result\r\n /  | plain_int64               \r\n-- | --\r\n1 | 2\r\n2 | 3\r\n0 | 3\r\n\r\n\r\npandas output is\r\n\r\n /  | plain_int64               \r\n-- | --\r\n0 | 1\r\n1 | 2\r\n2 | 1\r\n\r\n\r\nWhen switching to the `tasks` backend using\r\n\r\n```python\r\nimport dask\r\ndask.config.set({\"dataframe.shuffle.method\": \"tasks\"})\r\n``` \r\n\r\nthis goes away.\r\n\r\nNote: whoever is using a distributed cluster will automatically use the `tasks` or `p2p` backend and will not be affected by this",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/10034/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/10034/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}