{
    "url": "https://api.github.com/repos/dask/dask/issues/3245",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/3245/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/3245/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/3245/events",
    "html_url": "https://github.com/dask/dask/issues/3245",
    "id": 302182457,
    "node_id": "MDU6SXNzdWUzMDIxODI0NTc=",
    "number": 3245,
    "title": "Silencing warnings issued by numpy functions within dask.array",
    "user": {
        "login": "shoyer",
        "id": 1217238,
        "node_id": "MDQ6VXNlcjEyMTcyMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1217238?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shoyer",
        "html_url": "https://github.com/shoyer",
        "followers_url": "https://api.github.com/users/shoyer/followers",
        "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
        "organizations_url": "https://api.github.com/users/shoyer/orgs",
        "repos_url": "https://api.github.com/users/shoyer/repos",
        "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shoyer/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 29,
    "created_at": "2018-03-05T06:08:49Z",
    "updated_at": "2023-04-18T14:01:56Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "NumPy's NaN-skipping aggregation functions issue warnings when they encounter all NaN slices, e.g.,\r\n```\r\nIn [2]: np.nanmean([np.nan])\r\n/Users/shoyer/miniconda3/envs/xarray-py36/bin/ipython:1: RuntimeWarning: Mean of empty slice\r\n  #!/Users/shoyer/miniconda3/envs/xarray-py36/bin/python\r\nOut[2]: nan\r\n```\r\n\r\nAs far as xarray is concerned, NaN is the right answer for these cases. So we silence these NumPy warnings, which works with NumPy, but unfortunately not with dask.array:\r\n- Functions like `np.nanmean` issue warnings at compute time, outside our `warnings.catch_warnings()` context.\r\n- Sometimes, dask arrays operations end up issuing new warnings (e.g., due to division by 0 when calculating the mean). \r\n\r\nSome possibilities for dealing with this:\r\n1. Issue these irrelevant warnings, which needlessly annoys and distracts users. This is the current status quo.\r\n2. Silence these warnings unilaterally, which could hide bugs in non-xarray code.\r\n3. Rewrite the relevant dask.array functions to optionally call warning silenced version of NumPy functions. This would need to be in dask.array itself to be maintainable, but there isn't a good place in dask.array's API to inject lists of warnings to silence.\r\n5. *Always* silence warnings when computing with dask, under the theory that warnings without good stacklevel identification are not so useful and  these get lost when computing with processes anyways. This seems like wishful thinking.\r\n6. Add some magic to dask where it automatically logs warnings filters that were activated when a lazy function was added to a dask graph, and then restores them with executing the function. This sounds like the cleanest option, but it might have prohibitively large overhead. Possibly we could do this only for functions known to issue warnings, but if we were really careful about this it would be a very long list (e.g., including any numpy function that does division).\r\n\r\nxref https://github.com/pydata/xarray/issues/1652",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/3245/reactions",
        "total_count": 10,
        "+1": 10,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/3245/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}