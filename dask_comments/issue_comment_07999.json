[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/893648147",
        "html_url": "https://github.com/dask/dask/issues/7999#issuecomment-893648147",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7999",
        "id": 893648147,
        "node_id": "IC_kwDOAbcwm841Q_0T",
        "user": {
            "login": "douglasdavis",
            "id": 3202090,
            "node_id": "MDQ6VXNlcjMyMDIwOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3202090?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/douglasdavis",
            "html_url": "https://github.com/douglasdavis",
            "followers_url": "https://api.github.com/users/douglasdavis/followers",
            "following_url": "https://api.github.com/users/douglasdavis/following{/other_user}",
            "gists_url": "https://api.github.com/users/douglasdavis/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/douglasdavis/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/douglasdavis/subscriptions",
            "organizations_url": "https://api.github.com/users/douglasdavis/orgs",
            "repos_url": "https://api.github.com/users/douglasdavis/repos",
            "events_url": "https://api.github.com/users/douglasdavis/events{/privacy}",
            "received_events_url": "https://api.github.com/users/douglasdavis/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-05T17:26:42Z",
        "updated_at": "2021-08-05T17:41:37Z",
        "author_association": "MEMBER",
        "body": "Thanks for raising this @miguelcarcamov - I was actually pointed to your StackExchange post and after a little digging I also think there's potential for a bug. I'll keep poking around.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/893648147/reactions",
            "total_count": 1,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 1
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/893685171",
        "html_url": "https://github.com/dask/dask/issues/7999#issuecomment-893685171",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7999",
        "id": 893685171,
        "node_id": "IC_kwDOAbcwm841RI2z",
        "user": {
            "login": "douglasdavis",
            "id": 3202090,
            "node_id": "MDQ6VXNlcjMyMDIwOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3202090?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/douglasdavis",
            "html_url": "https://github.com/douglasdavis",
            "followers_url": "https://api.github.com/users/douglasdavis/followers",
            "following_url": "https://api.github.com/users/douglasdavis/following{/other_user}",
            "gists_url": "https://api.github.com/users/douglasdavis/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/douglasdavis/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/douglasdavis/subscriptions",
            "organizations_url": "https://api.github.com/users/douglasdavis/orgs",
            "repos_url": "https://api.github.com/users/douglasdavis/repos",
            "events_url": "https://api.github.com/users/douglasdavis/events{/privacy}",
            "received_events_url": "https://api.github.com/users/douglasdavis/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-05T18:26:28Z",
        "updated_at": "2021-08-05T18:32:12Z",
        "author_association": "MEMBER",
        "body": "If `shape` and `dtype` are not defined, then Dask will infer them in `apply_along_blocks` here:\r\nhttps://github.com/dask/dask/blob/aaccbec0e04fd2ebbcaf848051f508fa1107663e/dask/array/routines.py#L460-L467\r\n\r\nWith `*args` and `**kwargs` getting passed to a test function call of `bincount`. I think there may be a bug there (or it might be a misuse of the API); since `*args` contains a Dask array, NumPy is dispatching (via the `__array_function__` interface) to Dask's implementation of `bincount`. Still trying to come up with a solution.\r\n\r\nOn another note: the function you are passing to `apply_along_blocks` should not be calling `dask.array`; Dask will map the function across all of the blocks (NumPy arrays) which make up the Dask collection (the Dask array). You probably want to do something like:\r\n\r\n```python\r\ndef my_bincount(weight, x):\r\n    return np.bincount(x, weight)\r\n\r\napply_along_blocks(my_bincount, ...)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/893685171/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/893689794",
        "html_url": "https://github.com/dask/dask/issues/7999#issuecomment-893689794",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7999",
        "id": 893689794,
        "node_id": "IC_kwDOAbcwm841RJ_C",
        "user": {
            "login": "miguelcarcamov",
            "id": 5432126,
            "node_id": "MDQ6VXNlcjU0MzIxMjY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5432126?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/miguelcarcamov",
            "html_url": "https://github.com/miguelcarcamov",
            "followers_url": "https://api.github.com/users/miguelcarcamov/followers",
            "following_url": "https://api.github.com/users/miguelcarcamov/following{/other_user}",
            "gists_url": "https://api.github.com/users/miguelcarcamov/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/miguelcarcamov/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/miguelcarcamov/subscriptions",
            "organizations_url": "https://api.github.com/users/miguelcarcamov/orgs",
            "repos_url": "https://api.github.com/users/miguelcarcamov/repos",
            "events_url": "https://api.github.com/users/miguelcarcamov/events{/privacy}",
            "received_events_url": "https://api.github.com/users/miguelcarcamov/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-05T18:34:31Z",
        "updated_at": "2021-08-06T11:33:40Z",
        "author_association": "NONE",
        "body": "> If shape and dtype are not defined, then Dask will infer them in apply_along_blocks here:\r\n\r\nIs there any solution even defining `shape` and `dtype`? Because doing a test on a numpy function should be worst than not doing it. In fact, it does work when adding `shape` and `dtype` to `apply_along_axis`!\r\n\r\n> On another note: the function you are passing to apply_along_blocks should not be calling dask.array; Dask will map the function across all of the blocks of the Dask collection (the Dask array). You probably want to do something like:\r\n\r\nCool, I wasn't sure if dask would map the numpy function or not. So I made it that way. Glad to hear that does map them.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/893689794/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1717672102",
        "html_url": "https://github.com/dask/dask/issues/7999#issuecomment-1717672102",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7999",
        "id": 1717672102,
        "node_id": "IC_kwDOAbcwm85mYZim",
        "user": {
            "login": "dbalabka",
            "id": 1269372,
            "node_id": "MDQ6VXNlcjEyNjkzNzI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1269372?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dbalabka",
            "html_url": "https://github.com/dbalabka",
            "followers_url": "https://api.github.com/users/dbalabka/followers",
            "following_url": "https://api.github.com/users/dbalabka/following{/other_user}",
            "gists_url": "https://api.github.com/users/dbalabka/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dbalabka/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dbalabka/subscriptions",
            "organizations_url": "https://api.github.com/users/dbalabka/orgs",
            "repos_url": "https://api.github.com/users/dbalabka/repos",
            "events_url": "https://api.github.com/users/dbalabka/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dbalabka/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-13T13:48:11Z",
        "updated_at": "2023-09-13T13:48:54Z",
        "author_association": "NONE",
        "body": "@douglasdavis, should `apply_along_axis` check the return type of `my_bincount` and throw a proper error message instead?\r\n\r\nI've faced the same issue",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1717672102/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]