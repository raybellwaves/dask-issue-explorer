{
    "url": "https://api.github.com/repos/dask/dask/issues/5913",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/5913/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/5913/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/5913/events",
    "html_url": "https://github.com/dask/dask/issues/5913",
    "id": 566540936,
    "node_id": "MDU6SXNzdWU1NjY1NDA5MzY=",
    "number": 5913,
    "title": "performance indexing stacked array",
    "user": {
        "login": "d-v-b",
        "id": 3805136,
        "node_id": "MDQ6VXNlcjM4MDUxMzY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3805136?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/d-v-b",
        "html_url": "https://github.com/d-v-b",
        "followers_url": "https://api.github.com/users/d-v-b/followers",
        "following_url": "https://api.github.com/users/d-v-b/following{/other_user}",
        "gists_url": "https://api.github.com/users/d-v-b/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/d-v-b/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/d-v-b/subscriptions",
        "organizations_url": "https://api.github.com/users/d-v-b/orgs",
        "repos_url": "https://api.github.com/users/d-v-b/repos",
        "events_url": "https://api.github.com/users/d-v-b/events{/privacy}",
        "received_events_url": "https://api.github.com/users/d-v-b/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 1342304743,
            "node_id": "MDU6TGFiZWwxMzQyMzA0NzQz",
            "url": "https://api.github.com/repos/dask/dask/labels/core",
            "name": "core",
            "color": "000000",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 14,
    "created_at": "2020-02-17T22:19:44Z",
    "updated_at": "2022-10-18T18:54:01Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "I have a large imaging dataset with ~30k images, each 40 MB. I'm combining these images into a large dask array by defining a delayed function for loading each individual image, then using `da.from_delayed` and a `da.stack`. The resulting array has dimensions (30265, 2, 1000, 10000) and chunksize (1, 2, 1000, 10000), for a total of ~120k tasks (4 tasks per image file). \r\n\r\nI noticed that indexing along the first axis of this array (i.e., along the chunked axis) takes 30 ms; i.e., calling `[x for x in array]` takes ~900s, which seems a bit on the long side, given that these tasks have 0 horizontal dependencies, and everything is lazy. By contrast, the same indexing pattern used on a dummy dataset (`da.zeros` combined with `stack`) with the same shape + dtype + chunking takes ~.700 ms per \"image\" with a total of ~9s for `[x for x in dummy_data]`. That's not lighting-fast but it's acceptable, unlike 900s.\r\n\r\nShort-term it's clear that I should simply avoid the pattern of `big_array = da.stack(sub_arrays)...[b for b in big_array] ` when `big_array` is large... But I wonder a) why this pattern is so slow and b) if there's anything I can do (or dask can do) to speed up this access pattern. ",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/5913/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/5913/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}