[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1292834204",
        "html_url": "https://github.com/dask/dask/pull/9590#issuecomment-1292834204",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9590",
        "id": 1292834204,
        "node_id": "IC_kwDOAbcwm85NDxWc",
        "user": {
            "login": "th3ed",
            "id": 10234452,
            "node_id": "MDQ6VXNlcjEwMjM0NDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/10234452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/th3ed",
            "html_url": "https://github.com/th3ed",
            "followers_url": "https://api.github.com/users/th3ed/followers",
            "following_url": "https://api.github.com/users/th3ed/following{/other_user}",
            "gists_url": "https://api.github.com/users/th3ed/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/th3ed/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/th3ed/subscriptions",
            "organizations_url": "https://api.github.com/users/th3ed/orgs",
            "repos_url": "https://api.github.com/users/th3ed/repos",
            "events_url": "https://api.github.com/users/th3ed/events{/privacy}",
            "received_events_url": "https://api.github.com/users/th3ed/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-27T01:06:37Z",
        "updated_at": "2022-12-13T17:58:41Z",
        "author_association": "NONE",
        "body": "here's a reproducible example of the issue using pyarrow\r\n\r\n```python\r\nimport pyarrow as pa\r\nimport dask.dataframe as dd\r\nimport pandas as pd\r\n\r\n# Generate a parquet with a nullable int dtype\r\npq.write_to_dataset(\r\n  pa.Table.from_arrays([\r\n    [0, 1, 2, None, 4, 5, 6, 7, 8, 9],\r\n    ['a'] * 5 + ['b'] * 5\r\n    ], names=['x1', 'part']),\r\n  \"test.parquet\",\r\n  partition_cols = ['part']\r\n)\r\n\r\n# Read in parquet and call a function that requires an int col\r\ndf = dd.read_parquet(\"test.parquet\") \\\r\n  .assign(\r\n    some_date = pd.to_datetime('2022-01-01').to_period('M'),\r\n    inc_date = lambda d: d['some_date'] + d['x1']\r\n  )\r\ndf.head() # fails, partition 1 casts x1 as a float\r\ndf.tail() # works, partition 2 casts x2 as an int\r\n```\r\n`TypeError: unsupported operand type(s) for +: 'Period' and 'float'`\r\n\r\nWhen converting pyarrow to pandas via `to_pandas()` pyarrow will convert a series of pyarrow ints to a pandas int if there are no missing values in the array or a series of floats otherwise. Pandas `read_parquet` has a `use_nullable_dtypes` arg that may make sense here.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1292834204/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1322529554",
        "html_url": "https://github.com/dask/dask/pull/9590#issuecomment-1322529554",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9590",
        "id": 1322529554,
        "node_id": "IC_kwDOAbcwm85O1DMS",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-21T19:15:29Z",
        "updated_at": "2022-11-21T19:15:29Z",
        "author_association": "MEMBER",
        "body": "@jrbourbeau I'm curious, what is the status here?  Do you think it would be possible to hand this off to someone else?  If so, what would you suggest as a course of action?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1322529554/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]