[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1228639079",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1228639079",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1228639079,
        "node_id": "IC_kwDOAbcwm85JO4tn",
        "user": {
            "login": "pavithraes",
            "id": 33131404,
            "node_id": "MDQ6VXNlcjMzMTMxNDA0",
            "avatar_url": "https://avatars.githubusercontent.com/u/33131404?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pavithraes",
            "html_url": "https://github.com/pavithraes",
            "followers_url": "https://api.github.com/users/pavithraes/followers",
            "following_url": "https://api.github.com/users/pavithraes/following{/other_user}",
            "gists_url": "https://api.github.com/users/pavithraes/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pavithraes/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pavithraes/subscriptions",
            "organizations_url": "https://api.github.com/users/pavithraes/orgs",
            "repos_url": "https://api.github.com/users/pavithraes/repos",
            "events_url": "https://api.github.com/users/pavithraes/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pavithraes/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-26T15:29:07Z",
        "updated_at": "2022-08-26T15:29:07Z",
        "author_association": "MEMBER",
        "body": "@rweisman-efp Welcome!\r\n\r\n> Tried running against a cluster, whose workers were launched with the environment variable DASK_DISTRIBUTED__WORKER__RESOURCES__MEMORY=32\r\n\r\nYou're right in doing this -- because you would first need to set this \"MEMORY\" resource to the workers before using it in `client.submit()`.\r\n\r\nJust to confirm, did you connect your workers+scheduler to the client?\r\n\r\nNote that `dask_client = Client()` will create a _new cluster_ and connect a client to it. \r\n\r\nCould you please try:\r\n- [Launching your scheduler and worker from the command line](https://docs.dask.org/en/stable/deploying-cli.html#command-line). And while creating the worker, you can specify the resource using environment variables\r\n- In your code snippet, use `dask_client = Client(address=<scheduler-address>)` where \"scheduler address\" is the address displayed while launching your scheduler.\r\n\r\nAnd let us know if it still doesn't work?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1228639079/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1233182378",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1233182378",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1233182378,
        "node_id": "IC_kwDOAbcwm85JgN6q",
        "user": {
            "login": "rweisman-efp",
            "id": 103955597,
            "node_id": "U_kgDOBjI8jQ",
            "avatar_url": "https://avatars.githubusercontent.com/u/103955597?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rweisman-efp",
            "html_url": "https://github.com/rweisman-efp",
            "followers_url": "https://api.github.com/users/rweisman-efp/followers",
            "following_url": "https://api.github.com/users/rweisman-efp/following{/other_user}",
            "gists_url": "https://api.github.com/users/rweisman-efp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rweisman-efp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rweisman-efp/subscriptions",
            "organizations_url": "https://api.github.com/users/rweisman-efp/orgs",
            "repos_url": "https://api.github.com/users/rweisman-efp/repos",
            "events_url": "https://api.github.com/users/rweisman-efp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rweisman-efp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-31T16:50:06Z",
        "updated_at": "2022-08-31T16:50:06Z",
        "author_association": "NONE",
        "body": "Hello and thanks for the prompt reply!\r\n\r\nOriginally tried against both a new cluster (`dask_client = Client()`) as well as an extant, remote cluster with that environment variable set (i.e. `dask_client = Client(address='remote.host.with.scheduler:8786')`).\r\n\r\nGiven your reply, it seems most likely the latter was misconfigured.  I'll try to launch the scheduler locally as you suggest and report back.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1233182378/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1233198648",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1233198648",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1233198648,
        "node_id": "IC_kwDOAbcwm85JgR44",
        "user": {
            "login": "rweisman-efp",
            "id": 103955597,
            "node_id": "U_kgDOBjI8jQ",
            "avatar_url": "https://avatars.githubusercontent.com/u/103955597?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rweisman-efp",
            "html_url": "https://github.com/rweisman-efp",
            "followers_url": "https://api.github.com/users/rweisman-efp/followers",
            "following_url": "https://api.github.com/users/rweisman-efp/following{/other_user}",
            "gists_url": "https://api.github.com/users/rweisman-efp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rweisman-efp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rweisman-efp/subscriptions",
            "organizations_url": "https://api.github.com/users/rweisman-efp/orgs",
            "repos_url": "https://api.github.com/users/rweisman-efp/repos",
            "events_url": "https://api.github.com/users/rweisman-efp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rweisman-efp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-08-31T17:06:39Z",
        "updated_at": "2022-08-31T17:06:39Z",
        "author_association": "NONE",
        "body": "Unfortunately, the behavior is the same.  Perhaps there's a typo in how I'm specifying the environment variable?\r\n\r\nScheduler output:\r\n```\r\n$dask-scheduler\r\n2022-08-31 16:58:37,533 - distributed.scheduler - INFO - -----------------------------------------------\r\n2022-08-31 16:58:38,133 - distributed.scheduler - INFO - State start\r\n2022-08-31 16:58:38,135 - distributed.scheduler - INFO - -----------------------------------------------\r\n2022-08-31 16:58:38,135 - distributed.scheduler - INFO - Clear task state\r\n2022-08-31 16:58:38,136 - distributed.scheduler - INFO -   Scheduler at: tcp://172.31.175.176:8786\r\n2022-08-31 16:58:38,136 - distributed.scheduler - INFO -   dashboard at:                     :8787\r\n2022-08-31 16:58:41,242 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://127.0.0.1:33659', status: init, memory: 0, processing: 0>\r\n2022-08-31 16:58:41,251 - distributed.scheduler - INFO - Starting worker compute stream, tcp://127.0.0.1:33659\r\n2022-08-31 16:58:41,251 - distributed.core - INFO - Starting established connection\r\n2022-08-31 16:58:56,233 - distributed.scheduler - INFO - Receive client connection: Client-333c596a-294e-11ed-bec0-0233a8571446\r\n2022-08-31 16:58:56,234 - distributed.core - INFO - Starting established connection\r\n2022-08-31 16:59:15,963 - distributed.scheduler - INFO - Receive client connection: Client-3f0166d6-294e-11ed-bec0-0233a8571446\r\n2022-08-31 16:59:15,964 - distributed.core - INFO - Starting established connection\r\n```\r\n\r\nWorker output:\r\n```\r\n$DASK_DISTRIBUTED__WORKER__RESOURCES__MEMORY=32 dask-worker tcp://127.0.0.1:8786\r\n2022-08-31 16:58:40,539 - distributed.nanny - INFO -         Start Nanny at: 'tcp://127.0.0.1:38765'\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:33659\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:33659\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42749\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO - Waiting to connect to:       tcp://127.0.0.1:8786\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO - -------------------------------------------------\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -               Threads:                         16\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -                Memory:                 501.73 GiB\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO -       Local Directory: ~/dask-worker-space/worker-nym66clc\r\n2022-08-31 16:58:41,232 - distributed.worker - INFO - -------------------------------------------------\r\n2022-08-31 16:58:41,251 - distributed.worker - INFO -         Registered to:       tcp://127.0.0.1:8786\r\n2022-08-31 16:58:41,251 - distributed.worker - INFO - -------------------------------------------------\r\n2022-08-31 16:58:41,252 - distributed.core - INFO - Starting established connection\r\n```\r\n\r\nResult (tried with both MEMORY set to 0 and to 5):\r\n![image](https://user-images.githubusercontent.com/103955597/187737726-d50e6389-f1bb-48da-ad4d-ebc483d97c27.png)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1233198648/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1248682769",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1248682769",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1248682769,
        "node_id": "IC_kwDOAbcwm85KbWMR",
        "user": {
            "login": "ncclementi",
            "id": 7526622,
            "node_id": "MDQ6VXNlcjc1MjY2MjI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7526622?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ncclementi",
            "html_url": "https://github.com/ncclementi",
            "followers_url": "https://api.github.com/users/ncclementi/followers",
            "following_url": "https://api.github.com/users/ncclementi/following{/other_user}",
            "gists_url": "https://api.github.com/users/ncclementi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ncclementi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ncclementi/subscriptions",
            "organizations_url": "https://api.github.com/users/ncclementi/orgs",
            "repos_url": "https://api.github.com/users/ncclementi/repos",
            "events_url": "https://api.github.com/users/ncclementi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ncclementi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T22:05:06Z",
        "updated_at": "2022-09-15T22:05:30Z",
        "author_association": "MEMBER",
        "body": "@rweisman-efp I'm looking at the docs on how to specify worker resources [here](https://distributed.dask.org/en/stable/resources.html) and I see that the scheduler has the resources set too. see that in the example in the docs there is this step:\r\n\r\n```python\r\ndask-worker scheduler:8786 --resources \"GPU=2\"\r\ndask-worker scheduler:8786 --resources \"GPU=2\"\r\ndask-worker scheduler:8786 --resources \"MEMORY=100e9\" #notice the resource set here.\r\n```\r\n\r\nbefore \r\n\r\n```python\r\nfrom distributed import Client\r\nclient = Client('scheduler:8786') #using the scheduler with resources set above\r\n\r\ndata = [client.submit(load, fn) for fn in filenames]\r\nprocessed = [client.submit(process, d, resources={'GPU': 1}) for d in data]\r\nfinal = client.submit(aggregate, processed, resources={'MEMORY': 70e9})\r\n\r\n```\r\n\r\nComparing that with your example, what's missing is specifying the resources when creating the workers with the LocalCluster. Modifying your script as this runs:\r\n\r\n```python\r\nfrom dask.distributed import Client\r\n\r\ndef some_task():\r\n    return 42\r\n\r\ndask_client = Client(resources={\"MEMORY\": 20}) #notice this here\r\njob = dask_client.submit(some_task, resources={'MEMORY': 20})\r\ndask_client.gather(job)\r\nprint(job.result())\r\n```\r\n\r\nBut I can see why this might be confusing from the docs. Do you think that adding an example like yours to the docs  would be more useful, if so would you be willing to open a PR? ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1248682769/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1248686855",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1248686855",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1248686855,
        "node_id": "IC_kwDOAbcwm85KbXMH",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T22:10:25Z",
        "updated_at": "2022-09-15T22:10:25Z",
        "author_association": "MEMBER",
        "body": "Hrm, while I agree the examples @ncclementi are totally correct. One thing I noticed when playing around with the environment variable approach is that `DASK_DISTRIBUTED__WORKER__RESOURCES__MEMORY=32` sets a resource of `memory=32` (note `memory` is lower case). If I use this env var, and update @rweisman-efp's original example to use lower case `memory` in the `client.submit(..., )` call, then things work as expected ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1248686855/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1248690577",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1248690577",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1248690577,
        "node_id": "IC_kwDOAbcwm85KbYGR",
        "user": {
            "login": "ncclementi",
            "id": 7526622,
            "node_id": "MDQ6VXNlcjc1MjY2MjI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7526622?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ncclementi",
            "html_url": "https://github.com/ncclementi",
            "followers_url": "https://api.github.com/users/ncclementi/followers",
            "following_url": "https://api.github.com/users/ncclementi/following{/other_user}",
            "gists_url": "https://api.github.com/users/ncclementi/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ncclementi/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ncclementi/subscriptions",
            "organizations_url": "https://api.github.com/users/ncclementi/orgs",
            "repos_url": "https://api.github.com/users/ncclementi/repos",
            "events_url": "https://api.github.com/users/ncclementi/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ncclementi/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T22:15:54Z",
        "updated_at": "2022-09-15T22:16:02Z",
        "author_association": "MEMBER",
        "body": "@jrbourbeau Do you mean `job = dask_client.submit(some_task, resources={'memory': 20})`. Is that setting the limit on all the workers, or is it restricting the just `some_task` . I guess what's the difference between lower and uppercase? \r\n\r\nThis seems a bit confusing for users. Is there a way we can make the docs better?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1248690577/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1248694798",
        "html_url": "https://github.com/dask/dask/issues/9434#issuecomment-1248694798",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9434",
        "id": 1248694798,
        "node_id": "IC_kwDOAbcwm85KbZIO",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-09-15T22:21:50Z",
        "updated_at": "2022-09-15T22:21:50Z",
        "author_association": "MEMBER",
        "body": "> Do you mean `job = dask_client.submit(some_task, resources={'memory': 20})`\r\n\r\nYeah, exactly. Resources are set when we create the worker with this environment variable\r\n\r\n```\r\nDASK_DISTRIBUTED__WORKER__RESOURCES__MEMORY=32 dask-worker\r\n```\r\n\r\nand then with \r\n\r\n```python\r\njob = dask_client.submit(some_task, resources={'memory': 20})\r\n```\r\n\r\nwe're saying that whenever we run the `some_task` function on the cluster, it will require 20 `memory` resources. \r\n\r\n> This seems a bit confusing for users. Is there a way we can make the docs better?\r\n\r\nAgreed. Perhaps add a note to the \"From environment variables\" section in https://distributed.dask.org/en/stable/resources.html? \r\n\r\nAlternatively, we could make resources case-insensitive. Would want to think more about whether or not that's actually a good idea though...\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1248694798/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]