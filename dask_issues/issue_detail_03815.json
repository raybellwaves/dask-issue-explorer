{
    "url": "https://api.github.com/repos/dask/dask/issues/3815",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/3815/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/3815/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/3815/events",
    "html_url": "https://github.com/dask/dask/issues/3815",
    "id": 344773894,
    "node_id": "MDU6SXNzdWUzNDQ3NzM4OTQ=",
    "number": 3815,
    "title": "[new feature] crash test dummy scheduler for unit tests",
    "user": {
        "login": "crusaderky",
        "id": 6213168,
        "node_id": "MDQ6VXNlcjYyMTMxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6213168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/crusaderky",
        "html_url": "https://github.com/crusaderky",
        "followers_url": "https://api.github.com/users/crusaderky/followers",
        "following_url": "https://api.github.com/users/crusaderky/following{/other_user}",
        "gists_url": "https://api.github.com/users/crusaderky/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/crusaderky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/crusaderky/subscriptions",
        "organizations_url": "https://api.github.com/users/crusaderky/orgs",
        "repos_url": "https://api.github.com/users/crusaderky/repos",
        "events_url": "https://api.github.com/users/crusaderky/events{/privacy}",
        "received_events_url": "https://api.github.com/users/crusaderky/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 386719400,
            "node_id": "MDU6TGFiZWwzODY3MTk0MDA=",
            "url": "https://api.github.com/repos/dask/dask/labels/scheduler",
            "name": "scheduler",
            "color": "D10945",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-07-26T09:52:16Z",
    "updated_at": "2019-04-30T16:10:05Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "I've been spending quite a lot of time recently debugging the dask distributed scheduler being unexpectedly invoked in the middle of defining the dask.array graph, both by xarray and by my own application code. If the distributed client and scheduler are on opposite ends of a high-latency network, this can easily compound into hours of overhead in some cases. Another, worse situation that I'm fighting against is when the dask graph definition is performed inside a process pool - a dire necessity for particularly large graphs. In this case, an accidental invocation of the threaded scheduler from inside the subprocess will cause a random and complete deadlock of the Python interpreter, and an inexperienced developer will never figure out what's going on.\r\n\r\nTo debug this, so far I have been starting a distributed scheduler without workers and watched for my code getting stuck when it accidentally tries submitting stuff to it. This approach however is impractical when writing unit tests.\r\nI'd like to propose writing a new scheduler, ``crash`` (I'm open to suggestions for a better name), that raises Exception as soon as anybody tries computing anything with it.\r\n\r\nMock up:\r\n```\r\nimport dask\r\nfrom dask.array.utils import assert_eq\r\n\r\ndask.config.set(scheduler='crash')\r\n\r\n\r\ndef test1():\r\n    # graph definition. scheduler='crash' verifies parts of the graph are not\r\n    # silently computed under the hood\r\n    a = dask.array.arange(4, chunks=2)\r\n    # internally invokes compute(scheduler='sync')\r\n    assert_eq(a, dask.array.from_array([0, 1,2, 3], chunks]=2)\r\n```",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/3815/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/3815/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}