[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596250112",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596250112",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596250112,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjI1MDExMg==",
        "user": {
            "login": "quasiben",
            "id": 1403768,
            "node_id": "MDQ6VXNlcjE0MDM3Njg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1403768?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/quasiben",
            "html_url": "https://github.com/quasiben",
            "followers_url": "https://api.github.com/users/quasiben/followers",
            "following_url": "https://api.github.com/users/quasiben/following{/other_user}",
            "gists_url": "https://api.github.com/users/quasiben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/quasiben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/quasiben/subscriptions",
            "organizations_url": "https://api.github.com/users/quasiben/orgs",
            "repos_url": "https://api.github.com/users/quasiben/repos",
            "events_url": "https://api.github.com/users/quasiben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/quasiben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-08T20:41:06Z",
        "updated_at": "2020-03-08T20:41:06Z",
        "author_association": "MEMBER",
        "body": "@AmeerHajAli  interesting. What is the performance if you pre-scatter the data:\r\n\r\n```python\r\nwith parallel_backend('dask', scatter=[x, y]):\r\n    search.fit(digits.data, digits.target)\r\n```\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596250112/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596257176",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596257176",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596257176,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjI1NzE3Ng==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-08T21:52:50Z",
        "updated_at": "2020-03-08T21:52:50Z",
        "author_association": "MEMBER",
        "body": "I notice that you've chosen not to use processes:\r\n\r\n```python\r\nclient=Client(processes=None)\r\n```\r\n\r\nMaybe this is the cause of the performance difference?  Maybe Scikit-Learn's RandomForest implementation doesn't release the GIL?  You might want to try with processes as a more comparable test.\r\n\r\nIf things are still slow then I recommend providing a performance report.  https://docs.dask.org/en/latest/diagnostics-distributed.html#capture-diagnostics",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596257176/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596308569",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596308569",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596308569,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjMwODU2OQ==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-09T02:54:19Z",
        "updated_at": "2020-03-09T03:00:20Z",
        "author_association": "NONE",
        "body": "Thanks for your responses!\r\n@quasiben, I tried to use scatter, still the same issue.\r\n@mrocklin, I tried `Client()` and `Client(processes=True)` and still does not work.\r\nDo you suggest trying any other options?\r\nBTW, does it work fine for you? can you try running multiprocessing backend and dask and compare their performance on your machine?\r\n\r\nThanks!\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596308569/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596308870",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596308870",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596308870,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjMwODg3MA==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-09T02:55:43Z",
        "updated_at": "2020-03-09T02:55:43Z",
        "author_association": "NONE",
        "body": "Just to make it clear, when I run it says:\r\n\"[Parallel(n_jobs=-1)]: Using backend DaskDistributedBackend with 32 concurrent workers.\"\r\nBut when I look at the utilization of the processor, it is less than 15%.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596308870/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596483144",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596483144",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596483144,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjQ4MzE0NA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-09T11:55:57Z",
        "updated_at": "2020-03-09T11:55:57Z",
        "author_association": "MEMBER",
        "body": "The Dask backend won't have any performance over scikit-learn on a single machine. If you aren't on a cluster you should just use the default for that estimator.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596483144/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/596816190",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-596816190",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 596816190,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjgxNjE5MA==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-09T22:50:07Z",
        "updated_at": "2020-03-09T22:50:07Z",
        "author_association": "NONE",
        "body": "@TomAugspurger, I also tried on a cluster with 5 and 10 nodes and it still does not perform well (the performance roughly stays the same). If instead of randomforests I do gridsearch on SVM hyperparameters it scales very well (on a single node and multiple nodes), but this is not the case for randomforests.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/596816190/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/597085132",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-597085132",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 597085132,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5NzA4NTEzMg==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-10T13:28:01Z",
        "updated_at": "2020-03-10T13:28:01Z",
        "author_association": "MEMBER",
        "body": "The predicate stage of RandomForestClassifier requires shared memory to mutate arrays inplace: https://github.com/scikit-learn/scikit-learn/blob/1c7449036515d4204f9467493010228588ed378d/sklearn/ensemble/_forest.py#L679-L683. So the fitting should be done in parallel on a cluster, but the CV evaluation parts might be done on your client machine.\r\n\r\nhttps://github.com/joblib/joblib/issues/1020 might also be relevant, but given that you're seeing this just for random forest the shared memory requirement is the most likely culprit.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/597085132/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/598733497",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-598733497",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 598733497,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODczMzQ5Nw==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-13T13:59:18Z",
        "updated_at": "2020-03-13T13:59:18Z",
        "author_association": "NONE",
        "body": "Hi @TomAugspurger , I am not sure I understand, I am not using cross_validatiionn, it is just random forest with 45,000 trees. Does that mean that Dask performs significantly worse on random forests compared to multiprocessing? Can you suggest a parameter that I should pass to `parallel_backend` that will make it perform better?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/598733497/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/598742744",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-598742744",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 598742744,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODc0Mjc0NA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-13T14:18:39Z",
        "updated_at": "2020-03-13T14:18:39Z",
        "author_association": "MEMBER",
        "body": "Ah interesting, I misread that. I'd suggest looking at a performance report to see where time is spent.\r\n\r\n> Can you suggest a parameter that I should pass to parallel_backend that will make it perform better?\r\n\r\nSpecifying `pre_dispatch=\"all\"` may help alleviate https://github.com/joblib/joblib/issues/1020.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/598742744/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/598794349",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-598794349",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 598794349,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODc5NDM0OQ==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-13T15:59:41Z",
        "updated_at": "2020-03-13T15:59:41Z",
        "author_association": "MEMBER",
        "body": "> @mrocklin, I tried Client() and Client(processes=True) and still does not work.\r\n\r\nYes.  This works fine for me.  Maybe if you're running this in a script you forgot to place process-creating code within an `if __name__ == \"__main__\":` block?\r\n\r\n```python\r\n...\r\nif __name__ == \"__main__\":\r\n    client = Client(...)\r\n    with parallel_backend(...):\r\n       ...\r\n```\r\n\r\nLooking at `top` while it's running I notice that my processes only use up to 100% CPU, despite each having a thread pool with a few cores each.  Probably the Scikit-Learn RandomForest code doesn't release the GIL, and so it is important to use processes rather than threads.  (You may want to read through https://docs.dask.org/en/latest/scheduling.html)\r\n\r\nSo probably you want something like the following ...\r\n\r\n```python\r\nclient = Client(processes=True, threads_per_process=1)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/598794349/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/598798524",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-598798524",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 598798524,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODc5ODUyNA==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-13T16:08:37Z",
        "updated_at": "2020-03-13T16:08:37Z",
        "author_association": "MEMBER",
        "body": "Sorry, I meant `threads_per_worker`.  See the LocalCluster docstring for additional information.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/598798524/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/599264363",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-599264363",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 599264363,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTI2NDM2Mw==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-15T21:03:50Z",
        "updated_at": "2020-03-15T21:03:50Z",
        "author_association": "NONE",
        "body": "@mrocklin, did you try runnning the code with multiprocessing backend and dask and get similar performance? even with your fix, I still get dask being much slower than multiprocessing. This is my code:\r\n```python\r\nif __name__ == '__main__':\r\n    from joblib import parallel_backend\r\n    import numpy as np\r\n    from dask.distributed import Client\r\n    from sklearn.datasets import load_digits\r\n    from sklearn.ensemble import RandomForestClassifier      \r\n    digits = load_digits()\r\n    from sklearn.model_selection import cross_val_score\r\n    from time import time\r\n    client=Client(processes=True,threads_per_worker=1)\r\n    clf = RandomForestClassifier(n_estimators=45000,verbose=1)\r\n    X = np.concatenate((digits.data,digits.data),axis=0)\r\n    y = np.concatenate((digits.target,digits.target)) \r\n    with parallel_backend('dask'):\r\n        start = time()\r\n        clf.fit(X,y)\r\n        end = time()\r\n        print(end-start)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/599264363/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/599626789",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-599626789",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 599626789,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTYyNjc4OQ==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-16T16:17:38Z",
        "updated_at": "2020-03-16T16:17:38Z",
        "author_association": "MEMBER",
        "body": "No, I didn't.  ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/599626789/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600635116",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600635116",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600635116,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDYzNTExNg==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T13:50:53Z",
        "updated_at": "2020-03-18T13:50:53Z",
        "author_association": "NONE",
        "body": "Do you think it is a performance issue in Dask for RandomForests? Is it fine to assume Multiprocessing outperforms Dask in RandomForsts with Joblib backend?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600635116/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600649962",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600649962",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600649962,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY0OTk2Mg==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T14:19:50Z",
        "updated_at": "2020-03-18T14:19:50Z",
        "author_association": "MEMBER",
        "body": "When I run your example only two of the eight cores in my LocalCluster are being used. Do you see that on your task stream?\r\n\r\nThe dashboard or a performance report should help here.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600649962/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600651144",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600651144",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600651144,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY1MTE0NA==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T14:21:30Z",
        "updated_at": "2020-03-18T14:21:30Z",
        "author_association": "NONE",
        "body": "@TomAugspurger yes, that is the problem, no matter what configuration I try, it never utilizes 100% of the cores.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600651144/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600652356",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600652356",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600652356,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY1MjM1Ng==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T14:23:46Z",
        "updated_at": "2020-03-18T14:23:46Z",
        "author_association": "MEMBER",
        "body": "I'd recommend stepping through the code in\nhttps://github.com/joblib/joblib/blob/master/joblib/_dask.py then to see\nwhy. I don't recall if there are sufficient logging calls there to diagnose\nthings, so you may need to add print statements.\n\nOn Wed, Mar 18, 2020 at 9:21 AM Ameer Haj Ali <notifications@github.com>\nwrote:\n\n> @TomAugspurger <https://github.com/TomAugspurger> yes, that is the\n> problem, no matter what configuration I try, it never utilizes 100% of the\n> cores.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5993#issuecomment-600651144>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAKAOIS4KO4YP264C435UPLRIDKHTANCNFSM4LDWASPA>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600652356/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600654300",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600654300",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600654300,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY1NDMwMA==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T14:27:22Z",
        "updated_at": "2020-03-18T14:27:22Z",
        "author_association": "NONE",
        "body": "But just to make sure, this issue is not only on my machine. You (@TomAugspurger , @mrocklin) also cannot get it to work on your machines, right?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600654300/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600655097",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600655097",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600655097,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY1NTA5Nw==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T14:28:45Z",
        "updated_at": "2020-03-18T14:28:45Z",
        "author_association": "MEMBER",
        "body": "I saw only 2/8 cores being used.\n\nOn Wed, Mar 18, 2020 at 9:27 AM Ameer Haj Ali <notifications@github.com>\nwrote:\n\n> But just to make sure, this issue is not only on my machine. You (\n> @TomAugspurger <https://github.com/TomAugspurger> , @mrocklin\n> <https://github.com/mrocklin>) also cannot get it to work on your\n> machines, right?\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5993#issuecomment-600654300>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAKAOIU3GM75IJY25LGSK5LRIDK5XANCNFSM4LDWASPA>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600655097/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600693074",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600693074",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600693074,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY5MzA3NA==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T15:35:54Z",
        "updated_at": "2020-03-18T15:35:54Z",
        "author_association": "MEMBER",
        "body": "Tom, I think that random forest code holds on to the GIL.  My guess is that\nyour local cluster is using two processes with four threads each.\n\nWhen I run with N processes I see all processes active.\n\nOn Wed, Mar 18, 2020, 7:29 AM Tom Augspurger <notifications@github.com>\nwrote:\n\n> I saw only 2/8 cores being used.\n>\n> On Wed, Mar 18, 2020 at 9:27 AM Ameer Haj Ali <notifications@github.com>\n> wrote:\n>\n> > But just to make sure, this issue is not only on my machine. You (\n> > @TomAugspurger <https://github.com/TomAugspurger> , @mrocklin\n> > <https://github.com/mrocklin>) also cannot get it to work on your\n> > machines, right?\n> >\n> > \u2014\n> > You are receiving this because you were mentioned.\n> > Reply to this email directly, view it on GitHub\n> > <https://github.com/dask/dask/issues/5993#issuecomment-600654300>, or\n> > unsubscribe\n> > <\n> https://github.com/notifications/unsubscribe-auth/AAKAOIU3GM75IJY25LGSK5LRIDK5XANCNFSM4LDWASPA\n> >\n> > .\n> >\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5993#issuecomment-600655097>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACKZTFAINXGBOVCXIE4GOLRIDLC3ANCNFSM4LDWASPA>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600693074/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600696953",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600696953",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600696953,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDY5Njk1Mw==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-18T15:42:45Z",
        "updated_at": "2020-03-18T15:42:45Z",
        "author_association": "NONE",
        "body": "@mrocklin, do you mean to set `n_workers=N`? Because even that does not work.\r\nCan you please try running with multiprocessing and dask and report the performance?\r\n\r\nThanks!",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600696953/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600939145",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600939145",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600939145,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDkzOTE0NQ==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-19T01:28:25Z",
        "updated_at": "2020-03-19T01:28:25Z",
        "author_association": "MEMBER",
        "body": "I meant that RandomForest holds onto the GIL, and so one probably wants to\nhave many processes with one thread each.\n\nOn Wed, Mar 18, 2020 at 8:43 AM Ameer Haj Ali <notifications@github.com>\nwrote:\n\n> @mrocklin <https://github.com/mrocklin>, do you mean to set n_workers=N?\n> Because even that does not work.\n> Can you please try running with multiprocessing and dask and report the\n> performance?\n>\n> Thanks!\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/5993#issuecomment-600696953>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACKZTHIX463UVIDBSNJ3YLRIDTYJANCNFSM4LDWASPA>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600939145/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600942927",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600942927",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600942927,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDk0MjkyNw==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-19T01:44:59Z",
        "updated_at": "2020-03-19T01:44:59Z",
        "author_association": "MEMBER",
        "body": "> Can you please try running with multiprocessing and dask and report the performance?\r\n\r\nI don't know how to try running your code with multiprocessing unfortunately.  If you have something that I can copy-paste then sure, I'd be happy to run it on my machine.\r\n\r\nAlso, if you're looking for help with understanding why something is slow, then I recommend providing a performance_report .  See https://docs.dask.org/en/latest/understanding-performance.html",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600942927/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600947007",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600947007",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600947007,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDk0NzAwNw==",
        "user": {
            "login": "AmeerHajAli",
            "id": 18361764,
            "node_id": "MDQ6VXNlcjE4MzYxNzY0",
            "avatar_url": "https://avatars.githubusercontent.com/u/18361764?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AmeerHajAli",
            "html_url": "https://github.com/AmeerHajAli",
            "followers_url": "https://api.github.com/users/AmeerHajAli/followers",
            "following_url": "https://api.github.com/users/AmeerHajAli/following{/other_user}",
            "gists_url": "https://api.github.com/users/AmeerHajAli/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AmeerHajAli/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AmeerHajAli/subscriptions",
            "organizations_url": "https://api.github.com/users/AmeerHajAli/orgs",
            "repos_url": "https://api.github.com/users/AmeerHajAli/repos",
            "events_url": "https://api.github.com/users/AmeerHajAli/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AmeerHajAli/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-19T02:00:32Z",
        "updated_at": "2020-03-19T02:00:32Z",
        "author_association": "NONE",
        "body": "Just replace dask with multiprocessing, here:\r\n```python\r\nif __name__ == '__main__':\r\n    from joblib import parallel_backend\r\n    import numpy as np\r\n    from dask.distributed import Client\r\n    from sklearn.datasets import load_digits\r\n    from sklearn.ensemble import RandomForestClassifier      \r\n    digits = load_digits()\r\n    from sklearn.model_selection import cross_val_score\r\n    from time import time\r\n    //client=Client(processes=True,threads_per_worker=1)\r\n    clf = RandomForestClassifier(n_estimators=45000,verbose=1)\r\n    X = np.concatenate((digits.data,digits.data),axis=0)\r\n    y = np.concatenate((digits.target,digits.target)) \r\n    with parallel_backend('multiprocessing'):\r\n        start = time()\r\n        clf.fit(X,y)\r\n        end = time()\r\n        print(end-start)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600947007/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/600949789",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-600949789",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 600949789,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDk0OTc4OQ==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-19T02:11:30Z",
        "updated_at": "2020-03-19T02:11:30Z",
        "author_association": "MEMBER",
        "body": "I went ahead and generated the performance report\r\n\r\nhttps://gist.githack.com/mrocklin/de1efe90a59716323d32dd4b492c50a4/raw/f8e6e24f0e61a1763ef454155d4010979d2e2ed6/random-forest.html\r\n\r\nWe're spending all of our time in some low-level `funlockfile` function.  Perhaps there is some contention with some lower level resource on the Scikit-Learn side?  If you have time to investigate this @AmeerHajAli that would be very much welcomed.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/600949789/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/602077273",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-602077273",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 602077273,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjA3NzI3Mw==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-21T17:38:23Z",
        "updated_at": "2020-03-21T17:38:23Z",
        "author_association": "MEMBER",
        "body": "cc @ogrisel and @lesteve , who might be interested in this ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/602077273/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/602077883",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-602077883",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 602077883,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjA3Nzg4Mw==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-21T17:42:58Z",
        "updated_at": "2020-03-21T17:42:58Z",
        "author_association": "MEMBER",
        "body": "Looking at the dashboard when it's running it appears that there are not enough tasks in flight and the workers aren't sufficiently occupied.  Does anyone know where the code within joblib is that determines how many futures we have active at once?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/602077883/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/602084135",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-602084135",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 602084135,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjA4NDEzNQ==",
        "user": {
            "login": "lesteve",
            "id": 1680079,
            "node_id": "MDQ6VXNlcjE2ODAwNzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1680079?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/lesteve",
            "html_url": "https://github.com/lesteve",
            "followers_url": "https://api.github.com/users/lesteve/followers",
            "following_url": "https://api.github.com/users/lesteve/following{/other_user}",
            "gists_url": "https://api.github.com/users/lesteve/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/lesteve/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lesteve/subscriptions",
            "organizations_url": "https://api.github.com/users/lesteve/orgs",
            "repos_url": "https://api.github.com/users/lesteve/repos",
            "events_url": "https://api.github.com/users/lesteve/events{/privacy}",
            "received_events_url": "https://api.github.com/users/lesteve/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-21T18:31:01Z",
        "updated_at": "2020-03-21T18:48:04Z",
        "author_association": "MEMBER",
        "body": "@TomAugspurger is right about:\r\n\r\n> The predicate stage of RandomForestClassifier requires shared memory to mutate arrays inplace: https://github.com/scikit-learn/scikit-learn/blob/1c7449036515d4204f9467493010228588ed378d/sklearn/ensemble/_forest.py#L679-L683\r\n\r\nIn other words, multi-threading is used when doing RandomForest without Dask so I don't expect the scikit-learn parallelized function to hold to the GIL.\r\n\r\nI don't really know what happens with `require=\"sharedmem\"` when passed to the Dask backend. Maybe it ends up running the code only one worker. Unless I am mistaken 8 cores turns into 4 process and 2 cores:\r\n```\r\nIn [1]: from distributed.deploy.local import nprocesses_nthreads                                                                     \r\n\r\nIn [2]: nprocesses_nthreads(8)                                                                                                       \r\nOut[2]: (4, 2)\r\n```\r\n\r\nSo that would fit with the 2 cores used reported above.\r\n\r\nAlso this ay be related to a similar performance problem in https://github.com/joblib/joblib/issues/1021.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/602084135/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/602104983",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-602104983",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 602104983,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjEwNDk4Mw==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-21T21:09:06Z",
        "updated_at": "2020-03-21T21:09:06Z",
        "author_association": "MEMBER",
        "body": "So I'm mostly concerned about the sparsity of tasks during computation\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/602104983/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/602105329",
        "html_url": "https://github.com/dask/dask/issues/5993#issuecomment-602105329",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5993",
        "id": 602105329,
        "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjEwNTMyOQ==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-03-21T21:11:54Z",
        "updated_at": "2020-03-21T21:11:54Z",
        "author_association": "MEMBER",
        "body": "Whoops, I meant to include some more information there.  This is a screenshot from the [performance report](https://gist.githack.com/mrocklin/de1efe90a59716323d32dd4b492c50a4/raw/f8e6e24f0e61a1763ef454155d4010979d2e2ed6/random-forest.html)\r\n\r\n![task-stream](https://user-images.githubusercontent.com/306380/77236632-a31ea500-6b7d-11ea-918d-c20904ea0a55.png)\r\n\r\nJoblib isn't feeding Dask with enough concurrent work.  When I watch the dashboard during execution I see that there are only about 20 tasks total, 16 of which are done most of the time, so there is only a backlog of something like 4 tasks at once, which doesn't saturate the number of cores I have (I would want something like twice the number of total cores for saturation).  \r\n\r\nThis this specific to RandomForest, or is this a general Joblib+Dask problem?  Where does the amount of concurrency get set?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/602105329/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]