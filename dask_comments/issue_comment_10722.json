[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1862765460",
        "html_url": "https://github.com/dask/dask/pull/10722#issuecomment-1862765460",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10722",
        "id": 1862765460,
        "node_id": "IC_kwDOAbcwm85vB4uU",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-19T13:31:17Z",
        "updated_at": "2023-12-19T13:31:17Z",
        "author_association": "MEMBER",
        "body": "This isn't stable unfortunately, we can't rely on the index of our original df being sorted:\r\n\r\n```\r\nif __name__ == \"__main__\":\r\n    client = Client()\r\n    pdf = pd.DataFrame(\r\n        {\"x\": [1, 2, 3, 4, 5, 6] * 10, \"y\": np.random.randint(1, 1_000_000, (60, ))},\r\n        index=pd.Series(list(range(0, 30)) * 2),\r\n    )\r\n    df = dd.from_pandas(pdf, npartitions=2, sort=False)\r\n    result_pd = pdf.drop_duplicates(subset=[\"x\"], keep=\"first\")\r\n    assert_eq(df.drop_duplicates(\r\n            subset=[\"x\"],\r\n            keep=\"first\",\r\n            split_out=df.npartitions,\r\n            shuffle=\"p2p\",\r\n        ).compute(), result_pd)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1862765460/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1862912281",
        "html_url": "https://github.com/dask/dask/pull/10722#issuecomment-1862912281",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10722",
        "id": 1862912281,
        "node_id": "IC_kwDOAbcwm85vCckZ",
        "user": {
            "login": "rjzamora",
            "id": 20461013,
            "node_id": "MDQ6VXNlcjIwNDYxMDEz",
            "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rjzamora",
            "html_url": "https://github.com/rjzamora",
            "followers_url": "https://api.github.com/users/rjzamora/followers",
            "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
            "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
            "organizations_url": "https://api.github.com/users/rjzamora/orgs",
            "repos_url": "https://api.github.com/users/rjzamora/repos",
            "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rjzamora/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-19T14:51:30Z",
        "updated_at": "2023-12-19T14:51:30Z",
        "author_association": "MEMBER",
        "body": ">This isn't stable unfortunately, we can't rely on the index of our original df being sorted\r\n\r\nAgree, we should be able to do this if we have sorted divisions. Otherwise, we would need to add a temporary `\"__order\"` column.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1862912281/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1862976292",
        "html_url": "https://github.com/dask/dask/pull/10722#issuecomment-1862976292",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10722",
        "id": 1862976292,
        "node_id": "IC_kwDOAbcwm85vCsMk",
        "user": {
            "login": "fjetter",
            "id": 8629629,
            "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8629629?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjetter",
            "html_url": "https://github.com/fjetter",
            "followers_url": "https://api.github.com/users/fjetter/followers",
            "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
            "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
            "organizations_url": "https://api.github.com/users/fjetter/orgs",
            "repos_url": "https://api.github.com/users/fjetter/repos",
            "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fjetter/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-19T15:24:29Z",
        "updated_at": "2023-12-19T15:24:29Z",
        "author_association": "MEMBER",
        "body": "Yes, you are right, of course.\r\n\r\n> Otherwise, we would need to add a temporary \"__order\" column.\r\n\r\nI thought about this for a moment but couldn't come up with something that would actually give me this. We'd need internal ordering (can be done with a reset_index) and a global ordering (partition index). Is there an easy way to assign a column with the partition index?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1862976292/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1863003214",
        "html_url": "https://github.com/dask/dask/pull/10722#issuecomment-1863003214",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10722",
        "id": 1863003214,
        "node_id": "IC_kwDOAbcwm85vCyxO",
        "user": {
            "login": "rjzamora",
            "id": 20461013,
            "node_id": "MDQ6VXNlcjIwNDYxMDEz",
            "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rjzamora",
            "html_url": "https://github.com/rjzamora",
            "followers_url": "https://api.github.com/users/rjzamora/followers",
            "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
            "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
            "organizations_url": "https://api.github.com/users/rjzamora/orgs",
            "repos_url": "https://api.github.com/users/rjzamora/repos",
            "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rjzamora/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-19T15:40:17Z",
        "updated_at": "2023-12-19T15:40:17Z",
        "author_association": "MEMBER",
        "body": ">Is there an easy way to assign a column with the partition index?\r\n\r\nEasy-ish:\r\n\r\n```python\r\nfrom dask.blockwise import BlockIndex\r\n\r\ndef _add_partid(x, val):\r\n    return x.assign(__partid=val[0])\r\n\r\ndf2 = df.map_partitions(_add_partid, BlockIndex((df.npartitions,)))\r\ndf2.head()\r\n```\r\n```\r\n   x  y  __partid\r\n0  1  a         0\r\n0  1  a         0\r\n1  2  b         0\r\n1  2  b         0\r\n2  3  d         0\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1863003214/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1863108894",
        "html_url": "https://github.com/dask/dask/pull/10722#issuecomment-1863108894",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10722",
        "id": 1863108894,
        "node_id": "IC_kwDOAbcwm85vDMke",
        "user": {
            "login": "fjetter",
            "id": 8629629,
            "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8629629?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjetter",
            "html_url": "https://github.com/fjetter",
            "followers_url": "https://api.github.com/users/fjetter/followers",
            "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
            "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
            "organizations_url": "https://api.github.com/users/fjetter/orgs",
            "repos_url": "https://api.github.com/users/fjetter/repos",
            "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fjetter/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-12-19T16:38:12Z",
        "updated_at": "2023-12-19T16:38:12Z",
        "author_association": "MEMBER",
        "body": "> BlockIndex\r\n\r\ninteresting, thank you. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1863108894/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]