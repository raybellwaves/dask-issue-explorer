[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1143723226",
        "html_url": "https://github.com/dask/dask/issues/9067#issuecomment-1143723226",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9067",
        "id": 1143723226,
        "node_id": "IC_kwDOAbcwm85EK9Ta",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-06-01T15:01:33Z",
        "updated_at": "2022-06-01T15:01:33Z",
        "author_association": "MEMBER",
        "body": "Hmmm. I am wondering if somehow the cumsum is being called on the individual partitions before they are coerced to pandas objects. If you wrap the output of the map_partitions func in a `pd.Series` it works as expected. There was some discussion recently on whether dask really should coerce shape 0 objects into objects with ndim=1 (https://github.com/dask/dask/issues/8822). There the thinking was that it is probably a better practice to be explicit about what the output of your function should be.\r\n\r\n```python\r\nimport dask.dataframe as dd\r\nimport pandas as pd\r\n\r\nddf = dd.from_pandas(pd.DataFrame({\"a\": range(10)}), 2)\r\n\r\nres = ddf.map_partitions(lambda x: pd.Series(len(x))).cumsum().compute()\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1143723226/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1192512101",
        "html_url": "https://github.com/dask/dask/issues/9067#issuecomment-1192512101",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9067",
        "id": 1192512101,
        "node_id": "IC_kwDOAbcwm85HFEpl",
        "user": {
            "login": "pavithraes",
            "id": 33131404,
            "node_id": "MDQ6VXNlcjMzMTMxNDA0",
            "avatar_url": "https://avatars.githubusercontent.com/u/33131404?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pavithraes",
            "html_url": "https://github.com/pavithraes",
            "followers_url": "https://api.github.com/users/pavithraes/followers",
            "following_url": "https://api.github.com/users/pavithraes/following{/other_user}",
            "gists_url": "https://api.github.com/users/pavithraes/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pavithraes/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pavithraes/subscriptions",
            "organizations_url": "https://api.github.com/users/pavithraes/orgs",
            "repos_url": "https://api.github.com/users/pavithraes/repos",
            "events_url": "https://api.github.com/users/pavithraes/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pavithraes/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-07-22T12:16:08Z",
        "updated_at": "2022-07-22T12:16:08Z",
        "author_association": "MEMBER",
        "body": "Yes, I agree with Julia's thoughts here.\r\n\r\n> it is probably a better practice to be explicit about what the output of your function should be.\r\n\r\nIt'll be nice to update the `map_partitions` docstring to include this. :)",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1192512101/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]