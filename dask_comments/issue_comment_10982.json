[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1983240093",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1983240093",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1983240093,
        "node_id": "IC_kwDOAbcwm852Nded",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-07T10:44:43Z",
        "updated_at": "2024-03-07T10:44:43Z",
        "author_association": "MEMBER",
        "body": "The query doesn't make much sense, you are computing nunique on one of the group columns which will always return 1\r\n\r\nWe should fix this anyway though",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1983240093/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1983738472",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1983738472",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1983738472,
        "node_id": "IC_kwDOAbcwm852PXJo",
        "user": {
            "login": "frbelotto",
            "id": 24688087,
            "node_id": "MDQ6VXNlcjI0Njg4MDg3",
            "avatar_url": "https://avatars.githubusercontent.com/u/24688087?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/frbelotto",
            "html_url": "https://github.com/frbelotto",
            "followers_url": "https://api.github.com/users/frbelotto/followers",
            "following_url": "https://api.github.com/users/frbelotto/following{/other_user}",
            "gists_url": "https://api.github.com/users/frbelotto/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/frbelotto/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/frbelotto/subscriptions",
            "organizations_url": "https://api.github.com/users/frbelotto/orgs",
            "repos_url": "https://api.github.com/users/frbelotto/repos",
            "events_url": "https://api.github.com/users/frbelotto/events{/privacy}",
            "received_events_url": "https://api.github.com/users/frbelotto/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-07T15:19:11Z",
        "updated_at": "2024-03-07T15:19:11Z",
        "author_association": "NONE",
        "body": "> The query doesn't make much sense, you are computing nunique on one of the group columns which will always return 1\r\n> \r\n> We should fix this anyway though\r\n\r\nLOL.\r\nThis query is part of a bigger query sentence to extract how many unique clients (\"MCIs\") have consumed from each brand. Maybe it could be written is a smarter way, but when we get what was expected, I as not changing it anymore LOL\r\n\r\n```\r\n**base_consumo = gerado.loc[(gerado['produto'] == 'Afiliados') & (gerado['data'] >= datetime(2024,1,1))].groupby(['mci', 'marca'], dropna=False, observed=True)['marca'].nunique().to_frame()**\r\nbase_consumo = base_consumo.groupby(['mci'], dropna=False, observed=True).aggregate({'marca' : 'sum'})\r\nbase_consumo = base_consumo.rename(columns={'marca' : 'qtde_marcas'}).reset_index()\r\nbase_consumo = base_consumo.groupby('qtde_marcas', dropna=False, observed=True)['mci'].nunique().to_frame()\r\nbase_consumo = base_consumo.compute()\r\nbase_consumo.to_excel(f'{pastaloja}\\\\Clientes_por_marcas_afiliados.xlsx', merge_cells=False)\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1983738472/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1983757671",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1983757671",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1983757671,
        "node_id": "IC_kwDOAbcwm852Pb1n",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-07T15:27:41Z",
        "updated_at": "2024-03-07T15:27:41Z",
        "author_association": "MEMBER",
        "body": "PRs to fix are welcome",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1983757671/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1986919942",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1986919942",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1986919942,
        "node_id": "IC_kwDOAbcwm852bf4G",
        "user": {
            "login": "frbelotto",
            "id": 24688087,
            "node_id": "MDQ6VXNlcjI0Njg4MDg3",
            "avatar_url": "https://avatars.githubusercontent.com/u/24688087?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/frbelotto",
            "html_url": "https://github.com/frbelotto",
            "followers_url": "https://api.github.com/users/frbelotto/followers",
            "following_url": "https://api.github.com/users/frbelotto/following{/other_user}",
            "gists_url": "https://api.github.com/users/frbelotto/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/frbelotto/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/frbelotto/subscriptions",
            "organizations_url": "https://api.github.com/users/frbelotto/orgs",
            "repos_url": "https://api.github.com/users/frbelotto/repos",
            "events_url": "https://api.github.com/users/frbelotto/events{/privacy}",
            "received_events_url": "https://api.github.com/users/frbelotto/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-09T17:10:32Z",
        "updated_at": "2024-03-09T17:10:32Z",
        "author_association": "NONE",
        "body": "> PRs to fix are welcome\n\nIs there a newbie guide for where to start? My knowledges on python is average, but I've no experience in building, sharing and keeping a library. I don't even know how to read the source code of the unique method so I could try to better understand what is happening. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1986919942/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1986920502",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1986920502",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1986920502,
        "node_id": "IC_kwDOAbcwm852bgA2",
        "user": {
            "login": "frbelotto",
            "id": 24688087,
            "node_id": "MDQ6VXNlcjI0Njg4MDg3",
            "avatar_url": "https://avatars.githubusercontent.com/u/24688087?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/frbelotto",
            "html_url": "https://github.com/frbelotto",
            "followers_url": "https://api.github.com/users/frbelotto/followers",
            "following_url": "https://api.github.com/users/frbelotto/following{/other_user}",
            "gists_url": "https://api.github.com/users/frbelotto/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/frbelotto/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/frbelotto/subscriptions",
            "organizations_url": "https://api.github.com/users/frbelotto/orgs",
            "repos_url": "https://api.github.com/users/frbelotto/repos",
            "events_url": "https://api.github.com/users/frbelotto/events{/privacy}",
            "received_events_url": "https://api.github.com/users/frbelotto/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-09T17:12:55Z",
        "updated_at": "2024-03-09T17:12:55Z",
        "author_association": "NONE",
        "body": "And for the related example of bug,it's interesting the the \"marca\" column returns an error, but any other column seems to work. My first thought was that is something related to the category dtype ( a very buggy dtype), but I've tried changing it to string and the error persist ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1986920502/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1986921694",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1986921694",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1986921694,
        "node_id": "IC_kwDOAbcwm852bgTe",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-09T17:18:17Z",
        "updated_at": "2024-03-09T17:18:17Z",
        "author_association": "MEMBER",
        "body": "The error happens because Marca is part of your grouping keys, it\u2019s not dtype related",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1986921694/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1986923428",
        "html_url": "https://github.com/dask/dask/issues/10982#issuecomment-1986923428",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10982",
        "id": 1986923428,
        "node_id": "IC_kwDOAbcwm852bguk",
        "user": {
            "login": "frbelotto",
            "id": 24688087,
            "node_id": "MDQ6VXNlcjI0Njg4MDg3",
            "avatar_url": "https://avatars.githubusercontent.com/u/24688087?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/frbelotto",
            "html_url": "https://github.com/frbelotto",
            "followers_url": "https://api.github.com/users/frbelotto/followers",
            "following_url": "https://api.github.com/users/frbelotto/following{/other_user}",
            "gists_url": "https://api.github.com/users/frbelotto/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/frbelotto/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/frbelotto/subscriptions",
            "organizations_url": "https://api.github.com/users/frbelotto/orgs",
            "repos_url": "https://api.github.com/users/frbelotto/repos",
            "events_url": "https://api.github.com/users/frbelotto/events{/privacy}",
            "received_events_url": "https://api.github.com/users/frbelotto/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2024-03-09T17:24:49Z",
        "updated_at": "2024-03-09T17:24:49Z",
        "author_association": "NONE",
        "body": "> The error happens because Marca is part of your grouping keys, it\u2019s not dtype related\n\nBut it does not happen if I use MCI column. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1986923428/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]