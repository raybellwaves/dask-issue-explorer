{
    "url": "https://api.github.com/repos/dask/dask/issues/7377",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/7377/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/7377/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/7377/events",
    "html_url": "https://github.com/dask/dask/issues/7377",
    "id": 830065133,
    "node_id": "MDU6SXNzdWU4MzAwNjUxMzM=",
    "number": 7377,
    "title": "map_partition performing calculations on metadata",
    "user": {
        "login": "achapkowski",
        "id": 5131271,
        "node_id": "MDQ6VXNlcjUxMzEyNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5131271?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achapkowski",
        "html_url": "https://github.com/achapkowski",
        "followers_url": "https://api.github.com/users/achapkowski/followers",
        "following_url": "https://api.github.com/users/achapkowski/following{/other_user}",
        "gists_url": "https://api.github.com/users/achapkowski/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/achapkowski/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/achapkowski/subscriptions",
        "organizations_url": "https://api.github.com/users/achapkowski/orgs",
        "repos_url": "https://api.github.com/users/achapkowski/repos",
        "events_url": "https://api.github.com/users/achapkowski/events{/privacy}",
        "received_events_url": "https://api.github.com/users/achapkowski/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 1342320181,
            "node_id": "MDU6TGFiZWwxMzQyMzIwMTgx",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20info",
            "name": "needs info",
            "color": "d0cfcc",
            "default": false,
            "description": "Needs further information from the user"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 9,
    "created_at": "2021-03-12T12:19:21Z",
    "updated_at": "2021-03-25T20:51:57Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "When I call map_partitions on my accessor, get some unexpected issues.  \r\n\r\nThe first partition has data that is unrelated to the rest of my data.  This is causing issues performing type specific data.  How do I do I account for this first group of data?   It appears the first group is the set of data from the registration of the `make_nonempty.register` call.  \r\n\r\n```\r\n@make_array_nonempty.register(GeoType)\r\ndef _(dtype):\r\n    a = np.array([_default_geometry(), _default_geometry()], dtype=object)\r\n    return _from_geometry(a)\r\n```\r\n\r\nIs there a tag stating this is metadata?  I don't want map_partitions to look at this chunk.\r\n\r\n\r\n```python\r\n     SHAPE                                                        fielda  b\r\n0  {\"x\": 0, \"y\": 0, \"spatialReference\": {\"wkid\": ...       1  1\r\n1  {\"x\": 0, \"y\": 0, \"spatialReference\": {\"wkid\": ...       1  1\r\n                                               SHAPE                             fielda  b\r\n8  {\"curveRings\": [[[-35.09392053986361, 7.573204...    2729  2\r\n9  {\"curveRings\": [[[7.505218982136703, 18.358753...    5387  2\r\n                                               SHAPE                             fielda  b\r\n2  {\"curveRings\": [[[35.51113767361919, 12.957382...    9575  2\r\n3  {\"curveRings\": [[[-18.30138894072785, -16.9425...    9151  2\r\n                                               SHAPE                             fielda  b\r\n6  {\"curveRings\": [[[-21.068573113681047, 33.0624...    2846  2\r\n7  {\"curveRings\": [[[-36.53534927307355, 7.872075...    4623  2\r\n                                               SHAPE                             fielda  b\r\n0  {\"curveRings\": [[[-21.43621100432236, 1.310434...    1708  2\r\n1  {\"curveRings\": [[[-11.702427410357348, 30.1368...    9153  2\r\n                                               SHAPE                            fielda  b\r\n4  {\"curveRings\": [[[33.74060870013736, 40.225838...     828  2\r\n5  {\"curveRings\": [[[-1.1111195840167558, -20.320...    4718  2\r\n```\r\n\r\nI need the operation to skip this snippet below:\r\n\r\n```python\r\n     SHAPE                                                        fielda  b\r\n0  {\"x\": 0, \"y\": 0, \"spatialReference\": {\"wkid\": ...       1  1\r\n1  {\"x\": 0, \"y\": 0, \"spatialReference\": {\"wkid\": ...       1  1\r\n```\r\n\r\n\r\n\r\nI think a solution could be to use `get_partitions` but I think this would prevent the distribution of code to fail.  Any solutions welcome.\r\n\r\n#### UPDATE 1:\r\nThis only occurs is `meta` isn't specified on the `map_partitions`, but the custom type can't be understood...  \r\n\r\nThank you\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/7377/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/7377/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}