[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/564627595",
        "html_url": "https://github.com/dask/dask/issues/5702#issuecomment-564627595",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5702",
        "id": 564627595,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDYyNzU5NQ==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-12-11T16:35:54Z",
        "updated_at": "2019-12-11T16:35:54Z",
        "author_association": "MEMBER",
        "body": "Hmm, looking at\r\n\r\n```python\r\nmerged.index.dt.day_name().divisions\r\n```\r\n\r\nbefore adding that as a column. That looks wrong. It should have the same divisions.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/564627595/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/564633068",
        "html_url": "https://github.com/dask/dask/issues/5702#issuecomment-564633068",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5702",
        "id": 564633068,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDYzMzA2OA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-12-11T16:48:59Z",
        "updated_at": "2019-12-11T16:48:59Z",
        "author_association": "MEMBER",
        "body": "Hmm, actually maybe that's not wrong. We have\r\n\r\n```python\r\nIn [26]: r = merged.index.dt.day_name()\r\n\r\nIn [27]: type(r)\r\nOut[27]: dask.dataframe.core.Index\r\n\r\nIn [28]: r.compute()\r\nOut[28]:\r\nIndex(['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday',\r\n       'Saturday', 'Sunday', 'Monday', 'Tuesday'],\r\n      dtype='object')\r\n\r\nIn [29]: r.divisions\r\nOut[29]: (None, None, None, None, None, None, None, None)\r\n```\r\n\r\nSo I think what *should* happen is `DataFrame.__setitem__(key, value)` should not attempt to align `value` with `self` with `value` is an Index. Rather, it should be treated as an array-like. Roughly,\r\n\r\n```python\r\nIn [3]: r = merged.index.dt.day_name()\r\n\r\nIn [4]: r2 = r.to_dask_array()\r\n\r\nIn [5]: merged['day'] = r2\r\n\r\nIn [6]: merged.head()\r\n/Users/taugspurger/sandbox/dask/dask/dataframe/core.py:5857: UserWarning: Insufficient elements for `head`. 5 elements requested, only 0 elements available. Try passing larger `npartitions` to `head`.\r\n  warnings.warn(msg.format(n, len(r)))\r\nOut[6]:\r\nEmpty DataFrame\r\nColumns: [value_x, value_y, day]\r\nIndex: []\r\n\r\nIn [7]: merged.compute()\r\nOut[7]:\r\n           value_x value_y        day\r\n2019-11-10    left   right     Sunday\r\n2019-11-11    left   right     Monday\r\n2019-11-12    left   right    Tuesday\r\n2019-11-13    left   right  Wednesday\r\n2019-11-14    left   right   Thursday\r\n2019-11-15    left   right     Friday\r\n2019-11-16    left   right   Saturday\r\n2019-11-17    left   right     Sunday\r\n2019-11-18    left   right     Monday\r\n2019-11-19    left   right    Tuesday\r\n```\r\n\r\nWill look into where things are going wrong. (Thanks for the nice bug report btw).",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/564633068/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/564750587",
        "html_url": "https://github.com/dask/dask/issues/5702#issuecomment-564750587",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5702",
        "id": 564750587,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDc1MDU4Nw==",
        "user": {
            "login": "AlbertDeFusco",
            "id": 43654,
            "node_id": "MDQ6VXNlcjQzNjU0",
            "avatar_url": "https://avatars.githubusercontent.com/u/43654?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AlbertDeFusco",
            "html_url": "https://github.com/AlbertDeFusco",
            "followers_url": "https://api.github.com/users/AlbertDeFusco/followers",
            "following_url": "https://api.github.com/users/AlbertDeFusco/following{/other_user}",
            "gists_url": "https://api.github.com/users/AlbertDeFusco/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/AlbertDeFusco/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AlbertDeFusco/subscriptions",
            "organizations_url": "https://api.github.com/users/AlbertDeFusco/orgs",
            "repos_url": "https://api.github.com/users/AlbertDeFusco/repos",
            "events_url": "https://api.github.com/users/AlbertDeFusco/events{/privacy}",
            "received_events_url": "https://api.github.com/users/AlbertDeFusco/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-12-11T21:55:15Z",
        "updated_at": "2019-12-11T21:55:15Z",
        "author_association": "CONTRIBUTOR",
        "body": "Is the `Insufficient elements for head` warning an issue here as well? I don't still quite understand if it can be avoided.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/564750587/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/564758340",
        "html_url": "https://github.com/dask/dask/issues/5702#issuecomment-564758340",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/5702",
        "id": 564758340,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDc1ODM0MA==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-12-11T22:16:54Z",
        "updated_at": "2019-12-11T22:16:54Z",
        "author_association": "MEMBER",
        "body": "That's expected I think. I haven't looked closely, but there probably aren't any overlapping merge keys in the first two partitions, so `.head()` is empty. `.head(npartitions=3)` should give something.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/564758340/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]