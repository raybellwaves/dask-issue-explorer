[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/985866724",
        "html_url": "https://github.com/dask/dask/issues/8448#issuecomment-985866724",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8448",
        "id": 985866724,
        "node_id": "IC_kwDOAbcwm846wyHk",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-03T21:50:10Z",
        "updated_at": "2021-12-03T21:50:10Z",
        "author_association": "MEMBER",
        "body": "Thanks for the proposal @gjoseph92. For reference, @jcrist implemented this in https://github.com/dask/dask/pull/6222, but backed off due to other HLG work that was going on. That said, it's not totally clear what work he was referencing -- maybe @jcrist can clarify?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/985866724/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/993893409",
        "html_url": "https://github.com/dask/dask/issues/8448#issuecomment-993893409",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8448",
        "id": 993893409,
        "node_id": "IC_kwDOAbcwm847PZwh",
        "user": {
            "login": "martindurant",
            "id": 6042212,
            "node_id": "MDQ6VXNlcjYwNDIyMTI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6042212?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/martindurant",
            "html_url": "https://github.com/martindurant",
            "followers_url": "https://api.github.com/users/martindurant/followers",
            "following_url": "https://api.github.com/users/martindurant/following{/other_user}",
            "gists_url": "https://api.github.com/users/martindurant/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/martindurant/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/martindurant/subscriptions",
            "organizations_url": "https://api.github.com/users/martindurant/orgs",
            "repos_url": "https://api.github.com/users/martindurant/repos",
            "events_url": "https://api.github.com/users/martindurant/events{/privacy}",
            "received_events_url": "https://api.github.com/users/martindurant/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-14T19:09:57Z",
        "updated_at": "2021-12-14T19:09:57Z",
        "author_association": "MEMBER",
        "body": "> users expect each of their delayed functions to run as a separate task.\r\n\r\nI don't think this is a strong argument, at least in the normal case that the tasks don't have extra annotations like retry.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/993893409/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/994031414",
        "html_url": "https://github.com/dask/dask/issues/8448#issuecomment-994031414",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8448",
        "id": 994031414,
        "node_id": "IC_kwDOAbcwm847P7c2",
        "user": {
            "login": "davidhao3300",
            "id": 5534398,
            "node_id": "MDQ6VXNlcjU1MzQzOTg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5534398?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidhao3300",
            "html_url": "https://github.com/davidhao3300",
            "followers_url": "https://api.github.com/users/davidhao3300/followers",
            "following_url": "https://api.github.com/users/davidhao3300/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidhao3300/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidhao3300/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidhao3300/subscriptions",
            "organizations_url": "https://api.github.com/users/davidhao3300/orgs",
            "repos_url": "https://api.github.com/users/davidhao3300/repos",
            "events_url": "https://api.github.com/users/davidhao3300/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidhao3300/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-14T21:28:04Z",
        "updated_at": "2021-12-14T21:28:04Z",
        "author_association": "NONE",
        "body": "Was about to file an issue but discovered this one, here's some code that illustrates one possible motivation for having delayed fusion support:\r\n\r\nBasically we want to do a computation but also get some intermediate results. We're also really trying to fuse tasks together into a single node where possible. Our thought was that we can \"join\" the results we want together in a parent computation node that just returns the results. This way dask thinks that the whole thing is one chain and will hopefully fuse together the whole thing\r\n\r\n```python\r\nimport pandas as pd\r\nimport dask.dataframe as dd\r\nimport dask\r\n\r\ndask.config.set({\"optimization.fuse.active\": True})\r\ndf = pd.DataFrame({'a': list(range(1000))})\r\nddf = dd.from_pandas(df, npartitions=1)\r\n\r\n\r\ndef f(x):\r\n    return x\r\ndef g(x):\r\n    return x\r\nddf2 = ddf.map_partitions(g, meta=ddf)\r\nddf3 = ddf.map_partitions(f, meta=ddf)\r\n\r\nddf = ddf2 + ddf3\r\n\r\njoined_ddf = dask.delayed(f)([ddf, ddf2])\r\n\r\n# Works as expected - one fused node\r\n# dask.visualize(ddf, optimize_graph=True)\r\n\r\n# Both are unoptimized\r\n# This one is b/c the intermediate output is requested by the client\r\n# dask.visualize(ddf, ddf2, optimize_graph=True)\r\n\r\n# This one should be optimized and fused into a single node\r\ndask.visualize(joined_ddf, optimize_graph=True)\r\n```\r\n\r\nThis results in the following optimized graph:\r\n<img width=\"218\" alt=\"Screen Shot 2021-12-14 at 1 22 35 PM\" src=\"https://user-images.githubusercontent.com/5534398/146082006-2f37d8a8-fb20-4cf8-ad65-2fc82630f285.png\">\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/994031414/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1317725186",
        "html_url": "https://github.com/dask/dask/issues/8448#issuecomment-1317725186",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8448",
        "id": 1317725186,
        "node_id": "IC_kwDOAbcwm85OiuQC",
        "user": {
            "login": "gjoseph92",
            "id": 3309802,
            "node_id": "MDQ6VXNlcjMzMDk4MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3309802?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gjoseph92",
            "html_url": "https://github.com/gjoseph92",
            "followers_url": "https://api.github.com/users/gjoseph92/followers",
            "following_url": "https://api.github.com/users/gjoseph92/following{/other_user}",
            "gists_url": "https://api.github.com/users/gjoseph92/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/gjoseph92/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/gjoseph92/subscriptions",
            "organizations_url": "https://api.github.com/users/gjoseph92/orgs",
            "repos_url": "https://api.github.com/users/gjoseph92/repos",
            "events_url": "https://api.github.com/users/gjoseph92/events{/privacy}",
            "received_events_url": "https://api.github.com/users/gjoseph92/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-16T21:58:35Z",
        "updated_at": "2022-11-16T21:58:35Z",
        "author_association": "MEMBER",
        "body": "FWIW this is probably much less critical for performance now that queuing is on by default, which fixes root task overproduction.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1317725186/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]