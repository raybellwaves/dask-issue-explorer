[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/789018481",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-789018481",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 789018481,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTAxODQ4MQ==",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-02T16:05:49Z",
        "updated_at": "2021-03-02T16:05:49Z",
        "author_association": "MEMBER",
        "body": "A lot of these are also coming from parquet. It doesn't seem like there is any attempt at closing files in pyarrow. I am not sure how best to workaround this or if I am missing something. In particular, these parts seem to cause issues:\r\n\r\n```\r\n  Traceback (most recent call last):\r\n    File \"/home/julia/dask/dask/dataframe/io/parquet/arrow.py\", line 1586, in _parquet_piece_as_arrow\r\n      arrow_table = piece.read(\r\n  ResourceWarning: unclosed file <_io.BufferedReader name='/tmp/pytest-of-julia/pytest-39/popen-gw7/test_select_partitioned_column1/fake_categorical1=C/fake_categorical2=E/part.1.parquet'>\r\n\r\n  Traceback (most recent call last):\r\n    File \"/home/julia/dask/dask/dataframe/io/parquet/arrow.py\", line 1786, in _gather_metadata\r\n      md = piece.get_metadata()\r\n  ResourceWarning: unclosed file <_io.BufferedReader name='/tmp/pytest-of-julia/pytest-39/popen-gw7/test_categories_large_pyarrow_0/parquet_int16.parq'>\r\n```\r\n\r\nI am wondering if we need to write our own versions of `get_metadata` and `piece.read` @rjzamora ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/789018481/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/789034366",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-789034366",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 789034366,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTAzNDM2Ng==",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-02T16:28:08Z",
        "updated_at": "2021-03-02T16:28:08Z",
        "author_association": "MEMBER",
        "body": "I will open a PR to try to make this discussion clearer.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/789034366/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/789042918",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-789042918",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 789042918,
        "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTA0MjkxOA==",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-03-02T16:39:13Z",
        "updated_at": "2021-03-02T16:39:13Z",
        "author_association": "MEMBER",
        "body": "Awesome, thanks @jsignell",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/789042918/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/911127658",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-911127658",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 911127658,
        "node_id": "IC_kwDOAbcwm842TrRq",
        "user": {
            "login": "GenevieveBuckley",
            "id": 30920819,
            "node_id": "MDQ6VXNlcjMwOTIwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30920819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GenevieveBuckley",
            "html_url": "https://github.com/GenevieveBuckley",
            "followers_url": "https://api.github.com/users/GenevieveBuckley/followers",
            "following_url": "https://api.github.com/users/GenevieveBuckley/following{/other_user}",
            "gists_url": "https://api.github.com/users/GenevieveBuckley/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GenevieveBuckley/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GenevieveBuckley/subscriptions",
            "organizations_url": "https://api.github.com/users/GenevieveBuckley/orgs",
            "repos_url": "https://api.github.com/users/GenevieveBuckley/repos",
            "events_url": "https://api.github.com/users/GenevieveBuckley/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GenevieveBuckley/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-02T03:53:40Z",
        "updated_at": "2021-09-02T03:53:40Z",
        "author_association": "MEMBER",
        "body": "7303 was a [partial fix](https://github.com/dask/dask/pull/7303#issuecomment-910396991) - should this issue be kept open to track the remaining arrow stuff?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/911127658/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/911822920",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-911822920",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 911822920,
        "node_id": "IC_kwDOAbcwm842WVBI",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-02T15:45:09Z",
        "updated_at": "2021-09-02T15:45:09Z",
        "author_association": "MEMBER",
        "body": "Whoops, good catch @GenevieveBuckley -- reopening ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/911822920/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/943089512",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-943089512",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 943089512,
        "node_id": "IC_kwDOAbcwm844Nmdo",
        "user": {
            "login": "GenevieveBuckley",
            "id": 30920819,
            "node_id": "MDQ6VXNlcjMwOTIwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/30920819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/GenevieveBuckley",
            "html_url": "https://github.com/GenevieveBuckley",
            "followers_url": "https://api.github.com/users/GenevieveBuckley/followers",
            "following_url": "https://api.github.com/users/GenevieveBuckley/following{/other_user}",
            "gists_url": "https://api.github.com/users/GenevieveBuckley/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/GenevieveBuckley/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/GenevieveBuckley/subscriptions",
            "organizations_url": "https://api.github.com/users/GenevieveBuckley/orgs",
            "repos_url": "https://api.github.com/users/GenevieveBuckley/repos",
            "events_url": "https://api.github.com/users/GenevieveBuckley/events{/privacy}",
            "received_events_url": "https://api.github.com/users/GenevieveBuckley/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-14T07:29:23Z",
        "updated_at": "2021-10-14T07:29:23Z",
        "author_association": "MEMBER",
        "body": "@jrbourbeau I've recently been doing a lot of running the test suite locally, and I'm not seeing the kinds of warnings you described.\r\nIs this still happening for you? If not, perhaps we can close the issue.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/943089512/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/943829327",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-943829327",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 943829327,
        "node_id": "IC_kwDOAbcwm844QbFP",
        "user": {
            "login": "jrbourbeau",
            "id": 11656932,
            "node_id": "MDQ6VXNlcjExNjU2OTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrbourbeau",
            "html_url": "https://github.com/jrbourbeau",
            "followers_url": "https://api.github.com/users/jrbourbeau/followers",
            "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
            "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
            "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
            "repos_url": "https://api.github.com/users/jrbourbeau/repos",
            "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-14T23:11:22Z",
        "updated_at": "2021-10-14T23:11:22Z",
        "author_association": "MEMBER",
        "body": "Just checked the latest CI build on `main` and, indeed, these unclosed file `ResourceWarning` are gone \ud83c\udf89 \r\n\r\nThanks for following-up here @GenevieveBuckley ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/943829327/reactions",
            "total_count": 2,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 2,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1470431684",
        "html_url": "https://github.com/dask/dask/issues/7167#issuecomment-1470431684",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/7167",
        "id": 1470431684,
        "node_id": "IC_kwDOAbcwm85XpQHE",
        "user": {
            "login": "j-bennet",
            "id": 637013,
            "node_id": "MDQ6VXNlcjYzNzAxMw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/637013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/j-bennet",
            "html_url": "https://github.com/j-bennet",
            "followers_url": "https://api.github.com/users/j-bennet/followers",
            "following_url": "https://api.github.com/users/j-bennet/following{/other_user}",
            "gists_url": "https://api.github.com/users/j-bennet/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/j-bennet/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/j-bennet/subscriptions",
            "organizations_url": "https://api.github.com/users/j-bennet/orgs",
            "repos_url": "https://api.github.com/users/j-bennet/repos",
            "events_url": "https://api.github.com/users/j-bennet/events{/privacy}",
            "received_events_url": "https://api.github.com/users/j-bennet/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-03-15T17:13:22Z",
        "updated_at": "2023-03-15T17:13:22Z",
        "author_association": "MEMBER",
        "body": "This came up again, CI job:\r\n\r\nhttps://github.com/dask/dask/actions/runs/4421267540/jobs/7751871262\r\n\r\n```\r\ndask/dataframe/io/tests/test_parquet.py::test_retries_on_remote_filesystem\r\n  /usr/share/miniconda3/envs/test-environment/lib/python3.10/site-packages/_pytest/unraisableexception.py:78: PytestUnraisableExceptionWarning: Exception ignored in: <_io.FileIO [closed]>\r\n  \r\n  Traceback (most recent call last):\r\n    File \"/home/runner/work/dask/dask/dask/dataframe/io/parquet/arrow.py\", line 1005, in _collect_dataset_info\r\n      physical_schema = file_frag.physical_schema\r\n  ResourceWarning: unclosed file <_io.BufferedReader name='/tmp/tmp57eq_7ze/d549ad8b59c1797315fcb393c08f3fb30bf1195da24aabd1b0dca178e4f34afd'>\r\n  \r\n    warnings.warn(pytest.PytestUnraisableExceptionWarning(msg))\r\n```\r\n\r\nReopening to fix again.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1470431684/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]