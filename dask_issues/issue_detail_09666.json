{
    "url": "https://api.github.com/repos/dask/dask/issues/9666",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/9666/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/9666/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/9666/events",
    "html_url": "https://github.com/dask/dask/pull/9666",
    "id": 1451886706,
    "node_id": "PR_kwDOAbcwm85DCi5u",
    "number": 9666,
    "title": "Use repeat to build nearest boundary",
    "user": {
        "login": "j2bbayle",
        "id": 3016805,
        "node_id": "MDQ6VXNlcjMwMTY4MDU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3016805?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/j2bbayle",
        "html_url": "https://github.com/j2bbayle",
        "followers_url": "https://api.github.com/users/j2bbayle/followers",
        "following_url": "https://api.github.com/users/j2bbayle/following{/other_user}",
        "gists_url": "https://api.github.com/users/j2bbayle/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/j2bbayle/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/j2bbayle/subscriptions",
        "organizations_url": "https://api.github.com/users/j2bbayle/orgs",
        "repos_url": "https://api.github.com/users/j2bbayle/repos",
        "events_url": "https://api.github.com/users/j2bbayle/events{/privacy}",
        "received_events_url": "https://api.github.com/users/j2bbayle/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 3468123446,
            "node_id": "LA_kwDOAbcwm87Ot102",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20attention",
            "name": "needs attention",
            "color": "6d626c",
            "default": false,
            "description": "It's been a while since this was pushed on. Needs attention from the owner or a maintainer."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2022-11-16T16:16:43Z",
    "updated_at": "2024-04-29T01:46:19Z",
    "closed_at": null,
    "author_association": "FIRST_TIME_CONTRIBUTOR",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
        "url": "https://api.github.com/repos/dask/dask/pulls/9666",
        "html_url": "https://github.com/dask/dask/pull/9666",
        "diff_url": "https://github.com/dask/dask/pull/9666.diff",
        "patch_url": "https://github.com/dask/dask/pull/9666.patch",
        "merged_at": null
    },
    "body": "The current implementation of `map_overlap` with `boundary='nearest'` uses dark.array.overlap.nearest, which copies the first and last elements of the array, concatenate them, and then finally concatenate the array and the repeated first and last elements.\r\n\r\nThis works well, but produces unreadable visualizations. As an example, here's what one obtain for the following simple example.\r\n\r\n```python\r\nimport dask.array as da\r\n\r\nx = da.arange(50)\r\ny = x.map_overlap(lambda x: x + 1, depth=20, boundary='nearest')\r\n\r\ny.visualize(optimize_graph=False)\r\n```\r\n\r\n![69a8dde3-8f08-401a-a0d7-824f931bd62d](https://user-images.githubusercontent.com/3016805/202234553-906aa395-0ec5-4a29-b63b-0bc757d2cf85.png)\r\n\r\nIn this pull request, I replace the element copy/concatenate steps by a call to `da.repeat`. It's probably very similar in terms of performance (though I haven't tested that), but produces much cleaner graphs. Here it is for the previous example.\r\n\r\n![9f55d512-0e9f-4fae-b273-eacbd399af17](https://user-images.githubusercontent.com/3016805/202234628-ec50226b-da50-4975-a38d-7b5aa55634cc.png)\r\n\r\n- [X] Tests passed\r\n- [X] Passes `pre-commit run --all-files`\r\n\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/9666/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/9666/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}