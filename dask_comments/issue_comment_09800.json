[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1372615795",
        "html_url": "https://github.com/dask/dask/issues/9800#issuecomment-1372615795",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9800",
        "id": 1372615795,
        "node_id": "IC_kwDOAbcwm85R0HRz",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-05T19:03:22Z",
        "updated_at": "2023-01-05T19:03:22Z",
        "author_association": "MEMBER",
        "body": "Hrm, I agree that that's odd.  Thank you for constructing the example.  \r\n\r\nFWIW, this works fine for me on OSX on 3.11 (just what I happen to have in front of me at the moment).  I do get this though.\r\n\r\n```python\r\nIn [6]: df.set_index(\"idx\").divisions\r\n/Users/mrocklin/mambaforge/envs/test-environment/lib/python3.11/site-packages/pandas/core/arrays/numpy_.py:99: RuntimeWarning: invalid value encountered in cast\r\n  result = np.asarray(scalars, dtype=dtype)  # type: ignore[arg-type]\r\nOut[6]: (0, 2855872695475529216, 6039622366165152768, 9223372036854775807)\r\n```\r\n\r\nPart of me wonders if we should even try to handle overflow in divisions though.  I'm curious, in what context did this arise?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1372615795/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1396176890",
        "html_url": "https://github.com/dask/dask/issues/9800#issuecomment-1396176890",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9800",
        "id": 1396176890,
        "node_id": "IC_kwDOAbcwm85TN_f6",
        "user": {
            "login": "j-bennet",
            "id": 637013,
            "node_id": "MDQ6VXNlcjYzNzAxMw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/637013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/j-bennet",
            "html_url": "https://github.com/j-bennet",
            "followers_url": "https://api.github.com/users/j-bennet/followers",
            "following_url": "https://api.github.com/users/j-bennet/following{/other_user}",
            "gists_url": "https://api.github.com/users/j-bennet/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/j-bennet/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/j-bennet/subscriptions",
            "organizations_url": "https://api.github.com/users/j-bennet/orgs",
            "repos_url": "https://api.github.com/users/j-bennet/repos",
            "events_url": "https://api.github.com/users/j-bennet/events{/privacy}",
            "received_events_url": "https://api.github.com/users/j-bennet/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-18T22:28:00Z",
        "updated_at": "2023-01-18T22:28:00Z",
        "author_association": "MEMBER",
        "body": "This works for me as well, I'm on OSX with Python 3.10. The issue may be platform-dependent. I get the exact same divisions as @mrocklin:\r\n\r\n```python\r\n> ipython\r\nPython 3.10.8 | packaged by conda-forge | (main, Nov 22 2022, 08:25:29) [Clang 14.0.6 ]\r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 8.8.0 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: %run t1.py\r\nIdx positive? True\r\nIdx sorted? True\r\nDivisions? (0, 333, 666, 999)\r\n\r\nIn [3]: df.set_index(\"idx\").divisions\r\nOut[3]: (0, 2855872695475529216, 6039622366165152768, 9223372036854775807)\r\n```\r\n\r\nThis is my version info:\r\n\r\n```\r\nIn [6]: dask.utils.show_versions()\r\n{\r\n  \"Python\": \"3.10.8\",\r\n  \"Platform\": \"Darwin\",\r\n  \"dask\": \"2023.1.0+6.g0b4ff2c69\",\r\n  \"distributed\": \"2023.1.0+3.g8fe80568\",\r\n  \"numpy\": \"1.23.5\",\r\n  \"pandas\": \"1.5.2\",\r\n  \"cloudpickle\": \"2.2.0\",\r\n  \"fsspec\": \"2022.11.0\",\r\n  \"bokeh\": \"2.4.3\",\r\n  \"fastparquet\": \"2022.12.0\",\r\n  \"pyarrow\": \"10.0.1\",\r\n  \"zarr\": \"2.13.3\"\r\n}\r\n```\r\n\r\n@cbyrohl what does your version info look like?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1396176890/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1396613737",
        "html_url": "https://github.com/dask/dask/issues/9800#issuecomment-1396613737",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9800",
        "id": 1396613737,
        "node_id": "IC_kwDOAbcwm85TPqJp",
        "user": {
            "login": "cbyrohl",
            "id": 9221545,
            "node_id": "MDQ6VXNlcjkyMjE1NDU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9221545?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/cbyrohl",
            "html_url": "https://github.com/cbyrohl",
            "followers_url": "https://api.github.com/users/cbyrohl/followers",
            "following_url": "https://api.github.com/users/cbyrohl/following{/other_user}",
            "gists_url": "https://api.github.com/users/cbyrohl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/cbyrohl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cbyrohl/subscriptions",
            "organizations_url": "https://api.github.com/users/cbyrohl/orgs",
            "repos_url": "https://api.github.com/users/cbyrohl/repos",
            "events_url": "https://api.github.com/users/cbyrohl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/cbyrohl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-01-19T08:34:18Z",
        "updated_at": "2023-01-19T08:34:55Z",
        "author_association": "NONE",
        "body": "@mrocklin Context: I cannot give much detail as the current issue is just secondary. We have a large data set sorted by non-unique identifiers (marking which group a row belongs to; MAX_INT being non-grouped entries). Trying to use the partitioning, I ran into an exception. Creating a minimal example, I ended up here.\r\n\r\n@j-bennet Interesting. I set up multiple environments on my workstation. Here's the result (check mark indicating run without error):\r\n\r\n- [ ] Python 3.9 Dask 2022.12.1\r\n- [ ] Python 3.10 Dask 2022.12.1\r\n- [ ] Python 3.10 Dask 2023.1.0\r\n\r\nI.e. have not found any working setup yet. I am using linux and tested this both with debian and fedora.\r\n\r\nEnvironments (same order) created with:\r\n\r\n- conda create -n debug_dask39 python=3.9 dask=2022.12.1 numpy\r\n```\r\n{\r\n  \"Python\": \"3.9.16\",\r\n  \"Platform\": \"Linux\",\r\n  \"dask\": \"2022.12.1\",\r\n  \"distributed\": \"2022.12.1\",\r\n  \"numpy\": \"1.23.5\",\r\n  \"pandas\": \"1.4.1\",\r\n  \"cloudpickle\": \"2.0.0\",\r\n  \"fsspec\": \"2022.2.0\",\r\n  \"bokeh\": \"2.4.3\",\r\n  \"fastparquet\": null,\r\n  \"pyarrow\": null,\r\n  \"zarr\": \"2.11.1\"\r\n```\r\n- conda create -n debug_dask310 python=3.10 dask=2022.12.1 numpy\r\n```\r\n{\r\n  \"Python\": \"3.10.9\",\r\n  \"Platform\": \"Linux\",\r\n  \"dask\": \"2022.12.1\",\r\n  \"distributed\": \"2022.12.1\",\r\n  \"numpy\": \"1.23.5\",\r\n  \"pandas\": \"1.5.2\",\r\n  \"cloudpickle\": \"2.0.0\",\r\n  \"fsspec\": \"2022.11.0\",\r\n  \"bokeh\": \"2.4.3\",\r\n  \"fastparquet\": null,\r\n  \"pyarrow\": null,\r\n  \"zarr\": null\r\n}\r\n```\r\n- conda create -n debug_dask310_23 python=3.10 dask=2023.1.0 numpy\r\n```\r\n{\r\n  \"Python\": \"3.10.9\",\r\n  \"Platform\": \"Linux\",\r\n  \"dask\": \"2023.1.0\",\r\n  \"distributed\": \"2023.1.0\",\r\n  \"numpy\": \"1.23.5\",\r\n  \"pandas\": \"1.5.2\",\r\n  \"cloudpickle\": \"2.0.0\",\r\n  \"fsspec\": \"2022.11.0\",\r\n  \"bokeh\": \"2.4.3\",\r\n  \"fastparquet\": null,\r\n  \"pyarrow\": null,\r\n  \"zarr\": null\r\n}\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1396613737/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]