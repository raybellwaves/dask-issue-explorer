{
    "url": "https://api.github.com/repos/dask/dask/issues/3682",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/3682/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/3682/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/3682/events",
    "html_url": "https://github.com/dask/dask/issues/3682",
    "id": 336636972,
    "node_id": "MDU6SXNzdWUzMzY2MzY5NzI=",
    "number": 3682,
    "title": "Support dask arrays in keywords in map_blocks",
    "user": {
        "login": "mrocklin",
        "id": 306380,
        "node_id": "MDQ6VXNlcjMwNjM4MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mrocklin",
        "html_url": "https://github.com/mrocklin",
        "followers_url": "https://api.github.com/users/mrocklin/followers",
        "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
        "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
        "organizations_url": "https://api.github.com/users/mrocklin/orgs",
        "repos_url": "https://api.github.com/users/mrocklin/repos",
        "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mrocklin/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2018-06-28T14:06:53Z",
    "updated_at": "2018-06-29T15:21:59Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "Currently we only check `*args` for dask arrays, and convert anything in keyword arguments to concrete objects when they are passed into the user defined function.  We might consider also looking into the keyword arguments for dask arrays\r\n\r\n```python\r\nIn [1]: import dask.array as da\r\n\r\nIn [2]: def f(x):\r\n   ...:     print(x.shape)\r\n   ...:     return x\r\n   ...: \r\n\r\nIn [3]: x = da.ones((10, 10), chunks=(5, 5))\r\n\r\nIn [4]: da.map_blocks(f, x, dtype=x.dtype).compute()\r\n(5, 5)\r\n(5, 5)\r\n(5, 5)\r\n(5, 5)\r\nOut[4]: \r\narray([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],\r\n       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]])\r\n\r\nIn [5]: da.map_blocks(f, x=x, dtype=x.dtype).compute()\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-5-0ef3a9dd6003> in <module>()\r\n----> 1 da.map_blocks(f, x=x, dtype=x.dtype).compute()\r\n\r\n~/workspace/dask/dask/array/core.py in map_blocks(func, *args, **kwargs)\r\n    696     numblocks = {a.name: a.numblocks for a in arrs}\r\n    697     arginds = list(concat(argpairs))\r\n--> 698     out_ind = tuple(range(max(a.ndim for a in arrs)))[::-1]\r\n    699 \r\n    700     try:\r\n\r\nValueError: max() arg is an empty sequence\r\n```\r\n\r\nMy only concern is that people might be relying on this behavior.\r\n\r\ncc @jakirkham @stuartarchibald ",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/3682/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/3682/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}