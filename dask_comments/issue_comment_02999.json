[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/351957345",
        "html_url": "https://github.com/dask/dask/issues/2999#issuecomment-351957345",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/2999",
        "id": 351957345,
        "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTk1NzM0NQ==",
        "user": {
            "login": "michcio1234",
            "id": 16254622,
            "node_id": "MDQ6VXNlcjE2MjU0NjIy",
            "avatar_url": "https://avatars.githubusercontent.com/u/16254622?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/michcio1234",
            "html_url": "https://github.com/michcio1234",
            "followers_url": "https://api.github.com/users/michcio1234/followers",
            "following_url": "https://api.github.com/users/michcio1234/following{/other_user}",
            "gists_url": "https://api.github.com/users/michcio1234/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/michcio1234/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/michcio1234/subscriptions",
            "organizations_url": "https://api.github.com/users/michcio1234/orgs",
            "repos_url": "https://api.github.com/users/michcio1234/repos",
            "events_url": "https://api.github.com/users/michcio1234/events{/privacy}",
            "received_events_url": "https://api.github.com/users/michcio1234/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2017-12-15T09:29:11Z",
        "updated_at": "2017-12-15T09:29:11Z",
        "author_association": "NONE",
        "body": "After taking a look at dask tests I discovered what follows:\r\n```python\r\nIn[2]: import dask\r\n  ...: import dask.dataframe as dd\r\n  ...: import pandas as pd\r\n  ...: import numpy as np\r\n\r\nIn[3]: ddf = dd.from_pandas(pd.DataFrame({'A': [1, 2]}, index=pd.Series([0, 1], name='idx')), npartitions=1)\r\n\r\nIn[4]: ddf.divisions\r\nOut[4]: (0, 1)\r\n\r\nIn[5]: ddf.groupby(ddf.index).sum().divisions\r\nOut[5]: (None, None)\r\n\r\nIn[6]: ddf.groupby('idx').sum().divisions\r\nOut[6]: (None, None)\r\n\r\nIn[7]: ddf.groupby(ddf.index).apply(np.sum).divisions\r\nUserWarning: `meta` is not specified...\r\nOut[7]: (None, None)\r\n\r\nIn[8]: ddf.groupby('idx').apply(np.sum).divisions\r\nUserWarning: `meta` is not specified...\r\nOut[8]: (0, 1)\r\n```\r\n(warnings were truncated)\r\n\r\nSo, the expected behaviour occurs only when\r\n1. I pass index name instead of the index itself to a `groupby` method AND\r\n2. I use `.apply(np.sum)` instead of `.sum()` as an aggregation (works with built-in `sum` too)",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/351957345/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/352146370",
        "html_url": "https://github.com/dask/dask/issues/2999#issuecomment-352146370",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/2999",
        "id": 352146370,
        "node_id": "MDEyOklzc3VlQ29tbWVudDM1MjE0NjM3MA==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2017-12-16T00:45:48Z",
        "updated_at": "2017-12-16T00:45:48Z",
        "author_association": "MEMBER",
        "body": "Right, I think that groupby-aggregations currently always produce a\nsingle-partition dataframe.  There isn't currently any special behavior\nwhen operating on the index.\n\nWe do perform special behavior on groupby-apply operations, just because\nnot doing special behavior here can be so much more expensive (full\nshuffles occur).\n\nIt seems reasonable to me to also add special handling on\ngroupby-aggregations as you suggest if we happen to have well-known\ndivisions (as we do in your case).\n\nOn Fri, Dec 15, 2017 at 3:29 AM, Micha\u0142 D <notifications@github.com> wrote:\n\n> After taking a look at dask tests I discovered what follows:\n>\n> In[2]: import dask\n>   ...: import dask.dataframe as dd\n>   ...: import pandas as pd\n>   ...: import numpy as np\n>\n> In[3]: ddf = dd.from_pandas(pd.DataFrame({'A': [1, 2]}, index=pd.Series([0, 1], name='idx')), npartitions=1)\n>\n> In[4]: ddf.divisions\n> Out[4]: (0, 1)\n>\n> In[5]: ddf.groupby(ddf.index).sum().divisions\n> Out[5]: (None, None)\n>\n> In[6]: ddf.groupby('idx').sum().divisions\n> Out[6]: (None, None)\n>\n> In[7]: ddf.groupby(ddf.index).apply(np.sum).divisionsUserWarning: `meta` is not specified...\n> Out[7]: (None, None)\n>\n> In[8]: ddf.groupby('idx').apply(np.sum).divisionsUserWarning: `meta` is not specified...\n> Out[8]: (0, 1)\n>\n> (warnings were truncated)\n>\n> So, the expected behaviour occurs only when\n>\n>    1. I pass index name instead of the index itself to a groupby method\n>    AND\n>    2. I use .apply(np.sum) instead of .sum() as an aggregation (works\n>    with built-in sum too)\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/2999#issuecomment-351957345>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AASszGy9RCDB2iZ8hyje6BHJGK7hDCQKks5tAjvogaJpZM4RCTnZ>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/352146370/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]