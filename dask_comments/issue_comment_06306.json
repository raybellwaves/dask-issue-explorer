[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/642033319",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-642033319",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 642033319,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MjAzMzMxOQ==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-10T14:05:50Z",
        "updated_at": "2020-06-10T14:05:50Z",
        "author_association": "MEMBER",
        "body": "@mk0417 is this just numerical imprecision adding up during the groupby?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/642033319/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/642531667",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-642531667",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 642531667,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MjUzMTY2Nw==",
        "user": {
            "login": "mk0417",
            "id": 27696880,
            "node_id": "MDQ6VXNlcjI3Njk2ODgw",
            "avatar_url": "https://avatars.githubusercontent.com/u/27696880?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mk0417",
            "html_url": "https://github.com/mk0417",
            "followers_url": "https://api.github.com/users/mk0417/followers",
            "following_url": "https://api.github.com/users/mk0417/following{/other_user}",
            "gists_url": "https://api.github.com/users/mk0417/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mk0417/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mk0417/subscriptions",
            "organizations_url": "https://api.github.com/users/mk0417/orgs",
            "repos_url": "https://api.github.com/users/mk0417/repos",
            "events_url": "https://api.github.com/users/mk0417/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mk0417/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-11T09:31:58Z",
        "updated_at": "2020-06-11T09:31:58Z",
        "author_association": "NONE",
        "body": "@TomAugspurger yes, this should be related to numerical precison in groupby. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/642531667/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/642655559",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-642655559",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 642655559,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MjY1NTU1OQ==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-11T13:39:39Z",
        "updated_at": "2020-06-11T13:39:39Z",
        "author_association": "MEMBER",
        "body": "Do you think there's anything Dask can do about that? I haven't looked at\nhow something like `.std` is implemented, but even something like a sum\nthat's implemented as a sum of sums will (I think) pick up different\namounts of imprecision that if you're summing an individual array.\n\nOn Thu, Jun 11, 2020 at 4:32 AM mk0417 <notifications@github.com> wrote:\n\n> @TomAugspurger <https://github.com/TomAugspurger> yes, this should be\n> related to numerical precison in groupby.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/6306#issuecomment-642531667>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAKAOITYZ4BHN2E27ZL77CTRWCQB7ANCNFSM4N2LXB6A>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/642655559/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/642922105",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-642922105",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 642922105,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MjkyMjEwNQ==",
        "user": {
            "login": "mk0417",
            "id": 27696880,
            "node_id": "MDQ6VXNlcjI3Njk2ODgw",
            "avatar_url": "https://avatars.githubusercontent.com/u/27696880?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mk0417",
            "html_url": "https://github.com/mk0417",
            "followers_url": "https://api.github.com/users/mk0417/followers",
            "following_url": "https://api.github.com/users/mk0417/following{/other_user}",
            "gists_url": "https://api.github.com/users/mk0417/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mk0417/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mk0417/subscriptions",
            "organizations_url": "https://api.github.com/users/mk0417/orgs",
            "repos_url": "https://api.github.com/users/mk0417/repos",
            "events_url": "https://api.github.com/users/mk0417/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mk0417/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-11T20:51:58Z",
        "updated_at": "2020-06-11T20:51:58Z",
        "author_association": "NONE",
        "body": "You are right, but I am not sure how to control numerical stability. Having a check for constant series to avoid nonzero result? \r\n\r\nHere is an open discussion from numpy: https://github.com/numpy/numpy/issues/9631",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/642922105/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/643221672",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-643221672",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 643221672,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MzIyMTY3Mg==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-12T11:29:18Z",
        "updated_at": "2020-06-12T11:29:18Z",
        "author_association": "MEMBER",
        "body": "> Having a check for constant series to avoid nonzero result?\r\n\r\nWhat would that look like?\r\n\r\nJust a guess, but I suspect that most users don't actually care about the numerical imprecision issues. So I'd be fine with a small section in the docs explaining why they arise in parallel systems. But I'm not sure exactly where that would go.\r\n\r\n@mk0417 are you interested in finding a section to put it and writing a small note explaining things?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/643221672/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/643627411",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-643627411",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 643627411,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0MzYyNzQxMQ==",
        "user": {
            "login": "mk0417",
            "id": 27696880,
            "node_id": "MDQ6VXNlcjI3Njk2ODgw",
            "avatar_url": "https://avatars.githubusercontent.com/u/27696880?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mk0417",
            "html_url": "https://github.com/mk0417",
            "followers_url": "https://api.github.com/users/mk0417/followers",
            "following_url": "https://api.github.com/users/mk0417/following{/other_user}",
            "gists_url": "https://api.github.com/users/mk0417/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mk0417/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mk0417/subscriptions",
            "organizations_url": "https://api.github.com/users/mk0417/orgs",
            "repos_url": "https://api.github.com/users/mk0417/repos",
            "events_url": "https://api.github.com/users/mk0417/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mk0417/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-13T13:57:14Z",
        "updated_at": "2020-06-13T14:24:56Z",
        "author_association": "NONE",
        "body": "@TomAugspurger, yes, just raising this point and having a note should be enough. How about adding the note below into somewhere in this file: https://docs.dask.org/en/latest/dataframe-api.html#dataframegroupby\r\n\r\n```\r\n# Notes for groupby aggregation when the data series is constant\r\n# For example, the series is [0.1, 0.1, 0.1, 0.1, 0.1, ..., 0.1],\r\n# Standard deviation of the series is 0 and the mean is 0.1.\r\n# However, the results may vary due to numerical precision.\r\n\r\nimport pandas as pd\r\nimport dask.dataframe as dd\r\nimport numpy as np\r\n\r\ndf = pd.DataFrame({'x': ['a']*100, 'y': [0.1]*100})\r\nddf = dd.from_pandas(df, npartitions=2)\r\n\r\n# Dask aggregation\r\nddf.groupby('x')['y'].agg('std).compute()[0]\r\n# result: 3.6684122973481637e-09\r\n\r\nddf.groupby('x')['y'].agg('mean').compute()[0]\r\n# result: 0.09999999999999996\r\n\r\n# If this is not desirable in your case, you can apply user defined function\r\ndef mystd(data):\r\n    if np.ptp(data) == 0:\r\n        std = 0\r\n    else:\r\n        std = np.std(data, ddof=1)\r\n    return std\r\n\r\ndef mymean(data):\r\n    if np.ptp(data) == 0:\r\n        mean = data.unique()[0]\r\n    else:\r\n        mean = np.mean(data)\r\n    return mean\r\n\r\nddf.groupby('x')['y'].apply(mystd, meta=('y', 'f8')).compute()[0]\r\n# result: 0\r\n\r\nddf.groupby('x')['y'].apply(mymean, meta=('y', 'f8')).compute()[0]\r\n# result: 0.1\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/643627411/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/644971521",
        "html_url": "https://github.com/dask/dask/issues/6306#issuecomment-644971521",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6306",
        "id": 644971521,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY0NDk3MTUyMQ==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-06-16T19:36:51Z",
        "updated_at": "2020-06-16T19:36:51Z",
        "author_association": "MEMBER",
        "body": "> How about adding the note below into somewhere in this file: https://docs.dask.org/en/latest/dataframe-api.html#dataframegroupby\r\n\r\nI don't think that's the appropriate section. This potentially applies to any parallel computation.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/644971521/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]