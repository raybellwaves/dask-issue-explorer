[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/678618943",
        "html_url": "https://github.com/dask/dask/issues/6541#issuecomment-678618943",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6541",
        "id": 678618943,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3ODYxODk0Mw==",
        "user": {
            "login": "nils-braun",
            "id": 6116188,
            "node_id": "MDQ6VXNlcjYxMTYxODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6116188?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nils-braun",
            "html_url": "https://github.com/nils-braun",
            "followers_url": "https://api.github.com/users/nils-braun/followers",
            "following_url": "https://api.github.com/users/nils-braun/following{/other_user}",
            "gists_url": "https://api.github.com/users/nils-braun/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nils-braun/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nils-braun/subscriptions",
            "organizations_url": "https://api.github.com/users/nils-braun/orgs",
            "repos_url": "https://api.github.com/users/nils-braun/repos",
            "events_url": "https://api.github.com/users/nils-braun/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nils-braun/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-22T09:30:44Z",
        "updated_at": "2020-08-22T09:30:44Z",
        "author_association": "CONTRIBUTOR",
        "body": "Some more information:\r\nI looked a bit deeper into the code. As I do not pass any divisions, `dask` will compute them automatically in the second example. The result is `[1, 1, 2, 3]`. I would say that is strange, because I was expecting something like `[1, 2, 3, 3]`. Actually, if I try to pass in these divisions into the `set_index` function directly, it fails due to invalid divisions. That means for me it seems `dask` is calculating invalid divisions internally",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/678618943/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/678668154",
        "html_url": "https://github.com/dask/dask/issues/6541#issuecomment-678668154",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6541",
        "id": 678668154,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3ODY2ODE1NA==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-22T17:24:25Z",
        "updated_at": "2020-08-22T17:24:25Z",
        "author_association": "MEMBER",
        "body": "Right. Dask is computing approximate quantiles, and then uses those for\ndivisions.  The quantiles here look pretty good.   Unfortunately for this\ncase, division values are assumed to be greater than all values within a\npartition. So all of the one values are placed in the second partition\nafter the one valued division.\n\nI guess the general failure here comes when you have a lot of values right\non the division value, as we do here. In a more continuous distribution of\nvalues this less than vs less than or equal to distinction wouldn't make a\ndifference.\n\nThere may be some smarter logic that would improve this case while still\nworking generally.  If anyone has solutions they would be welcome.\n\n\nOn Sat, Aug 22, 2020, 2:30 AM Nils Braun <notifications@github.com> wrote:\n\n> Some more information:\n> I looked a bit deeper into the code. As I do not pass any divisions, dask\n> will compute them automatically in the second example. The result is [1,\n> 1, 2, 3]. I would say that is strange, because I was expecting something\n> like [1, 2, 3, 3]. Actually, if I try to pass in these divisions into the\n> set_index function directly, it fails due to invalid divisions. That\n> means for me it seems dask is calculating invalid divisions internally\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/6541#issuecomment-678618943>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACKZTFDTK2XRYWGGNGUSHLSB6F5BANCNFSM4QH7R3IQ>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/678668154/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/678691345",
        "html_url": "https://github.com/dask/dask/issues/6541#issuecomment-678691345",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6541",
        "id": 678691345,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3ODY5MTM0NQ==",
        "user": {
            "login": "nils-braun",
            "id": 6116188,
            "node_id": "MDQ6VXNlcjYxMTYxODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6116188?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nils-braun",
            "html_url": "https://github.com/nils-braun",
            "followers_url": "https://api.github.com/users/nils-braun/followers",
            "following_url": "https://api.github.com/users/nils-braun/following{/other_user}",
            "gists_url": "https://api.github.com/users/nils-braun/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nils-braun/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nils-braun/subscriptions",
            "organizations_url": "https://api.github.com/users/nils-braun/orgs",
            "repos_url": "https://api.github.com/users/nils-braun/repos",
            "events_url": "https://api.github.com/users/nils-braun/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nils-braun/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-22T20:38:19Z",
        "updated_at": "2020-08-22T20:38:19Z",
        "author_association": "CONTRIBUTOR",
        "body": "Thanks for the clarification, @mrocklin! I am fine with keeping the logic like this if it works for most of the cases - just wasn't sure if I have hit a bug.\r\n\r\nIf one wants to fix something, I guess the first idea would be to turn the `[1, 1, 2, 3]` somehow into a `[1, 2, 3, 3]` - but I have not looked into the code for this feature that much to have any reasonable understanding on how easy that is.\r\n\r\nI am fine with closing this issue - or we can keep it open for further developments.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/678691345/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/678692386",
        "html_url": "https://github.com/dask/dask/issues/6541#issuecomment-678692386",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6541",
        "id": 678692386,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3ODY5MjM4Ng==",
        "user": {
            "login": "mrocklin",
            "id": 306380,
            "node_id": "MDQ6VXNlcjMwNjM4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/306380?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mrocklin",
            "html_url": "https://github.com/mrocklin",
            "followers_url": "https://api.github.com/users/mrocklin/followers",
            "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
            "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
            "organizations_url": "https://api.github.com/users/mrocklin/orgs",
            "repos_url": "https://api.github.com/users/mrocklin/repos",
            "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mrocklin/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-22T20:47:11Z",
        "updated_at": "2020-08-22T20:47:11Z",
        "author_association": "MEMBER",
        "body": "I think that a sensible improvement would be to identify the situation\nwhere the first two values are the same.  This is guaranteed to be an empty\npartition.  We should either omit this partition entirely or else choose a\nslightly higher value (maybe ten percent of the way towards the next value)\nif the datatype permits.\n\nOn Sat, Aug 22, 2020, 1:38 PM Nils Braun <notifications@github.com> wrote:\n\n> Thanks for the clarification, @mrocklin <https://github.com/mrocklin>! I\n> am fine with keeping the logic like this if it works for most of the cases\n> - just wasn't sure if I have hit a bug.\n>\n> If one wants to fix something, I guess the first idea would be to turn the [1,\n> 1, 2, 3] somehow into a [1, 2, 3, 3] - but I have not looked into the\n> code for this feature that much to have any reasonable understanding on how\n> easy that is.\n>\n> I am fine with closing this issue - or we can keep it open for further\n> developments.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/dask/dask/issues/6541#issuecomment-678691345>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACKZTHZY6AKEGGHSOHGYE3SCAUENANCNFSM4QH7R3IQ>\n> .\n>\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/678692386/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]