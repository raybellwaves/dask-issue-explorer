{
    "url": "https://api.github.com/repos/dask/dask/issues/3523",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/3523/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/3523/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/3523/events",
    "html_url": "https://github.com/dask/dask/issues/3523",
    "id": 325637844,
    "node_id": "MDU6SXNzdWUzMjU2Mzc4NDQ=",
    "number": 3523,
    "title": "dask.get apparent inconsistencies and possible bug",
    "user": {
        "login": "lsorber",
        "id": 4543654,
        "node_id": "MDQ6VXNlcjQ1NDM2NTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4543654?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lsorber",
        "html_url": "https://github.com/lsorber",
        "followers_url": "https://api.github.com/users/lsorber/followers",
        "following_url": "https://api.github.com/users/lsorber/following{/other_user}",
        "gists_url": "https://api.github.com/users/lsorber/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lsorber/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lsorber/subscriptions",
        "organizations_url": "https://api.github.com/users/lsorber/orgs",
        "repos_url": "https://api.github.com/users/lsorber/repos",
        "events_url": "https://api.github.com/users/lsorber/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lsorber/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 8,
    "created_at": "2018-05-23T10:08:57Z",
    "updated_at": "2018-05-30T14:03:03Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I found some apparent inconsistencies and a possible bug with dask.get. See minimal example below (outputs captured with dask 0.17.5).\r\n\r\n**Specifically:**\r\n\r\n1. Example 5 seems like inconsistent behaviour compared to Examples 3 and 4.\r\n2. I see no reason why Example 7 should throw a KeyError compared to Example 6.\r\n\r\nIn general, I'm pretty confused as to when Dask will choose to interpolate string literals with the output of other keys in the graph and when it won't. The docs also don't specify how exactly Dask will process a graph. Rules that I've assembled by reading the docs and experimenting seem to be:\r\n\r\n1. Strings are replaced by the output of keys with the same name.\r\n2. There is interpolation inside tuples if the first element is a function. Examples 3-5 show inconsistent behaviour here though.\r\n3. Other literals are not interpolated. However, Example 7 raises a KeyError.\r\n\r\nDoes the above describe the (intended) rules accurately?\r\n\r\n```python\r\nimport dask\r\n\r\n# Example 1\r\ndsk = {'a': 1, 'b': 'a'}\r\nprint(dask.get(dsk, 'b'))\r\n# Out: 1 --> OK, 'a' is interpolated to 1\r\n\r\n# Example 2\r\ndsk = {'a': 1, 'b': ('a', ) }\r\nprint(dask.get(dsk, 'b'))\r\n# Out: ('a', ) --> OK, so no interpolation of 'a' here\r\n\r\n# Example 3\r\ndsk = {'a': 1, 'b': (tuple, ['a']) }\r\nprint(dask.get(dsk, 'b'))\r\n# Out: ('a', ) --> OK, so this interpolates 'a' to 1\r\n\r\n# Example 4\r\ndsk = {'a': 1, 'b': (tuple, [['a']])}\r\nprint(dask.get(dsk, 'b'))\r\n# Out: ([1],) --> OK, so still interpolating 'a' to 1\r\n\r\n# Example 5\r\ndsk = {'a': 1, 'b': (tuple, {'a'})}\r\nprint(dask.get(dsk, 'b'))\r\n# Out: ('a',) --> Confused, why is this not interpolating 'a'?\r\n\r\n# Example 6\r\ndsk = {'a': 1, 'b': {'a': 'c'} }\r\nprint(dask.get(dsk, 'b'))\r\n# Out: {'a': 'c'} --> OK, so no interpolation of 'a' here\r\n\r\n# Example 7\r\ndsk = {'a': 1, 'b': {'c': 'a'}}\r\nprint(dask.get(dsk, 'b'))\r\n# KeyError --> I would expect no interpolation here, but throws KeyError.\r\n```\r\n\r\nCC @floriango @zgornel",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/3523/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/3523/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}