{
    "url": "https://api.github.com/repos/dask/dask/issues/10464",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/10464/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/10464/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/10464/events",
    "html_url": "https://github.com/dask/dask/issues/10464",
    "id": 1866790321,
    "node_id": "I_kwDOAbcwm85vRPWx",
    "number": 10464,
    "title": "pandas will raise for GroupBy.idxmax starting in 3.0 with all NA values",
    "user": {
        "login": "phofl",
        "id": 61934744,
        "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
        "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/phofl",
        "html_url": "https://github.com/phofl",
        "followers_url": "https://api.github.com/users/phofl/followers",
        "following_url": "https://api.github.com/users/phofl/following{/other_user}",
        "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
        "organizations_url": "https://api.github.com/users/phofl/orgs",
        "repos_url": "https://api.github.com/users/phofl/repos",
        "events_url": "https://api.github.com/users/phofl/events{/privacy}",
        "received_events_url": "https://api.github.com/users/phofl/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862289,
            "node_id": "MDU6TGFiZWwyNDI4NjIyODk=",
            "url": "https://api.github.com/repos/dask/dask/labels/dataframe",
            "name": "dataframe",
            "color": "fbca04",
            "default": false,
            "description": null
        },
        {
            "id": 3468123446,
            "node_id": "LA_kwDOAbcwm87Ot102",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20attention",
            "name": "needs attention",
            "color": "6d626c",
            "default": false,
            "description": "It's been a while since this was pushed on. Needs attention from the owner or a maintainer."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2023-08-25T10:28:27Z",
    "updated_at": "2024-01-15T01:48:46Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "<!-- Please include a self-contained copy-pastable example that generates the issue if possible.\r\n\r\nPlease be concise with code posted. See guidelines below on how to provide a good bug report:\r\n\r\n- Craft Minimal Bug Reports http://matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports\r\n- Minimal Complete Verifiable Examples https://stackoverflow.com/help/mcve\r\n\r\nBug reports that follow these guidelines are easier to diagnose, and so are often handled much more quickly.\r\n-->\r\n\r\n**Describe the issue**:\r\n\r\nWe compute the idxmax per partition and then do an aggregation. This is problematic if one partition is all NA but not the whole column. We have to address this somehow.\r\n\r\n**Minimal Complete Verifiable Example**:\r\n\r\n```python\r\npdf = pd.DataFrame({\"a\": 1, \"b\": [np.nan, np.nan, 2, 3]})\r\ndf = dd.from_pandas(pdf, npartitions=2)\r\ndf.groupby(\"a\").idxmax(skipna=False).compute()\r\n```\r\n\r\nThis shouldn't raise a warning but does at the moment\r\n\r\ncc @jrbourbeau \r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n\r\n- Dask version: main\r\n- Python version: 3.11\r\n- Operating System: Mac\r\n- Install method (conda, pip, source): condo\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/10464/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/10464/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}