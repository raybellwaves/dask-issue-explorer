[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1286960173",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1286960173",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1286960173,
        "node_id": "IC_kwDOAbcwm85MtXQt",
        "user": {
            "login": "phobson",
            "id": 1163939,
            "node_id": "MDQ6VXNlcjExNjM5Mzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1163939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phobson",
            "html_url": "https://github.com/phobson",
            "followers_url": "https://api.github.com/users/phobson/followers",
            "following_url": "https://api.github.com/users/phobson/following{/other_user}",
            "gists_url": "https://api.github.com/users/phobson/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phobson/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phobson/subscriptions",
            "organizations_url": "https://api.github.com/users/phobson/orgs",
            "repos_url": "https://api.github.com/users/phobson/repos",
            "events_url": "https://api.github.com/users/phobson/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phobson/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-21T13:26:27Z",
        "updated_at": "2022-10-21T13:26:27Z",
        "author_association": "MEMBER",
        "body": "Thanks for the clear demonstration of the issue. \r\n\r\nIs \"phone\" your parquet dataset in this case, or is it a directory of different parquet datasets that happen to have the same structure?\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1286960173/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1287222378",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1287222378",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1287222378,
        "node_id": "IC_kwDOAbcwm85MuXRq",
        "user": {
            "login": "selvavm",
            "id": 16543422,
            "node_id": "MDQ6VXNlcjE2NTQzNDIy",
            "avatar_url": "https://avatars.githubusercontent.com/u/16543422?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/selvavm",
            "html_url": "https://github.com/selvavm",
            "followers_url": "https://api.github.com/users/selvavm/followers",
            "following_url": "https://api.github.com/users/selvavm/following{/other_user}",
            "gists_url": "https://api.github.com/users/selvavm/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/selvavm/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/selvavm/subscriptions",
            "organizations_url": "https://api.github.com/users/selvavm/orgs",
            "repos_url": "https://api.github.com/users/selvavm/repos",
            "events_url": "https://api.github.com/users/selvavm/events{/privacy}",
            "received_events_url": "https://api.github.com/users/selvavm/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-21T17:01:20Z",
        "updated_at": "2022-10-21T17:01:20Z",
        "author_association": "NONE",
        "body": "Hi @phobson. Thanks for the response. Below is the structure of my dataset. Is this helpful?\r\n\r\n```\r\nparquet\r\n  |__ phone\r\n    |__ name=iphone5\r\n      |__ iphone.parquet\r\n    |__ name=iphone5s\r\n      |__ iphone5s.parquet\r\n    |__ name=iphone6\r\n      |__ iphone6.parquet\r\n\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1287222378/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1293068197",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1293068197",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1293068197,
        "node_id": "IC_kwDOAbcwm85NEqel",
        "user": {
            "login": "selvavm",
            "id": 16543422,
            "node_id": "MDQ6VXNlcjE2NTQzNDIy",
            "avatar_url": "https://avatars.githubusercontent.com/u/16543422?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/selvavm",
            "html_url": "https://github.com/selvavm",
            "followers_url": "https://api.github.com/users/selvavm/followers",
            "following_url": "https://api.github.com/users/selvavm/following{/other_user}",
            "gists_url": "https://api.github.com/users/selvavm/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/selvavm/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/selvavm/subscriptions",
            "organizations_url": "https://api.github.com/users/selvavm/orgs",
            "repos_url": "https://api.github.com/users/selvavm/repos",
            "events_url": "https://api.github.com/users/selvavm/events{/privacy}",
            "received_events_url": "https://api.github.com/users/selvavm/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-27T06:45:53Z",
        "updated_at": "2022-10-27T06:45:53Z",
        "author_association": "NONE",
        "body": "Hi @phobson - May I know if my details are enough? ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1293068197/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1294195892",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1294195892",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1294195892,
        "node_id": "IC_kwDOAbcwm85NI9y0",
        "user": {
            "login": "phobson",
            "id": 1163939,
            "node_id": "MDQ6VXNlcjExNjM5Mzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1163939?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phobson",
            "html_url": "https://github.com/phobson",
            "followers_url": "https://api.github.com/users/phobson/followers",
            "following_url": "https://api.github.com/users/phobson/following{/other_user}",
            "gists_url": "https://api.github.com/users/phobson/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phobson/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phobson/subscriptions",
            "organizations_url": "https://api.github.com/users/phobson/orgs",
            "repos_url": "https://api.github.com/users/phobson/repos",
            "events_url": "https://api.github.com/users/phobson/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phobson/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-27T22:34:20Z",
        "updated_at": "2022-10-27T22:34:20Z",
        "author_association": "MEMBER",
        "body": "@selvavm hey there -- that info helps. I haven't had a change to look at this yet. If you have time to build a small dataset and code to write the parquet files that reproduces the situation, that'll help me out a bit.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1294195892/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1294665836",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1294665836",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1294665836,
        "node_id": "IC_kwDOAbcwm85NKwhs",
        "user": {
            "login": "selvavm",
            "id": 16543422,
            "node_id": "MDQ6VXNlcjE2NTQzNDIy",
            "avatar_url": "https://avatars.githubusercontent.com/u/16543422?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/selvavm",
            "html_url": "https://github.com/selvavm",
            "followers_url": "https://api.github.com/users/selvavm/followers",
            "following_url": "https://api.github.com/users/selvavm/following{/other_user}",
            "gists_url": "https://api.github.com/users/selvavm/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/selvavm/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/selvavm/subscriptions",
            "organizations_url": "https://api.github.com/users/selvavm/orgs",
            "repos_url": "https://api.github.com/users/selvavm/repos",
            "events_url": "https://api.github.com/users/selvavm/events{/privacy}",
            "received_events_url": "https://api.github.com/users/selvavm/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-10-28T08:14:47Z",
        "updated_at": "2022-10-28T08:14:47Z",
        "author_association": "NONE",
        "body": "Hi @phobson \r\n\r\nI tried to create a sample dataset which resembles (closely) my dataset.\r\n```python\r\nimport numpy as np\r\nimport pandas as pd \r\nimport dask.dataframe as dd\r\ndf = pd.DataFrame(np.random.randint(0,1000, size=(300000000,8)))\r\ns_arr = pd.Series(pd.util.testing.rands_array(5, 20000)).repeat(15000).astype('string').to_numpy()\r\ndf['name'] = s_arr\r\ndf.set_index('name', inplace=True)\r\ndf.to_parquet('az:\\\\mycontainer\\\\parquet\\\\', partition_cols=['name'])\r\n\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1294665836/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1299300492",
        "html_url": "https://github.com/dask/dask/issues/9586#issuecomment-1299300492",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/9586",
        "id": 1299300492,
        "node_id": "IC_kwDOAbcwm85NccCM",
        "user": {
            "login": "rjzamora",
            "id": 20461013,
            "node_id": "MDQ6VXNlcjIwNDYxMDEz",
            "avatar_url": "https://avatars.githubusercontent.com/u/20461013?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rjzamora",
            "html_url": "https://github.com/rjzamora",
            "followers_url": "https://api.github.com/users/rjzamora/followers",
            "following_url": "https://api.github.com/users/rjzamora/following{/other_user}",
            "gists_url": "https://api.github.com/users/rjzamora/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rjzamora/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rjzamora/subscriptions",
            "organizations_url": "https://api.github.com/users/rjzamora/orgs",
            "repos_url": "https://api.github.com/users/rjzamora/repos",
            "events_url": "https://api.github.com/users/rjzamora/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rjzamora/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-11-01T22:18:05Z",
        "updated_at": "2022-11-01T22:18:05Z",
        "author_association": "MEMBER",
        "body": "@selvavm - Curious if filesystem/metadata parsing goes any faster in pure pyarrow code:\r\n\r\n```python\r\nimport pyarrow.dataset as ds\r\nimport fsspec\r\n\r\nfs = fsspec.core.get_fs_token_paths(\r\n    \"az://parquet/phone\",\r\n    storage_options=...,\r\n)[0]\r\ndataset = ds.dataset(\r\n    \"parquet/phone\",\r\n    filesystem=fs,\r\n    partitioning=\"hive\",\r\n    format=\"parquet\",\r\n)\r\nparts = list(dataset.get_fragments())\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1299300492/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]