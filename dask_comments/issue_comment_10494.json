[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1729184242",
        "html_url": "https://github.com/dask/dask/issues/10494#issuecomment-1729184242",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10494",
        "id": 1729184242,
        "node_id": "IC_kwDOAbcwm85nEUHy",
        "user": {
            "login": "shezadkhan137",
            "id": 1761188,
            "node_id": "MDQ6VXNlcjE3NjExODg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1761188?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/shezadkhan137",
            "html_url": "https://github.com/shezadkhan137",
            "followers_url": "https://api.github.com/users/shezadkhan137/followers",
            "following_url": "https://api.github.com/users/shezadkhan137/following{/other_user}",
            "gists_url": "https://api.github.com/users/shezadkhan137/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/shezadkhan137/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/shezadkhan137/subscriptions",
            "organizations_url": "https://api.github.com/users/shezadkhan137/orgs",
            "repos_url": "https://api.github.com/users/shezadkhan137/repos",
            "events_url": "https://api.github.com/users/shezadkhan137/events{/privacy}",
            "received_events_url": "https://api.github.com/users/shezadkhan137/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-21T09:16:56Z",
        "updated_at": "2023-09-21T09:19:05Z",
        "author_association": "NONE",
        "body": "I just ran into this issue when using `map_partitions`. Any dtype=object column in a pd.DataFrame returned from `map_partitions` are casted to a string, making it impossible have a DataFrame column that contains lists, np.arrays etc\r\n\r\nIt doesn't seem to be anything to do with [db-dtypes](https://pypi.org/project/db-dtypes/). I can reproduce by installing **any** dask version >= [2023.7.1](https://github.com/dask/dask/compare/2023.7.0...2023.7.1), along with pandas >= 2.0. \r\n\r\nIt looks like its related to automatically converting the dtype=object to a pyarrow string type.  Specifically the [is_object_string_dtype](https://github.com/dask/dask/compare/2023.7.0...2023.7.1#diff-b7e83c2b55f86ffb06a4d3d088527f622b2de52899f30ebdec134789150b26acR29-R36) returns true for any object dtype, which then later on the [code tries to cast to a string](https://github.com/dask/dask/compare/2023.7.0...2023.7.1#diff-b7e83c2b55f86ffb06a4d3d088527f622b2de52899f30ebdec134789150b26acR76).\r\n\r\nA workaround seems to be to switch of automatic pyarrow string casting with:\r\n\r\n``` \r\ndask.config.set({\"dataframe.convert-string\": False})\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1729184242/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1729188244",
        "html_url": "https://github.com/dask/dask/issues/10494#issuecomment-1729188244",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10494",
        "id": 1729188244,
        "node_id": "IC_kwDOAbcwm85nEVGU",
        "user": {
            "login": "phofl",
            "id": 61934744,
            "node_id": "MDQ6VXNlcjYxOTM0NzQ0",
            "avatar_url": "https://avatars.githubusercontent.com/u/61934744?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/phofl",
            "html_url": "https://github.com/phofl",
            "followers_url": "https://api.github.com/users/phofl/followers",
            "following_url": "https://api.github.com/users/phofl/following{/other_user}",
            "gists_url": "https://api.github.com/users/phofl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/phofl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phofl/subscriptions",
            "organizations_url": "https://api.github.com/users/phofl/orgs",
            "repos_url": "https://api.github.com/users/phofl/repos",
            "events_url": "https://api.github.com/users/phofl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/phofl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-09-21T09:19:24Z",
        "updated_at": "2023-09-21T09:19:24Z",
        "author_association": "MEMBER",
        "body": "Yep we started converting object to string by default in 2023.07.1, you can turn this off through\r\n\r\n```\r\ndask.config.set({\"dataframe.convert-string\": False})\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1729188244/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]