{
    "url": "https://api.github.com/repos/dask/dask/issues/9373",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/9373/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/9373/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/9373/events",
    "html_url": "https://github.com/dask/dask/issues/9373",
    "id": 1335417784,
    "node_id": "I_kwDOAbcwm85PmNu4",
    "number": 9373,
    "title": "Hypothesis strategy for chunking arrays in different patterns",
    "user": {
        "login": "TomNicholas",
        "id": 35968931,
        "node_id": "MDQ6VXNlcjM1OTY4OTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/35968931?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TomNicholas",
        "html_url": "https://github.com/TomNicholas",
        "followers_url": "https://api.github.com/users/TomNicholas/followers",
        "following_url": "https://api.github.com/users/TomNicholas/following{/other_user}",
        "gists_url": "https://api.github.com/users/TomNicholas/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TomNicholas/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TomNicholas/subscriptions",
        "organizations_url": "https://api.github.com/users/TomNicholas/orgs",
        "repos_url": "https://api.github.com/users/TomNicholas/repos",
        "events_url": "https://api.github.com/users/TomNicholas/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TomNicholas/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 1887344368,
            "node_id": "MDU6TGFiZWwxODg3MzQ0MzY4",
            "url": "https://api.github.com/repos/dask/dask/labels/tests",
            "name": "tests",
            "color": "a0f9b4",
            "default": false,
            "description": "Unit tests and/or continuous integration"
        },
        {
            "id": 3468123446,
            "node_id": "LA_kwDOAbcwm87Ot102",
            "url": "https://api.github.com/repos/dask/dask/labels/needs%20attention",
            "name": "needs attention",
            "color": "6d626c",
            "default": false,
            "description": "It's been a while since this was pushed on. Needs attention from the owner or a maintainer."
        },
        {
            "id": 3798602129,
            "node_id": "LA_kwDOAbcwm87iahGR",
            "url": "https://api.github.com/repos/dask/dask/labels/enhancement",
            "name": "enhancement",
            "color": "C2E0C6",
            "default": true,
            "description": "Improve existing functionality or make things work better"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2022-08-11T03:14:12Z",
    "updated_at": "2022-09-12T02:15:17Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I often want to test some parallel dask code for input with a range of different chunking structures. This seems like a possible candidate for a general chunks strategy using the hypothesis library, that could live in `dask.array`.\r\n\r\nWe actually made a simple strategy to test various chunking structures in both [xhistogram here](https://github.com/xgcm/xhistogram/blob/0d3bf5ad9c118dccb211d30fc889963087c28dd4/xhistogram/test/test_chunking_hypotheses.py#L13) and in [rechunker here](https://github.com/pangeo-data/rechunker/blob/9d129321499a7b0be422fd159dff35e28db4cfac/tests/test_algorithm.py#L204), but now I'm wondering if there is a general solution I could implement. \r\n\r\nIt could be useful for users testing code that works with dask arrays, or perhaps it might even be useful for testing `dask.array` internally. It would also be really useful to use in xarray's tests.\r\n\r\n---\r\n\r\nDask's [rules for how they defines chunk shapes](https://docs.dask.org/en/stable/array-chunks.html#specifying-chunk-shapes) are:\r\n\r\n> We always specify a chunks argument to tell dask.array how to break up the underlying array into chunks. We can specify chunks in a variety of ways:\r\n>\r\n> 1. A uniform dimension size like `1000`, meaning chunks of size 1000 in each dimension\r\n> \r\n> 2. A uniform chunk shape like `(1000, 2000, 3000)`, meaning chunks of size 1000 in the first axis, 2000 in the second axis, and 3000 in the third\r\n>\r\n> 3. Fully explicit sizes of all blocks along all dimensions, like `((1000, 1000, 500), (400, 400), (5, 5, 5, 5, 5))`\r\n> \r\n> 4. A dictionary specifying chunk size per dimension like `{0: 1000, 1: 2000, 2: 3000}`. This is just another way of writing the forms 2 and 3 above\r\n\r\n5. Xarray adds [another way to specify chunks](https://docs.xarray.dev/en/stable/generated/xarray.DataArray.chunksizes.html), which is the same as (4) but with string dimension names instead of integer axis names. We distinguish that representation by referring to it as `.chunksizes` instead of just `.chunks`.\r\n\r\nI think the most generally useful form of chunk strategy should produce (3), which can then be wrapped up by the user to make (4) or (5) if desired.\r\n\r\nI'm imagining exposing this publicly under a name like `dask.array.strategies.chunks`.\r\n\r\n(Originally raised on the hypothesis repo, but it should probably live in dask instead. xref https://github.com/HypothesisWorks/hypothesis/issues/3433)",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/9373/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/9373/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}