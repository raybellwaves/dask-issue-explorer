[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1540054346",
        "html_url": "https://github.com/dask/dask/issues/10270#issuecomment-1540054346",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10270",
        "id": 1540054346,
        "node_id": "IC_kwDOAbcwm85by11K",
        "user": {
            "login": "fjetter",
            "id": 8629629,
            "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8629629?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjetter",
            "html_url": "https://github.com/fjetter",
            "followers_url": "https://api.github.com/users/fjetter/followers",
            "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
            "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
            "organizations_url": "https://api.github.com/users/fjetter/orgs",
            "repos_url": "https://api.github.com/users/fjetter/repos",
            "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fjetter/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-09T12:46:17Z",
        "updated_at": "2023-05-09T12:46:17Z",
        "author_association": "MEMBER",
        "body": "I strongly suspect, but haven't tested, that \r\n\r\nhttps://github.com/dask/dask/blob/e9845aadc7c32078e55354b61f5626ac759e8b28/dask/bytes/core.py#LL109C23-L109C27 \r\n\r\nis responsible.\r\n\r\nJust from reading code, this appears to be the only per-file remote call that is executed on the client. Apart from this being potentially inherently slow, I can also easily see us being rate limited while doing so (maybe this is hidden in retries or smth)\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1540054346/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1540322782",
        "html_url": "https://github.com/dask/dask/issues/10270#issuecomment-1540322782",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10270",
        "id": 1540322782,
        "node_id": "IC_kwDOAbcwm85bz3Xe",
        "user": {
            "login": "shughes-uk",
            "id": 546891,
            "node_id": "MDQ6VXNlcjU0Njg5MQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/546891?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/shughes-uk",
            "html_url": "https://github.com/shughes-uk",
            "followers_url": "https://api.github.com/users/shughes-uk/followers",
            "following_url": "https://api.github.com/users/shughes-uk/following{/other_user}",
            "gists_url": "https://api.github.com/users/shughes-uk/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/shughes-uk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/shughes-uk/subscriptions",
            "organizations_url": "https://api.github.com/users/shughes-uk/orgs",
            "repos_url": "https://api.github.com/users/shughes-uk/repos",
            "events_url": "https://api.github.com/users/shughes-uk/events{/privacy}",
            "received_events_url": "https://api.github.com/users/shughes-uk/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-09T15:03:37Z",
        "updated_at": "2023-05-09T15:03:37Z",
        "author_association": "CONTRIBUTOR",
        "body": "I did see that, but im setting blocksize=None so would not enter that code section i think?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1540322782/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1543680414",
        "html_url": "https://github.com/dask/dask/issues/10270#issuecomment-1543680414",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10270",
        "id": 1543680414,
        "node_id": "IC_kwDOAbcwm85cArGe",
        "user": {
            "login": "fjetter",
            "id": 8629629,
            "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8629629?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjetter",
            "html_url": "https://github.com/fjetter",
            "followers_url": "https://api.github.com/users/fjetter/followers",
            "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
            "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
            "organizations_url": "https://api.github.com/users/fjetter/orgs",
            "repos_url": "https://api.github.com/users/fjetter/repos",
            "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fjetter/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-11T09:44:15Z",
        "updated_at": "2023-05-11T09:44:15Z",
        "author_association": "MEMBER",
        "body": "I stumbled over https://github.com/dask/dask/issues/10275 that affects glob file patterns with the root cause being https://github.com/fsspec/filesystem_spec/issues/1261\r\n\r\nMaybe fsspec is taking a wrong turn in your example as well even though you are not using a globbing pattern. I recommend creating a profile once to see where we're loosing the time.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1543680414/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1543789686",
        "html_url": "https://github.com/dask/dask/issues/10270#issuecomment-1543789686",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/10270",
        "id": 1543789686,
        "node_id": "IC_kwDOAbcwm85cBFx2",
        "user": {
            "login": "milesgranger",
            "id": 13764397,
            "node_id": "MDQ6VXNlcjEzNzY0Mzk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/13764397?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/milesgranger",
            "html_url": "https://github.com/milesgranger",
            "followers_url": "https://api.github.com/users/milesgranger/followers",
            "following_url": "https://api.github.com/users/milesgranger/following{/other_user}",
            "gists_url": "https://api.github.com/users/milesgranger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/milesgranger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/milesgranger/subscriptions",
            "organizations_url": "https://api.github.com/users/milesgranger/orgs",
            "repos_url": "https://api.github.com/users/milesgranger/repos",
            "events_url": "https://api.github.com/users/milesgranger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/milesgranger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2023-05-11T11:03:34Z",
        "updated_at": "2023-05-11T11:07:37Z",
        "author_association": "MEMBER",
        "body": "@shughes-uk if possible, could you try setting `storage_options`? If you have a S3FileSystem you could reuse it:\r\n```python\r\ns3: S3FileSystem\r\ndd.read_csv(..., storage_options=s3.storage_options)\r\n```\r\n\r\nTrying various things out, I get a tremendous delay if I don't set that; which hints it's happening in `fsspec`'s [get_fs_token_paths](https://github.com/fsspec/filesystem_spec/blob/4953f476944fdbae9e4e0c70930d77c7df2cdd85/fsspec/core.py#L554) as @fjetter mentioned in that issue",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1543789686/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]