{
    "url": "https://api.github.com/repos/dask/dask/issues/2913",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/2913/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/2913/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/2913/events",
    "html_url": "https://github.com/dask/dask/issues/2913",
    "id": 275237955,
    "node_id": "MDU6SXNzdWUyNzUyMzc5NTU=",
    "number": 2913,
    "title": "Dask array arithmetic should defer to unrecognized classes",
    "user": {
        "login": "shoyer",
        "id": 1217238,
        "node_id": "MDQ6VXNlcjEyMTcyMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1217238?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shoyer",
        "html_url": "https://github.com/shoyer",
        "followers_url": "https://api.github.com/users/shoyer/followers",
        "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
        "organizations_url": "https://api.github.com/users/shoyer/orgs",
        "repos_url": "https://api.github.com/users/shoyer/repos",
        "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shoyer/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2017-11-20T05:01:05Z",
    "updated_at": "2017-11-22T20:21:51Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "This came up my discussion of `__matmul__` with @jakirkham in https://github.com/dask/dask/pull/2909.\r\n\r\nCurrently, dask array operations attempt to blindly convert everything into a dask arrays. This is great for NumPy arrays and numbers, but probably not a good idea for arbitrary objects.\r\n\r\nFor example: dask + xarray currently creates an dask object, but xarray + dask creates an xarray object:\r\n```\r\nIn [1]: import dask.array as da\r\n\r\nIn [3]: import xarray\r\n\r\nIn [2]: x = da.ones((3, 3), chunks=-1)\r\n\r\nIn [4]: y = xarray.DataArray(x, dims=['x', 'y'])\r\n\r\nIn [6]: x + y\r\nOut[6]: dask.array<add, shape=(3, 3), dtype=float64, chunksize=(3, 3)>\r\n\r\nIn [7]: y + x\r\nOut[7]:\r\n<xarray.DataArray 'wrapped-8015d128b19387281f3d8bd3a663300a' (x: 3, y: 3)>\r\ndask.array<shape=(3, 3), dtype=float64, chunksize=(3, 3)>\r\nDimensions without coordinates: x, y\r\n```\r\nIt would be better for dask to defer to xarray in all cases, since xarray knows about dask but dask doesn't know about xarray. This is easiest to do by adding a check for recognized types at the start of every binary operation, e.g.,\r\n```python\r\ndef __add__(self, other):\r\n    if not isinstance(other, RECOGNIZED_TYPES):\r\n        return NotImplemented\r\n    return do_add(self, other)\r\n```\r\nAs another example, I also wrote a version of this for [`__array_ufunc__`](https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.lib.mixins.NDArrayOperatorsMixin.html) using `numpy.lib.mixins.NDArrayOperatorsMixin`.",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/2913/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/2913/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}