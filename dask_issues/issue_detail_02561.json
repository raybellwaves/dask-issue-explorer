{
    "url": "https://api.github.com/repos/dask/dask/issues/2561",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/2561/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/2561/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/2561/events",
    "html_url": "https://github.com/dask/dask/issues/2561",
    "id": 245773138,
    "node_id": "MDU6SXNzdWUyNDU3NzMxMzg=",
    "number": 2561,
    "title": "Reshaping trivial dimensions with non-trivial chunks fails",
    "user": {
        "login": "jakirkham",
        "id": 3019665,
        "node_id": "MDQ6VXNlcjMwMTk2NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jakirkham",
        "html_url": "https://github.com/jakirkham",
        "followers_url": "https://api.github.com/users/jakirkham/followers",
        "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
        "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
        "organizations_url": "https://api.github.com/users/jakirkham/orgs",
        "repos_url": "https://api.github.com/users/jakirkham/repos",
        "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jakirkham/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2017-07-26T16:03:19Z",
    "updated_at": "2019-05-13T14:29:11Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "When trying to use `reshape` on a Dask Array with some trivial (i.e. `0`-length) dimensions and non-trivial chunks (i.e. multiple chunks) along non-trivial dimensions, the `reshape` operation fails. This differs from NumPy in the same situation. It seems to have something to do with how rechunking occurs as a consequence of reshaping. An example is provided in the code snippet below along with environment details.\r\n\r\nCode snippet:\r\n\r\n<details>\r\n\r\n```python\r\nIn [1]: import numpy as np\r\n\r\nIn [2]: import dask.array as da\r\n\r\nIn [3]: a = np.ones((2, 0, 0))\r\n\r\nIn [4]: d = da.from_array(a, (1, 0, 0))\r\n\r\nIn [5]: a.reshape((len(a), -1))\r\nOut[5]: array([], shape=(2, 0), dtype=float64)\r\n\r\nIn [6]: d.reshape((len(d), -1))\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-6-4a136cd07540> in <module>()\r\n----> 1 d.reshape((len(d), -1))\r\n\r\n/zopt/conda2/envs/test/lib/python2.7/site-packages/dask/array/core.pyc in reshape(self, *shape)\r\n   1299         if len(shape) == 1 and not isinstance(shape[0], Number):\r\n   1300             shape = shape[0]\r\n-> 1301         return reshape(self, shape)\r\n   1302 \r\n   1303     @wraps(topk)\r\n\r\n/zopt/conda2/envs/test/lib/python2.7/site-packages/dask/array/reshape.pyc in reshape(x, shape)\r\n    178 \r\n    179     # Logic for how to rechunk\r\n--> 180     inchunks, outchunks = reshape_rechunk(x.shape, shape, x.chunks)\r\n    181     x2 = x.rechunk(inchunks)\r\n    182 \r\n\r\n/zopt/conda2/envs/test/lib/python2.7/site-packages/dask/array/reshape.pyc in reshape_rechunk(inshape, outshape, inchunks)\r\n     40             while ileft >= 0 and reduce(mul, inshape[ileft:ii + 1]) < dout: # 4 < 64, 4*4 < 64, 4*4*4 == 64\r\n     41                 ileft -= 1\r\n---> 42             if reduce(mul, inshape[ileft:ii + 1]) != dout:\r\n     43                 raise ValueError(\"Shapes not compatible\")\r\n     44 \r\n\r\nTypeError: reduce() of empty sequence with no initial value\r\n```\r\n\r\n</details>\r\n\r\n<br>\r\nEnvironment:\r\n<br>\r\n<br>\r\n\r\n<details>\r\n\r\n```yaml\r\nname: test\r\nchannels:\r\n- conda-forge\r\n- defaults\r\ndependencies:\r\n- appnope=0.1.0=py27_0\r\n- asn1crypto=0.22.0=py27_0\r\n- backports.shutil_get_terminal_size=1.0.0=py27_1\r\n- backports_abc=0.5=py27_0\r\n- bkcharts=0.2=py27_0\r\n- blas=1.1=openblas\r\n- bokeh=0.12.6=py27_0\r\n- ca-certificates=2017.4.17=0\r\n- certifi=2017.4.17=py27_0\r\n- cffi=1.10.0=py27_0\r\n- chardet=3.0.2=py27_1\r\n- click=6.7=py27_0\r\n- cloudpickle=0.3.1=py27_0\r\n- cryptography=1.9=py27_0\r\n- cycler=0.10.0=py27_0\r\n- dask=0.15.1=py27_0\r\n- decorator=4.1.2=py27_0\r\n- distributed=1.18.0=py27_0\r\n- enum34=1.1.6=py27_1\r\n- freetype=2.7=1\r\n- functools32=3.2.3.2=py27_1\r\n- futures=3.0.5=py27_0\r\n- heapdict=1.0.0=py27_0\r\n- idna=2.5=py27_0\r\n- ipaddress=1.0.18=py27_0\r\n- ipython=5.4.1=py27_0\r\n- ipython_genutils=0.2.0=py27_0\r\n- jinja2=2.9.5=py27_0\r\n- libffi=3.2.1=3\r\n- libgfortran=3.0.0=0\r\n- libpng=1.6.28=0\r\n- locket=0.2.0=py27_1\r\n- markupsafe=1.0=py27_0\r\n- matplotlib=2.0.2=np113py27_0\r\n- msgpack-python=0.4.8=py27_0\r\n- ncurses=5.9=10\r\n- numpy=1.13.1=py27_blas_openblas_201\r\n- openblas=0.2.20=1\r\n- openssl=1.0.2l=0\r\n- pandas=0.20.3=py27_1\r\n- partd=0.3.8=py27_0\r\n- pathlib2=2.3.0=py27_0\r\n- pexpect=4.2.1=py27_0\r\n- pickleshare=0.7.3=py27_0\r\n- pip=9.0.1=py27_0\r\n- prompt_toolkit=1.0.14=py27_0\r\n- psutil=5.2.1=py27_0\r\n- ptyprocess=0.5.2=py27_0\r\n- pycparser=2.18=py27_0\r\n- pygments=2.2.0=py27_0\r\n- pyopenssl=16.2.0=py27_0\r\n- pyparsing=2.2.0=py27_0\r\n- pysocks=1.6.7=py27_0\r\n- python=2.7.13=1\r\n- python-dateutil=2.6.1=py27_0\r\n- pytz=2017.2=py27_0\r\n- pyyaml=3.12=py27_1\r\n- readline=6.2=0\r\n- requests=2.18.2=py27_0\r\n- scandir=1.5=py27_1\r\n- setuptools=36.2.2=py27_0\r\n- simplegeneric=0.8.1=py27_0\r\n- singledispatch=3.4.0.3=py27_0\r\n- six=1.10.0=py27_1\r\n- sortedcontainers=1.5.3=py27_0\r\n- sqlite=3.13.0=1\r\n- ssl_match_hostname=3.5.0.1=py27_1\r\n- subprocess32=3.2.7=py27_0\r\n- tblib=1.3.2=py27_0\r\n- tk=8.5.19=1\r\n- toolz=0.8.2=py27_0\r\n- tornado=4.5.1=py27_0\r\n- traitlets=4.3.2=py27_0\r\n- urllib3=1.21.1=py27_1\r\n- wcwidth=0.1.7=py27_0\r\n- wheel=0.29.0=py27_0\r\n- yaml=0.1.6=0\r\n- zict=0.1.2=py27_0\r\n- zlib=1.2.11=0\r\n- pip:\r\n  - backports-abc==0.5\r\n  - backports.shutil-get-terminal-size==1.0.0\r\n  - backports.ssl-match-hostname==3.5.0.1\r\n  - ipython-genutils==0.2.0\r\n  - prompt-toolkit==1.0.14\r\n```\r\n\r\n</details>",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/2561/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/2561/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}