{
    "url": "https://api.github.com/repos/dask/dask/issues/4626",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/4626/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/4626/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/4626/events",
    "html_url": "https://github.com/dask/dask/issues/4626",
    "id": 424447567,
    "node_id": "MDU6SXNzdWU0MjQ0NDc1Njc=",
    "number": 4626,
    "title": "Add method to optimize collection and return HighLevelGraph",
    "user": {
        "login": "jakirkham",
        "id": 3019665,
        "node_id": "MDQ6VXNlcjMwMTk2NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3019665?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jakirkham",
        "html_url": "https://github.com/jakirkham",
        "followers_url": "https://api.github.com/users/jakirkham/followers",
        "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
        "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
        "organizations_url": "https://api.github.com/users/jakirkham/orgs",
        "repos_url": "https://api.github.com/users/jakirkham/repos",
        "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jakirkham/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2156573524,
            "node_id": "MDU6TGFiZWwyMTU2NTczNTI0",
            "url": "https://api.github.com/repos/dask/dask/labels/highlevelgraph",
            "name": "highlevelgraph",
            "color": "8c24d6",
            "default": false,
            "description": "Issues relating to HighLevelGraphs."
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-03-23T01:12:23Z",
    "updated_at": "2021-10-12T08:43:43Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "It appears that when using `__dask_optimize__` it returns raw dicts. However the expectation has become `HighLevelGraph`s should be used instead. To meet that expectation, it would be nice if the `__dask_optimize__` functions also met this need. Here's an example with `Delayed` below, but can see similar things with the other collections.\r\n\r\n<details>\r\n<summary>Example:</summary>\r\n\r\n```python\r\nIn [1]: from dask.delayed import Delayed, delayed                               \r\n\r\nIn [2]: d = delayed(sum)([2])                                                   \r\n\r\nIn [3]: Delayed.__dask_optimize__(d.__dask_graph__(), d.__dask_keys__())        \r\nOut[3]: \r\n{'sum-aa5d6384-422a-4372-ada2-9753cf8efe31': (<function sum(iterable, start=0, /)>,\r\n  [2])}\r\n```\r\n\r\n</details>\r\n\r\n<br>\r\n\r\n<details>\r\n<summary>Environment:</summary>\r\n\r\n```yaml\r\nname: dask\r\nchannels:\r\n  - conda-forge\r\n  - defaults\r\ndependencies:\r\n  - appnope=0.1.0=py37_1000\r\n  - backcall=0.1.0=py_0\r\n  - blas=2.4=openblas\r\n  - bokeh=1.0.4=py37_1000\r\n  - bzip2=1.0.6=h1de35cc_1002\r\n  - ca-certificates=2019.3.9=hecc5488_0\r\n  - certifi=2019.3.9=py37_0\r\n  - click=7.0=py_0\r\n  - cloudpickle=0.8.0=py_0\r\n  - cytoolz=0.9.0.1=py37h470a237_1\r\n  - dask=1.1.4=py_0\r\n  - dask-core=1.1.4=py_0\r\n  - decorator=4.4.0=py_0\r\n  - distributed=1.26.0=py37_1\r\n  - freetype=2.10.0=h24853df_0\r\n  - heapdict=1.0.0=py37_1000\r\n  - ipython=7.4.0=py37h24bf2e0_0\r\n  - ipython_genutils=0.2.0=py_1\r\n  - jedi=0.13.3=py37_0\r\n  - jinja2=2.10=py_1\r\n  - jpeg=9c=h1de35cc_1001\r\n  - libblas=3.8.0=4_openblas\r\n  - libcblas=3.8.0=4_openblas\r\n  - libcxx=4.0.1=h579ed51_0\r\n  - libcxxabi=4.0.1=hebd6815_0\r\n  - libffi=3.2.1=h6de7cb9_1006\r\n  - libgfortran=3.0.1=0\r\n  - liblapack=3.8.0=4_openblas\r\n  - liblapacke=3.8.0=4_openblas\r\n  - libpng=1.6.36=ha441bb4_1000\r\n  - libtiff=4.0.10=h79f4b77_1001\r\n  - locket=0.2.0=py_2\r\n  - markupsafe=1.1.1=py37h1de35cc_0\r\n  - msgpack-python=0.6.1=py37h04f5b5a_0\r\n  - ncurses=6.1=h0a44026_1002\r\n  - numpy=1.16.2=py37hbb3c62a_1\r\n  - olefile=0.46=py_0\r\n  - openblas=0.3.5=h436c29b_1001\r\n  - openssl=1.1.1b=h01d97ff_2\r\n  - packaging=19.0=py_0\r\n  - pandas=0.24.2=py37h0a44026_0\r\n  - parso=0.3.4=py_0\r\n  - partd=0.3.9=py_0\r\n  - pexpect=4.6.0=py37_1000\r\n  - pickleshare=0.7.5=py37_1000\r\n  - pillow=5.4.1=py37hbddbef0_1000\r\n  - pip=19.0.3=py37_0\r\n  - prompt_toolkit=2.0.9=py_0\r\n  - psutil=5.6.1=py37h1de35cc_0\r\n  - ptyprocess=0.6.0=py37_1000\r\n  - pygments=2.3.1=py_0\r\n  - pyparsing=2.3.1=py_0\r\n  - python=3.7.2=hbdd33cc_0\r\n  - python-dateutil=2.8.0=py_0\r\n  - pytz=2018.9=py_0\r\n  - pyyaml=5.1=py37h1de35cc_0\r\n  - readline=7.0=hcfe32e1_1001\r\n  - scipy=1.2.1=py37hbd7caa9_1\r\n  - setuptools=40.8.0=py37_0\r\n  - six=1.12.0=py37_1000\r\n  - sortedcontainers=2.1.0=py_0\r\n  - sqlite=3.26.0=h1765d9f_1001\r\n  - tblib=1.3.2=py_1\r\n  - tk=8.6.9=ha441bb4_1000\r\n  - toolz=0.9.0=py_1\r\n  - tornado=6.0.1=py37h1de35cc_0\r\n  - traitlets=4.3.2=py37_1000\r\n  - wcwidth=0.1.7=py_1\r\n  - wheel=0.33.1=py37_0\r\n  - xz=5.2.4=h1de35cc_1001\r\n  - yaml=0.1.7=h1de35cc_1001\r\n  - zict=0.1.4=py_0\r\n  - zlib=1.2.11=h1de35cc_1004\r\n```\r\n\r\n</details>",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/4626/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/4626/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}