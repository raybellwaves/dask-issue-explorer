[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1005767578",
        "html_url": "https://github.com/dask/dask/issues/8528#issuecomment-1005767578",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8528",
        "id": 1005767578,
        "node_id": "IC_kwDOAbcwm8478sua",
        "user": {
            "login": "quasiben",
            "id": 1403768,
            "node_id": "MDQ6VXNlcjE0MDM3Njg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1403768?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/quasiben",
            "html_url": "https://github.com/quasiben",
            "followers_url": "https://api.github.com/users/quasiben/followers",
            "following_url": "https://api.github.com/users/quasiben/following{/other_user}",
            "gists_url": "https://api.github.com/users/quasiben/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/quasiben/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/quasiben/subscriptions",
            "organizations_url": "https://api.github.com/users/quasiben/orgs",
            "repos_url": "https://api.github.com/users/quasiben/repos",
            "events_url": "https://api.github.com/users/quasiben/events{/privacy}",
            "received_events_url": "https://api.github.com/users/quasiben/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-01-05T15:08:11Z",
        "updated_at": "2022-01-05T15:08:11Z",
        "author_association": "MEMBER",
        "body": "It looks like in `make_df` that returned dataframes can be ordered in three different ways, is that correct ?  Does column ordering change when doing read_orc columns ?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1005767578/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1005978392",
        "html_url": "https://github.com/dask/dask/issues/8528#issuecomment-1005978392",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8528",
        "id": 1005978392,
        "node_id": "IC_kwDOAbcwm8479gMY",
        "user": {
            "login": "mlahir1",
            "id": 24844705,
            "node_id": "MDQ6VXNlcjI0ODQ0NzA1",
            "avatar_url": "https://avatars.githubusercontent.com/u/24844705?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mlahir1",
            "html_url": "https://github.com/mlahir1",
            "followers_url": "https://api.github.com/users/mlahir1/followers",
            "following_url": "https://api.github.com/users/mlahir1/following{/other_user}",
            "gists_url": "https://api.github.com/users/mlahir1/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mlahir1/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mlahir1/subscriptions",
            "organizations_url": "https://api.github.com/users/mlahir1/orgs",
            "repos_url": "https://api.github.com/users/mlahir1/repos",
            "events_url": "https://api.github.com/users/mlahir1/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mlahir1/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-01-05T18:33:39Z",
        "updated_at": "2022-01-05T18:33:39Z",
        "author_association": "NONE",
        "body": "column re-ordeing doesn't change with read_orc. let me provide a different example to make my case clear.\r\n```\r\nimport cudf\r\nimport numpy as np\r\nfrom dask.dataframe import from_delayed\r\nfrom dask.delayed import delayed\r\nimport numpy as np\r\nimport cudf\r\nfrom dask.distributed import Client\r\nfrom dask_cuda import LocalCUDACluster\r\nimport dask_cudf\r\n\r\ndf = cudf.DataFrame()\r\nfor i in range(100):\r\n    df[f'_col{i}'] = np.random.randint(20, size=100)\r\n    \r\ndf.to_orc('test1.orc')\r\ndf.to_orc('test0.orc')\r\n\r\nfiles = [(('a',), 'test0.orc'), (('a',), 'test1.orc')]\r\nprint(files)\r\n\r\n\r\ndef rd(f, cols, meta=None):\r\n    if partitions:\r\n        cols = list(set(cols) - set([x[0] for x in partitions]))\r\n    if type(f).__name__ == 'str':\r\n        f = ((), f)\r\n    df = cudf.read_orc(f[1], columns=cols,  use_index=False)\r\n    if partitions:\r\n        for i, col in enumerate(partitions):\r\n            df[col[0]] = f[0][i]\r\n            df[col[0]] = df[col[0]].astype(col[1])\r\n    if meta:\r\n        return df[list(meta.keys())]\r\n    else:\r\n        return df\r\n\r\n\r\npartitions =[('visit_date', 'str')]\r\ncols = ['_col0', '_col12', '_col10', '_col5']\r\nmeta = dict(rd(files[0], cols, meta=None).dtypes)\r\nfor i in partitions:\r\n    meta[i[0]] = i[1]\r\n    \r\ndef main():\r\n    c=Client(LocalCUDACluster())\r\n    dfs=[delayed(rd)(f, cols=cols) for f in files[:2]]\r\n    xx = dask_cudf.from_delayed(dfs)\r\n    print(xx.compute())\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\nColumns: [_col10, _col5, _col12, _col0, visit_date]\r\nIndex: [], 'from_delayed')\r\nkwargs:    {}\r\nException: \"ValueError('The columns in the computed data do not match the columns in the provided metadata\\\\nOrder of columns does not match')\"\r\n```\r\nbut in the same above case if i pass partitions as [] (empty lits) things work as expected.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1005978392/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/1011259594",
        "html_url": "https://github.com/dask/dask/issues/8528#issuecomment-1011259594",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8528",
        "id": 1011259594,
        "node_id": "IC_kwDOAbcwm848RpjK",
        "user": {
            "login": "scharlottej13",
            "id": 8620816,
            "node_id": "MDQ6VXNlcjg2MjA4MTY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8620816?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scharlottej13",
            "html_url": "https://github.com/scharlottej13",
            "followers_url": "https://api.github.com/users/scharlottej13/followers",
            "following_url": "https://api.github.com/users/scharlottej13/following{/other_user}",
            "gists_url": "https://api.github.com/users/scharlottej13/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scharlottej13/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scharlottej13/subscriptions",
            "organizations_url": "https://api.github.com/users/scharlottej13/orgs",
            "repos_url": "https://api.github.com/users/scharlottej13/repos",
            "events_url": "https://api.github.com/users/scharlottej13/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scharlottej13/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-01-12T17:01:07Z",
        "updated_at": "2022-01-19T17:11:44Z",
        "author_association": "MEMBER",
        "body": "@quasiben do you know what the next steps for this would be? or @rjzamora would you be able to take a look?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/1011259594/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]