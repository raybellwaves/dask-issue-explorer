[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/684893037",
        "html_url": "https://github.com/dask/dask/issues/6538#issuecomment-684893037",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/6538",
        "id": 684893037,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY4NDg5MzAzNw==",
        "user": {
            "login": "TomAugspurger",
            "id": 1312546,
            "node_id": "MDQ6VXNlcjEzMTI1NDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1312546?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TomAugspurger",
            "html_url": "https://github.com/TomAugspurger",
            "followers_url": "https://api.github.com/users/TomAugspurger/followers",
            "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
            "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
            "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
            "repos_url": "https://api.github.com/users/TomAugspurger/repos",
            "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
            "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-09-01T14:24:14Z",
        "updated_at": "2020-09-01T14:24:14Z",
        "author_association": "MEMBER",
        "body": "Sorry for the delay @goodwanghan. The issue is that the `meta` you provided to the groupby apply isn't fully correct. The tuple shorthand doesn't correctly describe the (multi)-index, and the downstream join can't work as a result.\r\n\r\n\r\n```python\r\nIn [73]: idx = pd.MultiIndex.from_arrays([np.array([], dtype='int64'), np.array([], dtype='int64')], names=['a', 'b'])\r\n\r\nIn [74]: meta = pd.Series([], name=\"x\", dtype=\"int64\", index=idx)\r\n\r\nIn [75]: s1=df.groupby([\"a\",\"b\"])[\"c\"].apply(lambda x:x.drop_duplicates().sum(), meta=meta)\r\n\r\nIn [76]: df.merge(s1.to_frame(), \"outer\", left_on=[\"a\",\"b\"], right_index=True).compute()\r\nOut[76]:\r\n   a  b  c   x\r\n0  0  1  4 NaN\r\n1  0  1  5 NaN\r\n2  2  3  6 NaN\r\n```\r\n\r\nAny suggestions for how this could be improved?",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/684893037/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]