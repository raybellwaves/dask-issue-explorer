{
    "url": "https://api.github.com/repos/dask/dask/issues/8474",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/8474/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/8474/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/8474/events",
    "html_url": "https://github.com/dask/dask/issues/8474",
    "id": 1077294726,
    "node_id": "I_kwDOAbcwm85ANjaG",
    "number": 8474,
    "title": "Cross-scheduler inconsistent result structure",
    "user": {
        "login": "davidhao3300",
        "id": 5534398,
        "node_id": "MDQ6VXNlcjU1MzQzOTg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5534398?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidhao3300",
        "html_url": "https://github.com/davidhao3300",
        "followers_url": "https://api.github.com/users/davidhao3300/followers",
        "following_url": "https://api.github.com/users/davidhao3300/following{/other_user}",
        "gists_url": "https://api.github.com/users/davidhao3300/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/davidhao3300/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/davidhao3300/subscriptions",
        "organizations_url": "https://api.github.com/users/davidhao3300/orgs",
        "repos_url": "https://api.github.com/users/davidhao3300/repos",
        "events_url": "https://api.github.com/users/davidhao3300/events{/privacy}",
        "received_events_url": "https://api.github.com/users/davidhao3300/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 996497175,
            "node_id": "MDU6TGFiZWw5OTY0OTcxNzU=",
            "url": "https://api.github.com/repos/dask/dask/labels/good%20second%20issue",
            "name": "good second issue",
            "color": "5319e7",
            "default": false,
            "description": "Clearly described, educational, but less trivial than \"good first issue\"."
        },
        {
            "id": 1342304743,
            "node_id": "MDU6TGFiZWwxMzQyMzA0NzQz",
            "url": "https://api.github.com/repos/dask/dask/labels/core",
            "name": "core",
            "color": "000000",
            "default": false,
            "description": ""
        },
        {
            "id": 3798602129,
            "node_id": "LA_kwDOAbcwm87iahGR",
            "url": "https://api.github.com/repos/dask/dask/labels/enhancement",
            "name": "enhancement",
            "color": "C2E0C6",
            "default": true,
            "description": "Improve existing functionality or make things work better"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 11,
    "created_at": "2021-12-10T22:57:09Z",
    "updated_at": "2023-01-10T13:15:43Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "**What happened**:\r\n\r\nDue to a mistake in our code, we were persisting a dask dataframe in one scheduler, but then ran the compute while specifying threads scheduler. What was weird was that the computation returned a pandas Series of Futures instead of the expected DataFrame (or exception).\r\n\r\n**What you expected to happen**:\r\n\r\nI'm not sure what the best behavior is. Could be erroring on conflicting scheduler, running on the original scheduler, or running on the specified scheduler. Either way, the result structure should be consistent.\r\n\r\n**Minimal Complete Verifiable Example**:\r\n\r\n```python\r\nfrom distributed import Client, LocalCluster\r\nimport pandas as pd\r\nimport dask.dataframe as dd\r\n\r\ncluster = LocalCluster()\r\nclient=Client(cluster)\r\n\r\ndf = pd.DataFrame({'a': [1,2,3]})\r\n\r\nddf = dd.from_pandas(df, npartitions=3)\r\n\r\nddf = client.persist(ddf)\r\n\r\n# Works, and returns a DF as expected\r\nprint(ddf.compute())\r\n\r\n# Returns a pandas Series with a row per-partition with a future as the result\r\nprint(ddf.compute(scheduler=\"threads\"))\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n\r\n- Dask version:\r\n- Python version:\r\n- Operating System:\r\n- Install method (conda, pip, source):\r\n",
    "closed_by": {
        "login": "jsignell",
        "id": 4806877,
        "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsignell",
        "html_url": "https://github.com/jsignell",
        "followers_url": "https://api.github.com/users/jsignell/followers",
        "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
        "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
        "organizations_url": "https://api.github.com/users/jsignell/orgs",
        "repos_url": "https://api.github.com/users/jsignell/repos",
        "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jsignell/received_events",
        "type": "User",
        "site_admin": false
    },
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/8474/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/8474/timeline",
    "performed_via_github_app": null,
    "state_reason": "reopened"
}