{
    "url": "https://api.github.com/repos/dask/dask/issues/5321",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/5321/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/5321/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/5321/events",
    "html_url": "https://github.com/dask/dask/issues/5321",
    "id": 485372107,
    "node_id": "MDU6SXNzdWU0ODUzNzIxMDc=",
    "number": 5321,
    "title": "`read_parquet` graph transfer grows more than lienearly with number of partitions",
    "user": {
        "login": "birdsarah",
        "id": 1796208,
        "node_id": "MDQ6VXNlcjE3OTYyMDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1796208?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/birdsarah",
        "html_url": "https://github.com/birdsarah",
        "followers_url": "https://api.github.com/users/birdsarah/followers",
        "following_url": "https://api.github.com/users/birdsarah/following{/other_user}",
        "gists_url": "https://api.github.com/users/birdsarah/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/birdsarah/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/birdsarah/subscriptions",
        "organizations_url": "https://api.github.com/users/birdsarah/orgs",
        "repos_url": "https://api.github.com/users/birdsarah/repos",
        "events_url": "https://api.github.com/users/birdsarah/events{/privacy}",
        "received_events_url": "https://api.github.com/users/birdsarah/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2949099791,
            "node_id": "MDU6TGFiZWwyOTQ5MDk5Nzkx",
            "url": "https://api.github.com/repos/dask/dask/labels/parquet",
            "name": "parquet",
            "color": "77A66C",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 26,
    "created_at": "2019-08-26T18:19:26Z",
    "updated_at": "2021-10-13T02:12:29Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "dask 2.3.0\r\n\r\nmy calls to to_parquet were never starting - meaning after waiting a long time I still didn't see the tasks appear in the \"progress\" bar which, to my untrained eye, means that the graph is taking a long time to compute.\r\n\r\nI copy pasted the code from `dataframe/core.py to_parquet` to build my own `parts`\r\n\r\nhttps://github.com/dask/dask/blob/master/dask/dataframe/io/parquet/core.py#L458-L481\r\n```\r\n    # write parts\r\n    dwrite = delayed(engine.write_partition)\r\n    parts = [\r\n        dwrite(\r\n            d,\r\n            path,\r\n            fs,\r\n            filename,\r\n            partition_on,\r\n            write_metadata_file,\r\n            fmd=meta,\r\n            index_cols=index_cols,\r\n            **kwargs_pass\r\n        )\r\n        for d, filename in zip(df.to_delayed(), filenames)\r\n    ]\r\n\r\n    # single task to complete\r\n    out = delayed(lambda x: None)(parts)\r\n    if write_metadata_file:\r\n        out = delayed(engine.write_metadata)(\r\n            parts, meta, fs, path, append=append, compression=compression\r\n        )\r\n```\r\n\r\nI then manually put this in chunks into `client.compute` \r\n\r\nif I do 10 parts, after 27s my tasks appear. If I do 100 parts, after 4.5 minutes (270s) my tasks appear. My dataset has 4000 partitions so, at this rate, it will be 180 minutes before my task graph will even appear and start executing.\r\n\r\nFor comparison it takes ~2hours to do the full execution on dask 0.2.1.\r\n\r\n\r\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/5321/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/5321/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}