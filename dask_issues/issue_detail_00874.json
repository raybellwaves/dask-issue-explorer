{
    "url": "https://api.github.com/repos/dask/dask/issues/874",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/874/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/874/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/874/events",
    "html_url": "https://github.com/dask/dask/issues/874",
    "id": 121327475,
    "node_id": "MDU6SXNzdWUxMjEzMjc0NzU=",
    "number": 874,
    "title": "Scheduler fail case: centering data with dask.array",
    "user": {
        "login": "shoyer",
        "id": 1217238,
        "node_id": "MDQ6VXNlcjEyMTcyMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1217238?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shoyer",
        "html_url": "https://github.com/shoyer",
        "followers_url": "https://api.github.com/users/shoyer/followers",
        "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
        "organizations_url": "https://api.github.com/users/shoyer/orgs",
        "repos_url": "https://api.github.com/users/shoyer/repos",
        "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shoyer/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 386719400,
            "node_id": "MDU6TGFiZWwzODY3MTk0MDA=",
            "url": "https://api.github.com/repos/dask/dask/labels/scheduler",
            "name": "scheduler",
            "color": "D10945",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 42,
    "created_at": "2015-12-09T20:07:04Z",
    "updated_at": "2021-10-12T00:00:14Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "A common use case for many modeling problems (e.g., in machine learning or climate science) is to center data by subtracting an average of some kind over a given axis. The dask scheduler currently falls flat on its face when attempting to schedule these types of problems.\n\nHere's a simple example of such a fail case:\n\n``` python\nimport dask.array as da\nx = da.ones((8, 200, 200), chunks=(1, 200, 200))  # e.g., a large stack of image data\nmad = abs(x - x.mean(axis=0)).mean()\nmad.visualize()\n```\n\n![image](https://cloud.githubusercontent.com/assets/1217238/11696975/18d78eb2-9e6c-11e5-8ca1-8741ca2e38a9.png)\n\nThe scheduler will keep each of the initial chunks in memory that it uses to compute the mean, because they will be used later to as an argument to `sub`. In contrast, the appropriate way to handle this graph to avoid blowing up memory would be to compute the initial chunks twice.\n\nI know that in principle this could be avoided by using an on-disk cache. But this seems like a waste, because the initial values are often sitting in a file on disk, anyways.\n\nThis is a pretty typical use case for dask.array (one of the first things people try with xray), so it's worth seeing if we can come up with a solution that works by default.\n",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/874/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/874/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}