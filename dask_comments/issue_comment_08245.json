[
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/946150810",
        "html_url": "https://github.com/dask/dask/issues/8245#issuecomment-946150810",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8245",
        "id": 946150810,
        "node_id": "IC_kwDOAbcwm844ZR2a",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-18T20:45:09Z",
        "updated_at": "2021-10-18T20:45:09Z",
        "author_association": "MEMBER",
        "body": "I think anything within the pandas API is fair game for dask. So if you have the capacity to implement `unstack` that would be a welcome contribution. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/946150810/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/949533570",
        "html_url": "https://github.com/dask/dask/issues/8245#issuecomment-949533570",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8245",
        "id": 949533570,
        "node_id": "IC_kwDOAbcwm844mLuC",
        "user": {
            "login": "DahnJ",
            "id": 18722560,
            "node_id": "MDQ6VXNlcjE4NzIyNTYw",
            "avatar_url": "https://avatars.githubusercontent.com/u/18722560?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DahnJ",
            "html_url": "https://github.com/DahnJ",
            "followers_url": "https://api.github.com/users/DahnJ/followers",
            "following_url": "https://api.github.com/users/DahnJ/following{/other_user}",
            "gists_url": "https://api.github.com/users/DahnJ/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/DahnJ/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/DahnJ/subscriptions",
            "organizations_url": "https://api.github.com/users/DahnJ/orgs",
            "repos_url": "https://api.github.com/users/DahnJ/repos",
            "events_url": "https://api.github.com/users/DahnJ/events{/privacy}",
            "received_events_url": "https://api.github.com/users/DahnJ/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-22T11:18:32Z",
        "updated_at": "2022-02-05T16:46:11Z",
        "author_association": "CONTRIBUTOR",
        "body": "Thanks for the answer @jsignell\r\n\r\nI looked into this a bit today, here's a summary of my current thoughts.\r\n\r\n### `unstack` vs `pivot` vs `pivot_table`\r\n\r\nThe thing that I'm thinking about the most is the API. We have three related Pandas functions:\r\n\r\n- [`unstack`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.unstack.html): Assumes `MultiIndex` and \"unstacks\" one or more index levels into columns. \r\n  - \"Pivot based on the index values instead of a column.\"\r\n- [`pivot`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot.html): Takes `index`, `columns` and `values` and pivots the dataframe\r\n  - Relationship to `unstack` is roughly `pivot(ind, col, val) = set_index([ind,col]).unstack()`\r\n- [`pivot_table`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot_table.html): Like `pivot` but can also aggregate the results (in case of duplicates the combination of `index` and `columns`)\r\n\r\n#### `pivot` make sense for Dask, `unstack` less so\r\nAPI-wise, it seems most reasonable to implement `pivot`, since it doesn't specifically require a `MultiIndex` to be already in place. If we were to write `unstack`, it would have to have an API somewhat different from Pandas (since we can't just specify levels of a `MultiIndex`) and much closer to how `pivot` already functions anyway. So it would make sense to me to just have `pivot` and possibly let the user trying `unstack` know that `pivot` is available.\r\n\r\n#### `pivot_table` already exists in Dask\r\nOne interesting thing is that Dask already has [`pivot_table`](https://docs.dask.org/en/latest/generated/dask.dataframe.reshape.pivot_table.html), but it does not allow for multiple `index` and `columns` columns. The implementation I'm outlining would allow for that. I should possibly look into what's happening in `pivot_table` and see if some code could be shared with `pivot`.\r\n\r\n### Possible solution\r\nBased on the points above, I would\r\n- Implement `pivot`, mirroring Pandas API\r\n  - Check the code/functionality overlap with `pivot_table`\r\n- Have `unstack` throw `NotImplementedError` with a suggestion to try `pivot`\r\n\r\n---\r\n\r\n**NOTE**: I do not currently have the capacity the implement this. If you want to, do please go ahead :rocket: ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/949533570/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/957616568",
        "html_url": "https://github.com/dask/dask/issues/8245#issuecomment-957616568",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8245",
        "id": 957616568,
        "node_id": "IC_kwDOAbcwm845FBG4",
        "user": {
            "login": "jsignell",
            "id": 4806877,
            "node_id": "MDQ6VXNlcjQ4MDY4Nzc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4806877?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jsignell",
            "html_url": "https://github.com/jsignell",
            "followers_url": "https://api.github.com/users/jsignell/followers",
            "following_url": "https://api.github.com/users/jsignell/following{/other_user}",
            "gists_url": "https://api.github.com/users/jsignell/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jsignell/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jsignell/subscriptions",
            "organizations_url": "https://api.github.com/users/jsignell/orgs",
            "repos_url": "https://api.github.com/users/jsignell/repos",
            "events_url": "https://api.github.com/users/jsignell/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jsignell/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-11-02T13:49:52Z",
        "updated_at": "2021-11-02T13:49:52Z",
        "author_association": "MEMBER",
        "body": "Thanks for writing this all out. That approach makes sense to me. ",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/957616568/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/dask/dask/issues/comments/983131190",
        "html_url": "https://github.com/dask/dask/issues/8245#issuecomment-983131190",
        "issue_url": "https://api.github.com/repos/dask/dask/issues/8245",
        "id": 983131190,
        "node_id": "IC_kwDOAbcwm846mWQ2",
        "user": {
            "login": "DahnJ",
            "id": 18722560,
            "node_id": "MDQ6VXNlcjE4NzIyNTYw",
            "avatar_url": "https://avatars.githubusercontent.com/u/18722560?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DahnJ",
            "html_url": "https://github.com/DahnJ",
            "followers_url": "https://api.github.com/users/DahnJ/followers",
            "following_url": "https://api.github.com/users/DahnJ/following{/other_user}",
            "gists_url": "https://api.github.com/users/DahnJ/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/DahnJ/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/DahnJ/subscriptions",
            "organizations_url": "https://api.github.com/users/DahnJ/orgs",
            "repos_url": "https://api.github.com/users/DahnJ/repos",
            "events_url": "https://api.github.com/users/DahnJ/events{/privacy}",
            "received_events_url": "https://api.github.com/users/DahnJ/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-11-30T23:49:38Z",
        "updated_at": "2021-11-30T23:50:49Z",
        "author_association": "CONTRIBUTOR",
        "body": "One more detail: in the [original SO question](https://stackoverflow.com/questions/69480773/convert-column-of-categoricals-to-additional-columns/69524920#69524920), the OP in the end actually utilized a solution that assumed that appropriate `set_index` took place before (named `Option B`), which allows to perform this operation by simply using `map_partitions` instead of `apply_concat_apply`.\r\n\r\nThat makes this issue related to https://github.com/dask/dask/issues/8361. Whatever improvement stems from that issue should also be applied here.",
        "reactions": {
            "url": "https://api.github.com/repos/dask/dask/issues/comments/983131190/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]