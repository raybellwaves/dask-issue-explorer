{
    "url": "https://api.github.com/repos/dask/dask/issues/7951",
    "repository_url": "https://api.github.com/repos/dask/dask",
    "labels_url": "https://api.github.com/repos/dask/dask/issues/7951/labels{/name}",
    "comments_url": "https://api.github.com/repos/dask/dask/issues/7951/comments",
    "events_url": "https://api.github.com/repos/dask/dask/issues/7951/events",
    "html_url": "https://github.com/dask/dask/issues/7951",
    "id": 954880184,
    "node_id": "MDU6SXNzdWU5NTQ4ODAxODQ=",
    "number": 7951,
    "title": "Slicing Dask arrays with NumPy scalars",
    "user": {
        "login": "jrbourbeau",
        "id": 11656932,
        "node_id": "MDQ6VXNlcjExNjU2OTMy",
        "avatar_url": "https://avatars.githubusercontent.com/u/11656932?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jrbourbeau",
        "html_url": "https://github.com/jrbourbeau",
        "followers_url": "https://api.github.com/users/jrbourbeau/followers",
        "following_url": "https://api.github.com/users/jrbourbeau/following{/other_user}",
        "gists_url": "https://api.github.com/users/jrbourbeau/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jrbourbeau/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jrbourbeau/subscriptions",
        "organizations_url": "https://api.github.com/users/jrbourbeau/orgs",
        "repos_url": "https://api.github.com/users/jrbourbeau/repos",
        "events_url": "https://api.github.com/users/jrbourbeau/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jrbourbeau/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 242862305,
            "node_id": "MDU6TGFiZWwyNDI4NjIzMDU=",
            "url": "https://api.github.com/repos/dask/dask/labels/array",
            "name": "array",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2021-07-28T13:53:30Z",
    "updated_at": "2021-07-29T19:28:55Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "Dask arrays can be sliced with Python integers, Python lists, NumPy arrays, etc. However, slicing with a NumPy scalar results in an `AssertionError` being raised (full traceback is further down below):\r\n\r\n```python\r\nIn [1]: import dask.array as da\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: x = da.arange(10)\r\n\r\nIn [4]: x[0]   # Slicing with Python integer works \r\nOut[4]: dask.array<getitem, shape=(), dtype=int64, chunksize=(), chunktype=numpy.ndarray>\r\n\r\nIn [5]: x[[0, 1]]   # Slicing with Python list works \r\nOut[5]: dask.array<getitem, shape=(2,), dtype=int64, chunksize=(2,), chunktype=numpy.ndarray>\r\n\r\nIn [6]: x[np.array([0, 1])]   # Slicing with NumPy arrays\r\nOut[6]: dask.array<getitem, shape=(2,), dtype=int64, chunksize=(2,), chunktype=numpy.ndarray>\r\n\r\nIn [7]: x[np.array(0)]   # Slicing with NumPy scalars raises an error\r\n# AssertionError is raised here\r\n```\r\n\r\n\r\n\r\n<details>\r\n<summary>Details:</summary>\r\n\r\n```python\r\nIn [1]: import dask.array as da\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: x = da.arange(10)\r\n\r\nIn [4]: x[0]\r\nOut[4]: dask.array<getitem, shape=(), dtype=int64, chunksize=(), chunktype=numpy.ndarray>\r\n\r\nIn [5]: x[[0, 1]]\r\nOut[5]: dask.array<getitem, shape=(2,), dtype=int64, chunksize=(2,), chunktype=numpy.ndarray>\r\n\r\nIn [6]: x[np.array([0, 1])]\r\nOut[6]: dask.array<getitem, shape=(2,), dtype=int64, chunksize=(2,), chunktype=numpy.ndarray>\r\n\r\nIn [7]: x[np.array(0)]\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-7-e3c33b6b5f59> in <module>\r\n----> 1 x[np.array(0)]\r\n\r\n~/projects/dask/dask/dask/array/core.py in __getitem__(self, index)\r\n   1766\r\n   1767         out = \"getitem-\" + tokenize(self, index2)\r\n-> 1768         dsk, chunks = slice_array(out, self.name, self.chunks, index2, self.itemsize)\r\n   1769\r\n   1770         graph = HighLevelGraph.from_collections(out, dsk, dependencies=[self])\r\n\r\n~/projects/dask/dask/dask/array/slicing.py in slice_array(out_name, in_name, blockdims, index, itemsize)\r\n    169\r\n    170     # Pass down to next function\r\n--> 171     dsk_out, bd_out = slice_with_newaxes(out_name, in_name, blockdims, index, itemsize)\r\n    172\r\n    173     bd_out = tuple(map(tuple, bd_out))\r\n\r\n~/projects/dask/dask/dask/array/slicing.py in slice_with_newaxes(out_name, in_name, blockdims, index, itemsize)\r\n    191\r\n    192     # Pass down and do work\r\n--> 193     dsk, blockdims2 = slice_wrap_lists(out_name, in_name, blockdims, index2, itemsize)\r\n    194\r\n    195     if where_none:\r\n\r\n~/projects/dask/dask/dask/array/slicing.py in slice_wrap_lists(out_name, in_name, blockdims, index, itemsize)\r\n    247     # No lists, hooray! just use slice_slices_and_integers\r\n    248     if not where_list:\r\n--> 249         return slice_slices_and_integers(out_name, in_name, blockdims, index)\r\n    250\r\n    251     # Replace all lists with full slices  [3, 1, 0] -> slice(None, None, None)\r\n\r\n~/projects/dask/dask/dask/array/slicing.py in slice_slices_and_integers(out_name, in_name, blockdims, index)\r\n    300             )\r\n    301\r\n--> 302     assert all(isinstance(ind, (slice, Integral)) for ind in index)\r\n    303     assert len(index) == len(blockdims)\r\n    304\r\n\r\nAssertionError:\r\n```\r\n\r\n</details>",
    "closed_by": null,
    "reactions": {
        "url": "https://api.github.com/repos/dask/dask/issues/7951/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/dask/dask/issues/7951/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}